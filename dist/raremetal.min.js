!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.raremetal=e():r.raremetal=e()}("undefined"!=typeof self?self:this,function(){return function(r){var e={};function n(t){if(e[t])return e[t].exports;var i=e[t]={i:t,l:!1,exports:{}};return r[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=r,n.c=e,n.d=function(r,e,t){n.o(r,e)||Object.defineProperty(r,e,{configurable:!1,enumerable:!0,get:t})},n.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(e,"a",e),e},n.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},n.p="",n(n.s=2)}([function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,e){var n,t,i;for(void 0===e&&(e=15),t=.5,n=new Date;;){for(i=t*=2;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(new Date-n>e)break}for(i=t;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*t-1)/(new Date-n)},numeric._myIndexOf=function(r){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){var e=[];return function r(n){var t;if(void 0===n)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return e.push('"'+n+'"'),!1;if("boolean"==typeof n)return e.push(n.toString()),!1;if("number"==typeof n){var i=function r(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+r(-e);if(isFinite(e)){var n=Math.floor(Math.log(e)/Math.log(10)),t=e/Math.pow(10,n),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,i=(t=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}(n),u=n.toPrecision(numeric.precision),o=parseFloat(n.toString()).toString(),a=[i,u,o,parseFloat(u).toString(),parseFloat(o).toString()];for(t=1;t<a.length;t++)a[t].length<i.length&&(i=a[t]);return e.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===n)return e.push("null"),!1;if("function"==typeof n){e.push(n.toString());var c=!1;for(t in n)n.hasOwnProperty(t)&&(c?e.push(",\n"):e.push("\n{"),c=!0,e.push(t),e.push(": \n"),r(n[t]));return c&&e.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return e.push("...Large Array..."),!0;for(c=!1,e.push("["),t=0;t<n.length;t++)t>0&&(e.push(","),c&&e.push("\n ")),c=r(n[t]);return e.push("]"),!0}e.push("{");c=!1;for(t in n)n.hasOwnProperty(t)&&(c&&e.push(",\n"),c=!0,e.push(t),e.push(": \n"),r(n[t]));return e.push("}"),!0}(r),e.join("")},numeric.parseDate=function(r){return function r(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,t=[];for(n=0;n<e.length;n++)t[n]=r(e[n]);return t}(r)},numeric.parseFloat=function(r){return function r(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,t=[];for(n=0;n<e.length;n++)t[n]=r(e[n]);return t}(r)},numeric.parseCSV=function(r){var e,n,t,i=r.split("\n"),u=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,c=0;for(n=0;n<i.length;n++){var f,s=(i[n]+",").match(o);if(s.length>0){for(u[c]=[],e=0;e<s.length;e++)f=(t=s[e]).substr(0,t.length-1),a.test(f)?u[c][e]=parseFloat(f):u[c][e]=f;c++}}return u},numeric.toCSV=function(r){var e,n,t,i,u,o=numeric.dim(r);for(t=o[0],o[1],u=[],e=0;e<t;e++){for(i=[],n=0;n<t;n++)i[n]=r[e][n].toString();u[e]=i.join(", ")}return u.join("\n")+"\n"},numeric.getURL=function(r){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.send(),e},numeric.imageURL=function(r){function e(r,e,n){void 0===e&&(e=0),void 0===n&&(n=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],u=-1;r.length;for(t=e;t<n;t++)u=u>>>8^i[255&(u^r[t])];return-1^u}var n,t,i,u,o,a,c,f,s,m,h=r[0].length,l=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,l>>24&255,l>>16&255,l>>8&255,255&l,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=e(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,n=1,t=0,c=0;c<h;c++){for(c<h-1?p.push(0):p.push(1),o=3*l+1+(0===c)&255,a=3*l+1+(0===c)>>8&255,p.push(o),p.push(a),p.push(255&~o),p.push(255&~a),0===c&&p.push(0),f=0;f<l;f++)for(i=0;i<3;i++)t=(t+(n=(n+(o=(o=r[i][c][f])>255?255:o<0?0:Math.round(o)))%65521))%65521,p.push(o);p.push(0)}return s=(t<<16)+n,p.push(s>>24&255),p.push(s>>16&255),p.push(s>>8&255),p.push(255&s),u=p.length-41,p[33]=u>>24&255,p[34]=u>>16&255,p[35]=u>>8&255,p[36]=255&u,m=e(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(r){var e,n,t,i,u,o,a,c=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(e=0;e<c;e+=3)u=((3&(n=r[e]))<<4)+((t=r[e+1])>>4),o=((15&t)<<2)+((i=r[e+2])>>6),a=63&i,e+1>=c?o=a=64:e+2>=c&&(a=64),s+=f.charAt(n>>2)+f.charAt(u)+f.charAt(o)+f.charAt(a);return s}(p)},numeric._dim=function(r){for(var e=[];"object"==typeof r;)e.push(r.length),r=r[0];return e},numeric.dim=function(r){var e;return"object"==typeof r?"object"==typeof(e=r[0])?"object"==typeof e[0]?numeric._dim(r):[r.length,e.length]:[r.length]:[]},numeric.mapreduce=function(r,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(e,n){var t,i;if(!(e instanceof Array&&n instanceof Array))return!1;if((i=e.length)!==n.length)return!1;for(t=0;t<i;t++)if(e[t]!==n[t]){if("object"!=typeof e[t])return!1;if(!r(e[t],n[t]))return!1}return!0},numeric.rep=function(r,e,n){void 0===n&&(n=0);var t,i=r[n],u=Array(i);if(n===r.length-1){for(t=i-2;t>=0;t-=2)u[t+1]=e,u[t]=e;return-1===t&&(u[0]=e),u}for(t=i-1;t>=0;t--)u[t]=numeric.rep(r,e,n+1);return u},numeric.dotMMsmall=function(r,e){var n,t,i,u,o,a,c,f,s,m,h;for(u=r.length,o=e.length,a=e[0].length,c=Array(u),n=u-1;n>=0;n--){for(f=Array(a),s=r[n],i=a-1;i>=0;i--){for(m=s[o-1]*e[o-1][i],t=o-2;t>=1;t-=2)h=t-1,m+=s[t]*e[t][i]+s[h]*e[h][i];0===t&&(m+=s[0]*e[0][i]),f[i]=m}c[n]=f}return c},numeric._getCol=function(r,e,n){var t;for(t=r.length-1;t>0;--t)n[t]=r[t][e],n[--t]=r[t][e];0===t&&(n[0]=r[0][e])},numeric.dotMMbig=function(r,e){var n,t,i,u=numeric._getCol,o=e.length,a=Array(o),c=r.length,f=e[0].length,s=new Array(c),m=numeric.dotVV;for(--o,t=--c;-1!==t;--t)s[t]=Array(f);for(t=--f;-1!==t;--t)for(u(e,t,a),i=c;-1!==i;--i)0,n=r[i],s[i][t]=m(n,a);return s},numeric.dotMV=function(r,e){var n,t=r.length,i=(e.length,Array(t)),u=numeric.dotVV;for(n=t-1;n>=0;n--)i[n]=u(r[n],e);return i},numeric.dotVM=function(r,e){var n,t,i,u,o,a,c;for(i=r.length,u=e[0].length,o=Array(u),t=u-1;t>=0;t--){for(a=r[i-1]*e[i-1][t],n=i-2;n>=1;n-=2)c=n-1,a+=r[n]*e[n][t]+r[c]*e[c][t];0===n&&(a+=r[0]*e[0][t]),o[t]=a}return o},numeric.dotVV=function(r,e){var n,t,i=r.length,u=r[i-1]*e[i-1];for(n=i-2;n>=1;n-=2)t=n-1,u+=r[n]*e[n]+r[t]*e[t];return 0===n&&(u+=r[0]*e[0]),u},numeric.dot=function(r,e){var n=numeric.dim;switch(1e3*n(r).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(r,e):numeric.dotMMbig(r,e);case 2001:return numeric.dotMV(r,e);case 1002:return numeric.dotVM(r,e);case 1001:return numeric.dotVV(r,e);case 1e3:return numeric.mulVS(r,e);case 1:return numeric.mulSV(r,e);case 0:return r*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var e,n,t,i,u=r.length,o=Array(u);for(e=u-1;e>=0;e--){for(i=Array(u),n=e+2,t=u-1;t>=n;t-=2)i[t]=0,i[t-1]=0;for(t>e&&(i[t]=0),i[e]=r[e],t=e-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),o[e]=i}return o},numeric.getDiag=function(r){var e,n=Math.min(r.length,r[0].length),t=Array(n);for(e=n-1;e>=1;--e)t[e]=r[e][e],t[--e]=r[e][e];return 0===e&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,e,n){void 0===n&&(n="");var t,i,u=[],o=/\[i\]$/,a="",c=!1;for(t=0;t<r.length;t++)o.test(r[t])?a=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(c=!0),u.push(i);return u[r.length]="_s",u[r.length+1]="_k",u[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(c?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,u)},numeric.pointwise2=function(r,e,n){void 0===n&&(n="");var t,i,u=[],o=/\[i\]$/,a="",c=!1;for(t=0;t<r.length;t++)o.test(r[t])?a=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(c=!0),u.push(i);return u[r.length]="var _n = "+a+".length;\nvar i"+(c?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,u)},numeric._biforeach=function r(e,n,t,i,u){var o;if(i!==t.length-1)for(o=t[i]-1;o>=0;o--)r("object"==typeof e?e[o]:e,"object"==typeof n?n[o]:n,t,i+1,u);else u(e,n)},numeric._biforeach2=function r(e,n,t,i,u){if(i===t.length-1)return u(e,n);var o,a=t[i],c=Array(a);for(o=a-1;o>=0;--o)c[o]=r("object"==typeof e?e[o]:e,"object"==typeof n?n[o]:n,t,i+1,u);return c},numeric._foreach=function r(e,n,t,i){var u;if(t!==n.length-1)for(u=n[t]-1;u>=0;u--)r(e[u],n,t+1,i);else i(e)},numeric._foreach2=function r(e,n,t,i){if(t===n.length-1)return i(e);var u,o=n[t],a=Array(o);for(u=o-1;u>=0;u--)a[u]=r(e[u],n,t+1,i);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,e;for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],numeric.ops2[e]=e;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){e=numeric.ops2[r];var n,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+e+" = Math."+e+";\n",n=function(r,n,t){return r+" = "+e+"("+n+","+t+")"},t=function(r,n){return r+" = "+e+"("+r+","+n+")"}):(n=function(r,n,t){return r+" = "+n+" "+e+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+e+"= "+n}:function(r,n){return r+" = "+r+" "+e+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],delete numeric.ops2[e];for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],numeric.ops1[e]=e;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",e=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],delete numeric.ops1[e];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(e=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[r]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,e){return"object"==typeof r?"object"==typeof e?numeric.truncVV(r,e):numeric.truncVS(r,e):"object"==typeof e?numeric.truncSV(r,e):Math.round(r/e)*e},numeric.inv=function(r){var e,n,t,i,u,o,a,c=numeric.dim(r),f=Math.abs,s=c[0],m=c[1],h=numeric.clone(r),l=numeric.identity(s);for(o=0;o<m;++o){var p=-1,g=-1;for(u=o;u!==s;++u)(a=f(h[u][o]))>g&&(p=u,g=a);for(n=h[p],h[p]=h[o],h[o]=n,i=l[p],l[p]=l[o],l[o]=i,r=n[o],a=o;a!==m;++a)n[a]/=r;for(a=m-1;-1!==a;--a)i[a]/=r;for(u=s-1;-1!==u;--u)if(u!==o){for(e=h[u],t=l[u],r=e[o],a=o+1;a!==m;++a)e[a]-=n[a]*r;for(a=m-1;a>0;--a)t[a]-=i[a]*r,t[--a]-=i[a]*r;0===a&&(t[0]-=i[0]*r)}}return l},numeric.det=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,t,i,u,o,a,c,f,s=e[0],m=1,h=numeric.clone(r);for(t=0;t<s-1;t++){for(i=t,n=t+1;n<s;n++)Math.abs(h[n][t])>Math.abs(h[i][t])&&(i=n);for(i!==t&&(c=h[i],h[i]=h[t],h[t]=c,m*=-1),u=h[t],n=t+1;n<s;n++){for(a=(o=h[n])[t]/u[t],i=t+1;i<s-1;i+=2)f=i+1,o[i]-=u[i]*a,o[f]-=u[f]*a;i!==s&&(o[i]-=u[i]*a)}if(0===u[t])return 0;m*=u[t]}return m*h[t][t]},numeric.transpose=function(r){var e,n,t,i,u,o=r.length,a=r[0].length,c=Array(a);for(n=0;n<a;n++)c[n]=Array(o);for(e=o-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=a-1;n>=1;--n)(u=c[n])[e]=i[n],u[e-1]=t[n],(u=c[--n])[e]=i[n],u[e-1]=t[n];0===n&&((u=c[0])[e]=i[0],u[e-1]=t[0])}if(0===e){for(t=r[0],n=a-1;n>=1;--n)c[n][0]=t[n],c[--n][0]=t[n];0===n&&(c[0][0]=t[0])}return c},numeric.negtranspose=function(r){var e,n,t,i,u,o=r.length,a=r[0].length,c=Array(a);for(n=0;n<a;n++)c[n]=Array(o);for(e=o-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=a-1;n>=1;--n)(u=c[n])[e]=-i[n],u[e-1]=-t[n],(u=c[--n])[e]=-i[n],u[e-1]=-t[n];0===n&&((u=c[0])[e]=-i[0],u[e-1]=-t[0])}if(0===e){for(t=r[0],n=a-1;n>=1;--n)c[n][0]=-t[n],c[--n][0]=-t[n];0===n&&(c[0][0]=-t[0])}return c},numeric._random=function r(e,n){var t,i,u=e[n],o=Array(u);if(n===e.length-1){for(i=Math.random,t=u-1;t>=1;t-=2)o[t]=i(),o[t-1]=i();return 0===t&&(o[0]=i()),o}for(t=u-1;t>=0;t--)o[t]=r(e,n+1);return o},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,e,n){if(void 0===n&&(n=Math.max(Math.round(e-r)+1,1)),n<2)return 1===n?[r]:[];var t,i=Array(n);for(t=--n;t>=0;t--)i[t]=(t*e+(n-t)*r)/n;return i},numeric.getBlock=function(r,e,n){var t=numeric.dim(r);return function r(i,u){var o,a=e[u],c=n[u]-a,f=Array(c);if(u===t.length-1){for(o=c;o>=0;o--)f[o]=i[o+a];return f}for(o=c;o>=0;o--)f[o]=r(i[o+a],u+1);return f}(r,0)},numeric.setBlock=function(r,e,n,t){var i=numeric.dim(r);return function r(t,u,o){var a,c=e[o],f=n[o]-c;if(o===i.length-1)for(a=f;a>=0;a--)t[a+c]=u[a];for(a=f;a>=0;a--)r(t[a+c],u[a],o+1)}(r,t,0),r},numeric.getRange=function(r,e,n){var t,i,u,o,a=e.length,c=n.length,f=Array(a);for(t=a-1;-1!==t;--t)for(f[t]=Array(c),u=f[t],o=r[e[t]],i=c-1;-1!==i;--i)u[i]=o[n[i]];return f},numeric.blockMatrix=function(r){var e=numeric.dim(r);if(e.length<4)return numeric.blockMatrix([r]);var n,t,i,u,o,a=e[0],c=e[1];for(n=0,t=0,i=0;i<a;++i)n+=r[i][0].length;for(u=0;u<c;++u)t+=r[0][u][0].length;var f=Array(n);for(i=0;i<n;++i)f[i]=Array(t);var s,m,h,l,p,g=0;for(i=0;i<a;++i){for(s=t,u=c-1;-1!==u;--u)for(s-=(o=r[i][u])[0].length,h=o.length-1;-1!==h;--h)for(p=o[h],m=f[g+h],l=p.length-1;-1!==l;--l)m[s+l]=p[l];g+=r[i][0].length}return f},numeric.tensor=function(r,e){if("number"==typeof r||"number"==typeof e)return numeric.mul(r,e);var n=numeric.dim(r),t=numeric.dim(e);if(1!==n.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,u,o,a,c=n[0],f=t[0],s=Array(c);for(u=c-1;u>=0;u--){for(i=Array(f),a=r[u],o=f-1;o>=3;--o)i[o]=a*e[o],i[--o]=a*e[o],i[--o]=a*e[o],i[--o]=a*e[o];for(;o>=0;)i[o]=a*e[o],--o;s[u]=i}return s},numeric.T=function(r,e){this.x=r,this.y=e},numeric.t=function(r,e){return new numeric.T(r,e)},numeric.Tbinop=function(r,e,n,t,i){var u;numeric.indexOf;if("string"!=typeof i)for(u in i="",numeric)numeric.hasOwnProperty(u)&&(r.indexOf(u)>=0||e.indexOf(u)>=0||n.indexOf(u)>=0||t.indexOf(u)>=0)&&u.length>1&&(i+="var "+u+" = numeric."+u+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,r.x),e(this.y,r.x)):new numeric.T(e(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),numeric.negtranspose(n)):new numeric.T(r(e))},numeric.Tunop=function(r,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if(void 0===r.y)return new numeric.T(numeric.inv(r.x));var e,n,t,i,u,o,a,c,f,s,m,h,l,p,g,d,y,v,x=r.x.length,M=numeric.identity(x),b=numeric.rep([x,x],0),w=numeric.clone(r.x),N=numeric.clone(r.y);for(f=0;f<x;f++){for(h=(p=w[f][f])*p+(g=N[f][f])*g,m=f,s=f+1;s<x;s++)(l=(p=w[s][f])*p+(g=N[s][f])*g)>h&&(m=s,h=l);for(m!==f&&(v=w[f],w[f]=w[m],w[m]=v,v=N[f],N[f]=N[m],N[m]=v,v=M[f],M[f]=M[m],M[m]=v,v=b[f],b[f]=b[m],b[m]=v),e=w[f],n=N[f],u=M[f],o=b[f],p=e[f],g=n[f],s=f+1;s<x;s++)d=e[s],y=n[s],e[s]=(d*p+y*g)/h,n[s]=(y*p-d*g)/h;for(s=0;s<x;s++)d=u[s],y=o[s],u[s]=(d*p+y*g)/h,o[s]=(y*p-d*g)/h;for(s=f+1;s<x;s++){for(t=w[s],i=N[s],a=M[s],c=b[s],p=t[f],g=i[f],m=f+1;m<x;m++)d=e[m],y=n[m],t[m]-=d*p-y*g,i[m]-=y*p+d*g;for(m=0;m<x;m++)d=u[m],y=o[m],a[m]-=d*p-y*g,c[m]-=y*p+d*g}}for(f=x-1;f>0;f--)for(u=M[f],o=b[f],s=f-1;s>=0;s--)for(a=M[s],c=b[s],p=w[s][f],g=N[s][f],m=x-1;m>=0;m--)d=u[m],y=o[m],a[m]-=p*d-g*y,c[m]-=p*y+g*d;return new numeric.T(M,b)},numeric.T.prototype.get=function(r){var e,n=this.x,t=this.y,i=0,u=r.length;if(t){for(;i<u;)n=n[e=r[i]],t=t[e],i++;return new numeric.T(n,t)}for(;i<u;)n=n[e=r[i]],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,e){var n,t=this.x,i=this.y,u=0,o=r.length,a=e.x,c=e.y;if(0===o)return c?this.y=c:i&&(this.y=void 0),this.x=t,this;if(c){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);u<o-1;)t=t[n=r[u]],i=i[n],u++;return t[n=r[u]]=a,i[n]=c,this}if(i){for(;u<o-1;)t=t[n=r[u]],i=i[n],u++;return t[n=r[u]]=a,a instanceof Array?i[n]=numeric.rep(numeric.dim(a),0):i[n]=0,this}for(;u<o-1;)t=t[n=r[u]],u++;return t[n=r[u]]=a,this},numeric.T.prototype.getRows=function(r,e){var n,t,i=e-r+1,u=Array(i),o=this.x,a=this.y;for(n=r;n<=e;n++)u[n-r]=o[n];if(a){for(t=Array(i),n=r;n<=e;n++)t[n-r]=a[n];return new numeric.T(u,t)}return new numeric.T(u)},numeric.T.prototype.setRows=function(r,e,n){var t,i=this.x,u=this.y,o=n.x,a=n.y;for(t=r;t<=e;t++)i[t]=o[t-r];if(a)for(u||(u=numeric.rep(numeric.dim(i),0),this.y=u),t=r;t<=e;t++)u[t]=a[t-r];else if(u)for(t=r;t<=e;t++)u[t]=numeric.rep([o[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var e=this.x,n=this.y;return n?new numeric.T(e[r],n[r]):new numeric.T(e[r])},numeric.T.prototype.setRow=function(r,e){var n=this.x,t=this.y,i=e.x,u=e.y;return n[r]=i,u?(t||(t=numeric.rep(numeric.dim(n),0),this.y=t),t[r]=u):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,e){var n=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(n,r,e),i(t,r,e)):new numeric.T(i(n,r,e))},numeric.T.prototype.setBlock=function(r,e,n){n instanceof numeric.T||(n=new numeric.T(n));var t=this.x,i=this.y,u=numeric.setBlock,o=n.x,a=n.y;if(a)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),u(t,r,e,o),u(i,r,e,a),this;u(t,r,e,o),i&&u(i,r,e,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(r,e){var n=numeric.T;e instanceof n||(e=new n(e));var t=e.x,i=e.y,u=numeric.rep;return i?new n(u(r,t),u(r,i)):new n(u(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var e=r.x,n=r.y,t=numeric.diag;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,e=this.x,n=this.y;return n?new r.T(r.getDiag(e),r.getDiag(n)):new r.T(r.getDiag(e))},numeric.house=function(r){var e=numeric.clone(r),n=(r[0]>=0?1:-1)*numeric.norm2(r);e[0]+=n;var t=numeric.norm2(e);if(0===t)throw new Error("eig: internal error");return numeric.div(e,t)},numeric.toUpperHessenberg=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,t,i,u,o,a,c,f,s,m,h=e[0],l=numeric.clone(r),p=numeric.identity(h);for(t=0;t<h-2;t++){for(u=Array(h-t-1),n=t+1;n<h;n++)u[n-t-1]=l[n][t];if(numeric.norm2(u)>0){for(o=numeric.house(u),a=numeric.getBlock(l,[t+1,t],[h-1,h-1]),c=numeric.tensor(o,numeric.dot(o,a)),n=t+1;n<h;n++)for(f=l[n],s=c[n-t-1],i=t;i<h;i++)f[i]-=2*s[i-t];for(a=numeric.getBlock(l,[0,t+1],[h-1,h-1]),c=numeric.tensor(numeric.dot(a,o),o),n=0;n<h;n++)for(f=l[n],s=c[n],i=t+1;i<h;i++)f[i]-=2*s[i-t-1];for(a=Array(h-t-1),n=t+1;n<h;n++)a[n-t-1]=p[n];for(c=numeric.tensor(o,numeric.dot(o,a)),n=t+1;n<h;n++)for(m=p[n],s=c[n-t-1],i=0;i<h;i++)m[i]-=2*s[i]}}return{H:l,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,e){void 0===e&&(e=1e4),r=numeric.clone(r);numeric.clone(r);var n,t,i,u,o,a,c,f,s,m,h,l,p,g,d,y,v,x,M=numeric.dim(r)[0],b=numeric.identity(M);if(M<3)return{Q:b,B:[[0,M-1]]};var w=numeric.epsilon;for(x=0;x<e;x++){for(y=0;y<M-1;y++)if(Math.abs(r[y+1][y])<w*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var N=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),e),k=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[M-1,M-1]),e);for(l=Array(y+1),d=0;d<=y;d++)l[d]=b[d];for(p=numeric.dot(N.Q,l),d=0;d<=y;d++)b[d]=p[d];for(l=Array(M-y-1),d=y+1;d<M;d++)l[d-y-1]=b[d];for(p=numeric.dot(k.Q,l),d=y+1;d<M;d++)b[d]=p[d-y-1];return{Q:b,B:N.B.concat(numeric.add(k.B,y+1))}}var T,_,A;if(i=r[M-2][M-2],u=r[M-2][M-1],o=r[M-1][M-2],f=i+(a=r[M-1][M-1]),c=i*a-u*o,s=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*c)T=.5*(f+Math.sqrt(f*f-4*c)),_=.5*(f-Math.sqrt(f*f-4*c)),s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,T+_)),numeric.diag(numeric.rep([3],T*_)));else s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,f)),numeric.diag(numeric.rep([3],c)));for(n=[s[0][0],s[1][0],s[2][0]],t=numeric.house(n),l=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(h=r[d],g=p[d],v=0;v<M;v++)h[v]-=2*g[v];for(l=numeric.getBlock(r,[0,0],[M-1,2]),p=numeric.tensor(numeric.dot(l,t),t),d=0;d<M;d++)for(h=r[d],g=p[d],v=0;v<3;v++)h[v]-=2*g[v];for(l=[b[0],b[1],b[2]],p=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(m=b[d],g=p[d],v=0;v<M;v++)m[v]-=2*g[v];for(y=0;y<M-2;y++){for(v=y;v<=y+1;v++)if(Math.abs(r[v+1][v])<w*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){N=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),e),k=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[M-1,M-1]),e);for(l=Array(v+1),d=0;d<=v;d++)l[d]=b[d];for(p=numeric.dot(N.Q,l),d=0;d<=v;d++)b[d]=p[d];for(l=Array(M-v-1),d=v+1;d<M;d++)l[d-v-1]=b[d];for(p=numeric.dot(k.Q,l),d=v+1;d<M;d++)b[d]=p[d-v-1];return{Q:b,B:N.B.concat(numeric.add(k.B,v+1))}}for(A=Math.min(M-1,y+3),n=Array(A-y),d=y+1;d<=A;d++)n[d-y-1]=r[d][y];for(t=numeric.house(n),l=numeric.getBlock(r,[y+1,y],[A,M-1]),p=numeric.tensor(t,numeric.dot(t,l)),d=y+1;d<=A;d++)for(h=r[d],g=p[d-y-1],v=y;v<M;v++)h[v]-=2*g[v-y];for(l=numeric.getBlock(r,[0,y+1],[M-1,A]),p=numeric.tensor(numeric.dot(l,t),t),d=0;d<M;d++)for(h=r[d],g=p[d],v=y+1;v<=A;v++)h[v]-=2*g[v-y-1];for(l=Array(A-y),d=y+1;d<=A;d++)l[d-y-1]=b[d];for(p=numeric.tensor(t,numeric.dot(t,l)),d=y+1;d<=A;d++)for(m=b[d],g=p[d-y-1],v=0;v<M;v++)m[v]-=2*g[v]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,e){var n,t,i,u,o,a,c,f,s,m,h,l,p,g,d,y,v=numeric.toUpperHessenberg(r),x=numeric.QRFrancis(v.H,e),M=numeric.T,b=r.length,w=x.B,N=numeric.dot(x.Q,numeric.dot(v.H,numeric.transpose(x.Q))),k=new M(numeric.dot(x.Q,v.Q)),T=w.length,_=Math.sqrt;for(t=0;t<T;t++)if((n=w[t][0])===w[t][1]);else{if(u=n+1,o=N[n][n],a=N[n][u],c=N[u][n],f=N[u][u],0===a&&0===c)continue;(m=(s=-o-f)*s-4*(o*f-a*c))>=0?((d=(o-(h=s<0?-.5*(s-_(m)):-.5*(s+_(m))))*(o-h)+a*a)>(y=c*c+(f-h)*(f-h))?(p=(o-h)/(d=_(d)),g=a/d):(p=c/(y=_(y)),g=(f-h)/y),i=new M([[g,-p],[p,g]]),k.setRows(n,u,i.dot(k.getRows(n,u)))):(h=-.5*s,l=.5*_(-m),(d=(o-h)*(o-h)+a*a)>(y=c*c+(f-h)*(f-h))?(p=(o-h)/(d=_(d+l*l)),g=a/d,h=0,l/=d):(p=c/(y=_(y+l*l)),g=(f-h)/y,h=l/y,l=0),i=new M([[g,-p],[p,g]],[[h,l],[l,-h]]),k.setRows(n,u,i.dot(k.getRows(n,u))))}var A=k.dot(r).dot(k.transjugate()),j=(b=r.length,numeric.T.identity(b));for(u=0;u<b;u++)if(u>0)for(t=u-1;t>=0;t--){var I=A.get([t,t]),S=A.get([u,u]);numeric.neq(I.x,S.x)||numeric.neq(I.y,S.y)?(h=A.getRow(t).getBlock([t],[u-1]),l=j.getRow(u).getBlock([t],[u-1]),j.set([u,t],A.get([t,u]).neg().sub(h.dot(l)).div(I.sub(S)))):j.setRow(u,j.getRow(t))}for(u=0;u<b;u++)h=j.getRow(u),j.setRow(u,h.div(h.norm2()));return j=j.transpose(),j=k.transjugate().dot(j),{lambda:A.getDiag(),E:j}},numeric.ccsSparse=function(r){var e,n,t,i=r.length,u=[];for(n=i-1;-1!==n;--n)for(t in e=r[n]){for(t=parseInt(t);t>=u.length;)u[u.length]=0;0!==e[t]&&u[t]++}var o=u.length,a=Array(o+1);for(a[0]=0,n=0;n<o;++n)a[n+1]=a[n]+u[n];var c=Array(a[o]),f=Array(a[o]);for(n=i-1;-1!==n;--n)for(t in e=r[n])0!==e[t]&&(u[t]--,c[a[t]+u[t]]=n,f[a[t]+u[t]]=e[t]);return[a,c,f]},numeric.ccsFull=function(r){var e,n,t,i,u=r[0],o=r[1],a=r[2],c=numeric.ccsDim(r),f=c[0],s=c[1],m=numeric.rep([f,s],0);for(e=0;e<s;e++)for(t=u[e],i=u[e+1],n=t;n<i;++n)m[o[n]][e]=a[n];return m},numeric.ccsTSolve=function(r,e,n,t,i){var u,o,a,c,f,s,m,h=r[0],l=r[1],p=r[2],g=h.length-1,d=Math.max,y=0;function v(r){var e;if(0===n[r]){for(n[r]=1,e=h[r];e<h[r+1];++e)v(l[e]);i[y]=r,++y}}for(void 0===t&&(n=numeric.rep([g],0)),void 0===t&&(t=numeric.linspace(0,n.length-1)),void 0===i&&(i=[]),u=t.length-1;-1!==u;--u)v(t[u]);for(i.length=y,u=i.length-1;-1!==u;--u)n[i[u]]=0;for(u=t.length-1;-1!==u;--u)o=t[u],n[o]=e[o];for(u=i.length-1;-1!==u;--u){for(o=i[u],a=h[o],c=d(h[o+1],a),f=a;f!==c;++f)if(l[f]===o){n[o]/=p[f];break}for(m=n[o],f=a;f!==c;++f)(s=l[f])!==o&&(n[s]-=m*p[f])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,e,n,t,i,u){var o,a,c,f=0,s=i.length,m=this.k,h=this.k1,l=this.j;if(0===t[r])for(t[r]=1,l[0]=r,m[0]=a=e[r],h[0]=c=e[r+1];;)if(a>=c){if(i[s]=l[f],0===f)return;++s,a=m[--f],c=h[f]}else 0===t[o=u[n[a]]]?(t[o]=1,m[f]=a,l[++f]=o,a=e[o],h[f]=c=e[o+1]):++a},numeric.ccsLPSolve=function(r,e,n,t,i,u,o){var a,c,f,s,m,h,l,p,g,d=r[0],y=r[1],v=r[2],x=(d.length,e[0]),M=e[1],b=e[2];for(c=x[i],f=x[i+1],t.length=0,a=c;a<f;++a)o.dfs(u[M[a]],d,y,n,t,u);for(a=t.length-1;-1!==a;--a)n[t[a]]=0;for(a=c;a!==f;++a)n[s=u[M[a]]]=b[a];for(a=t.length-1;-1!==a;--a){for(m=d[s=t[a]],h=d[s+1],l=m;l<h;++l)if(u[y[l]]===s){n[s]/=v[l];break}for(g=n[s],l=m;l<h;++l)(p=u[y[l]])!==s&&(n[p]-=g*v[l])}return n},numeric.ccsLUP1=function(r,e){var n,t,i,u,o,a,c,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],g=m[0],d=m[1],y=m[2],v=numeric.rep([f],0),x=numeric.rep([f],0),M=numeric.ccsLPSolve,b=(Math.max,Math.abs),w=numeric.linspace(0,f-1),N=numeric.linspace(0,f-1),k=new numeric.ccsDFS(f);for(void 0===e&&(e=1),n=0;n<f;++n){for(M(s,r,v,x,n,N,k),u=-1,o=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=n||(a=b(v[i]))>u&&(o=i,u=a);for(b(v[n])<e*u&&(t=w[n],u=w[o],w[n]=u,N[u]=n,w[o]=t,N[t]=o,u=v[n],v[n]=v[o],v[o]=u),u=h[n],o=g[n],c=v[n],l[u]=w[n],p[u]=1,++u,t=x.length-1;-1!==t;--t)a=v[i=x[t]],x[t]=0,v[i]=0,i<=n?(d[o]=i,y[o]=a,++o):(l[u]=w[i],p[u]=a/c,++u);h[n+1]=u,g[n+1]=o}for(t=l.length-1;-1!==t;--t)l[t]=N[l[t]];return{L:s,U:m,P:w,Pinv:N}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,e,n,t,i,u,o){var a,c,f,s=0,m=i.length,h=this.k,l=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,h[0]=c=e[u[r]],l[0]=f=e[u[r]+1];;){if(isNaN(c))throw new Error("Ow!");if(c>=f){if(i[m]=u[p[s]],0===s)return;++m,c=h[--s],f=l[s]}else 0===t[a=n[c]]?(t[a]=1,h[s]=c,p[++s]=a,c=e[a=u[a]],l[s]=f=e[a+1]):++c}},numeric.ccsLPSolve0=function(r,e,n,t,i,u,o,a){var c,f,s,m,h,l,p,g,d,y=r[0],v=r[1],x=r[2],M=(y.length,e[0]),b=e[1],w=e[2];for(f=M[i],s=M[i+1],t.length=0,c=f;c<s;++c)a.dfs(b[c],y,v,n,t,u,o);for(c=t.length-1;-1!==c;--c)n[o[m=t[c]]]=0;for(c=f;c!==s;++c)n[m=b[c]]=w[c];for(c=t.length-1;-1!==c;--c){for(g=o[m=t[c]],h=y[m],l=y[m+1],p=h;p<l;++p)if(v[p]===g){n[g]/=x[p];break}for(d=n[g],p=h;p<l;++p)n[v[p]]-=d*x[p];n[g]=d}},numeric.ccsLUP0=function(r,e){var n,t,i,u,o,a,c,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],g=m[0],d=m[1],y=m[2],v=numeric.rep([f],0),x=numeric.rep([f],0),M=numeric.ccsLPSolve0,b=(Math.max,Math.abs),w=numeric.linspace(0,f-1),N=numeric.linspace(0,f-1),k=new numeric.ccsDFS0(f);for(void 0===e&&(e=1),n=0;n<f;++n){for(M(s,r,v,x,n,N,w,k),u=-1,o=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=n||(a=b(v[w[i]]))>u&&(o=i,u=a);for(b(v[w[n]])<e*u&&(t=w[n],u=w[o],w[n]=u,N[u]=n,w[o]=t,N[t]=o),u=h[n],o=g[n],c=v[w[n]],l[u]=w[n],p[u]=1,++u,t=x.length-1;-1!==t;--t)a=v[w[i=x[t]]],x[t]=0,v[w[i]]=0,i<=n?(d[o]=i,y[o]=a,++o):(l[u]=w[i],p[u]=a/c,++u);h[n+1]=u,g[n+1]=o}for(t=l.length-1;-1!==t;--t)l[t]=N[l[t]];return{L:s,U:m,P:w,Pinv:N}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,e,n){var t=numeric.ccsDim(r),i=t[0],u=t[1];void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),void 0===n?n=numeric.linspace(0,u-1):"number"==typeof n&&(n=[n]);var o,a,c,f,s=e.length,m=n.length,h=numeric.rep([u],0),l=[],p=[],g=[h,l,p],d=r[0],y=r[1],v=r[2],x=numeric.rep([i],0),M=0,b=numeric.rep([i],0);for(a=0;a<m;++a){var w=d[f=n[a]],N=d[f+1];for(o=w;o<N;++o)b[c=y[o]]=1,x[c]=v[o];for(o=0;o<s;++o)b[e[o]]&&(l[M]=o,p[M]=x[e[o]],++M);for(o=w;o<N;++o)b[c=y[o]]=0;h[a+1]=M}return g},numeric.ccsDot=function(r,e){var n,t,i,u,o,a,c,f,s,m,h,l=r[0],p=r[1],g=r[2],d=e[0],y=e[1],v=e[2],x=numeric.ccsDim(r),M=numeric.ccsDim(e),b=x[0],w=(x[1],M[1]),N=numeric.rep([b],0),k=numeric.rep([b],0),T=Array(b),_=numeric.rep([w],0),A=[],j=[],I=[_,A,j];for(i=0;i!==w;++i){for(u=d[i],o=d[i+1],s=0,t=u;t<o;++t)for(m=y[t],h=v[t],a=l[m],c=l[m+1],n=a;n<c;++n)0===k[f=p[n]]&&(T[s]=f,k[f]=1,s+=1),N[f]=N[f]+g[n]*h;for(o=(u=_[i])+s,_[i+1]=o,t=s-1;-1!==t;--t)h=u+t,n=T[t],A[h]=n,j[h]=N[n],k[n]=0,N[n]=0;_[i+1]=_[i]+s}return I},numeric.ccsLUPSolve=function(r,e){var n=r.L,t=r.U,i=(r.P,e[0]),u=!1;"object"!=typeof i&&(i=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],u=!0);var o,a,c,f,s,m,h=e[1],l=e[2],p=n[0].length-1,g=i.length-1,d=numeric.rep([p],0),y=Array(p),v=numeric.rep([p],0),x=Array(p),M=numeric.rep([g+1],0),b=[],w=[],N=numeric.ccsTSolve,k=0;for(o=0;o<g;++o){for(s=0,c=i[o],f=i[o+1],a=c;a<f;++a)m=r.Pinv[h[a]],x[s]=m,v[m]=l[a],++s;for(x.length=s,N(n,v,d,x,y),a=x.length-1;-1!==a;--a)v[x[a]]=0;if(N(t,d,v,y,x),u)return v;for(a=y.length-1;-1!==a;--a)d[y[a]]=0;for(a=x.length-1;-1!==a;--a)m=x[a],b[k]=m,w[k]=v[m],v[m]=0,++k;M[o+1]=k}return[M,b,w]},numeric.ccsbinop=function(r,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var e,n=r[0],t=r[1],i=r[2],u=numeric.sup(t)+1,o=n.length,a=numeric.rep([u],0),c=Array(o),f=Array(o),s=numeric.rep([u],0);for(e=0;e<o;++e)s[t[e]]++;for(e=0;e<u;++e)a[e+1]=a[e]+s[e];var m,h,l=a.slice(0);for(e=0;e<o;++e)c[m=l[h=t[e]]]=n[e],f[m]=i[e],l[h]=l[h]+1;return[a,c,f]},numeric.ccsGather=function(r){var e,n,t,i,u,o=r[0],a=r[1],c=r[2],f=o.length-1,s=a.length,m=Array(s),h=Array(s),l=Array(s);for(u=0,e=0;e<f;++e)for(t=o[e],i=o[e+1],n=t;n!==i;++n)h[u]=e,m[u]=a[n],l[u]=c[n],++u;return[m,h,l]},numeric.sdim=function r(e,n,t){if(void 0===n&&(n=[]),"object"!=typeof e)return n;var i;for(i in void 0===t&&(t=0),t in n||(n[t]=0),e.length>n[t]&&(n[t]=e.length),e)e.hasOwnProperty(i)&&r(e[i],n,t+1);return n},numeric.sclone=function r(e,n,t){void 0===n&&(n=0),void 0===t&&(t=numeric.sdim(e).length);var i,u=Array(e.length);if(n===t-1){for(i in e)e.hasOwnProperty(i)&&(u[i]=e[i]);return u}for(i in e)e.hasOwnProperty(i)&&(u[i]=r(e[i],n+1,t));return u},numeric.sdiag=function(r){var e,n,t=r.length,i=Array(t);for(e=t-1;e>=1;e-=2)n=e-1,i[e]=[],i[e][e]=r[e],i[n]=[],i[n][n]=r[n];return 0===e&&(i[0]=[],i[0][0]=r[e]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var e,n,t,i=[];r.length;for(e in r)if(r.hasOwnProperty(e))for(n in t=r[e])t.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][e]=t[n]);return i},numeric.sLUP=function(r,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,e){var n,t,i,u,o,a,c,f=r.length,s=(e.length,numeric.stranspose(e)),m=s.length,h=Array(f);for(i=f-1;i>=0;i--){for(c=[],n=r[i],o=m-1;o>=0;o--){for(u in a=0,t=s[o],n)n.hasOwnProperty(u)&&u in t&&(a+=n[u]*t[u]);a&&(c[o]=a)}h[i]=c}return h},numeric.sdotMV=function(r,e){var n,t,i,u,o=r.length,a=Array(o);for(t=o-1;t>=0;t--){for(i in u=0,n=r[t])n.hasOwnProperty(i)&&e[i]&&(u+=n[i]*e[i]);u&&(a[t]=u)}return a},numeric.sdotVM=function(r,e){var n,t,i,u,o=[];for(n in r)if(r.hasOwnProperty(n))for(t in i=e[n],u=r[n],i)i.hasOwnProperty(t)&&(o[t]||(o[t]=0),o[t]+=u*i[t]);return o},numeric.sdotVV=function(r,e){var n,t=0;for(n in r)r[n]&&e[n]&&(t+=r[n]*e[n]);return t},numeric.sdot=function(r,e){var n=numeric.sdim(r).length,t=numeric.sdim(e).length;switch(1e3*n+t){case 0:return r*e;case 1001:return numeric.sdotVV(r,e);case 2001:return numeric.sdotMV(r,e);case 1002:return numeric.sdotVM(r,e);case 2002:return numeric.sdotMM(r,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+t)}},numeric.sscatter=function(r){var e,n,t,i,u=r[0].length,o=r.length,a=[];for(n=u-1;n>=0;--n)if(r[o-1][n]){for(i=a,t=0;t<o-2;t++)i[e=r[t][n]]||(i[e]=[]),i=i[e];i[r[t][n]]=r[t+1][n]}return a},numeric.sgather=function r(e,n,t){var i,u,o;for(u in void 0===n&&(n=[]),void 0===t&&(t=[]),i=t.length,e)if(e.hasOwnProperty(u))if(t[i]=parseInt(u),"number"==typeof(o=e[u])){if(o){if(0===n.length)for(u=i+1;u>=0;--u)n[u]=[];for(u=i;u>=0;--u)n[u].push(t[u]);n[i+1].push(o)}}else r(o,n,t);return t.length>i&&t.pop(),n},numeric.cLU=function(r){var e,n,t,i,u,o,a=r[0],c=r[1],f=r[2],s=a.length,m=0;for(e=0;e<s;e++)a[e]>m&&(m=a[e]);m++;var h,l=Array(m),p=Array(m),g=numeric.rep([m],1/0),d=numeric.rep([m],-1/0);for(t=0;t<s;t++)e=a[t],(n=c[t])<g[e]&&(g[e]=n),n>d[e]&&(d[e]=n);for(e=0;e<m-1;e++)d[e]>d[e+1]&&(d[e+1]=d[e]);for(e=m-1;e>=1;e--)g[e]<g[e-1]&&(g[e-1]=g[e]);for(e=0;e<m;e++)p[e]=numeric.rep([d[e]-g[e]+1],0),l[e]=numeric.rep([e-g[e]],0),e-g[e]+1,d[e]-e+1;for(t=0;t<s;t++)p[e=a[t]][c[t]-g[e]]=f[t];for(e=0;e<m-1;e++)for(i=e-g[e],x=p[e],n=e+1;g[n]<=e&&n<m;n++)if(u=e-g[n],o=d[e]-e,h=(M=p[n])[u]/x[i]){for(t=1;t<=o;t++)M[t+u]-=h*x[t+i];l[n][e-g[n]]=h}var y,v,x=[],M=[],b=[],w=[],N=[],k=[];for(s=0,y=0,e=0;e<m;e++){for(i=g[e],u=d[e],v=p[e],n=e;n<=u;n++)v[n-i]&&(x[s]=e,M[s]=n,b[s]=v[n-i],s++);for(v=l[e],n=i;n<e;n++)v[n-i]&&(w[y]=e,N[y]=n,k[y]=v[n-i],y++);w[y]=e,N[y]=e,k[y]=1,y++}return{U:[x,M,b],L:[w,N,k]}},numeric.cLUsolve=function(r,e){var n,t,i=r.L,u=r.U,o=numeric.clone(e),a=i[0],c=i[1],f=i[2],s=u[0],m=u[1],h=u[2],l=s.length,p=(a.length,o.length);for(t=0,n=0;n<p;n++){for(;c[t]<n;)o[n]-=f[t]*o[c[t]],t++;t++}for(t=l-1,n=p-1;n>=0;n--){for(;m[t]>n;)o[n]-=h[t]*o[m[t]],t--;o[n]/=h[t],t--}return o},numeric.cgrid=function(r,e){"number"==typeof r&&(r=[r,r]);var n,t,i,u=numeric.rep(r,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,n){return e>=r[0]/2||n<r[1]/2};break;default:e=function(r,e){return!0}}for(i=0,n=1;n<r[0]-1;n++)for(t=1;t<r[1]-1;t++)e(n,t)&&(u[n][t]=i,i++);return u},numeric.cdelsq=function(r){var e,n,t,i,u,o=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(r),c=a[0],f=a[1],s=[],m=[],h=[];for(e=1;e<c-1;e++)for(n=1;n<f-1;n++)if(!(r[e][n]<0)){for(t=0;t<4;t++)i=e+o[t][0],u=n+o[t][1],r[i][u]<0||(s.push(r[e][n]),m.push(r[i][u]),h.push(-1));s.push(r[e][n]),m.push(r[e][n]),h.push(4)}return[s,m,h]},numeric.cdotMV=function(r,e){var n,t,i,u=r[0],o=r[1],a=r[2],c=u.length;for(i=0,t=0;t<c;t++)u[t]>i&&(i=u[t]);for(i++,n=numeric.rep([i],0),t=0;t<c;t++)n[u[t]]+=a[t]*e[o[t]];return n},numeric.Spline=function(r,e,n,t,i){this.x=r,this.yl=e,this.yr=n,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,e){var n,t,i,u=this.x,o=this.yl,a=this.yr,c=this.kl,f=this.kr,s=numeric.add,m=numeric.sub,h=numeric.mul;n=m(h(c[e],u[e+1]-u[e]),m(a[e+1],o[e])),t=s(h(f[e+1],u[e]-u[e+1]),m(a[e+1],o[e]));var l=(i=(r-u[e])/(u[e+1]-u[e]))*(1-i);return s(s(s(h(1-i,o[e]),h(i,a[e+1])),h(n,l*(1-i))),h(t,l*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var e,n,t,i=this.x,u=i.length,o=Math.floor;for(e=0,n=u-1;n-e>1;)i[t=o((e+n)/2)]<=r?e=t:n=t;return this._at(r,e)}u=r.length;var a,c=Array(u);for(a=u-1;-1!==a;--a)c[a]=this.at(r[a]);return c},numeric.Spline.prototype.diff=function(){var r,e,n,t=this.x,i=this.yl,u=this.yr,o=this.kl,a=this.kr,c=i.length,f=o,s=a,m=Array(c),h=Array(c),l=numeric.add,p=numeric.mul,g=numeric.div,d=numeric.sub;for(r=c-1;-1!==r;--r)e=t[r+1]-t[r],n=d(u[r+1],i[r]),m[r]=g(l(p(n,6),p(o[r],-4*e),p(a[r+1],-2*e)),e*e),h[r+1]=g(l(p(n,-6),p(o[r],2*e),p(a[r+1],4*e)),e*e);return new numeric.Spline(t,f,s,m,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var e=[],n=this.x,t=this.yl,i=this.yr,u=this.kl,o=this.kr;"number"==typeof t[0]&&(t=[t],i=[i],u=[u],o=[o]);var a,c,f,s,m,h,l,p,g,d,y,v,x,M,b,w,N,k,T,_,A,j,I,S=t.length,q=n.length-1,P=(e=Array(S),Math.sqrt);for(a=0;a!==S;++a){for(s=t[a],m=i[a],h=u[a],l=o[a],p=[],c=0;c!==q;c++){for(c>0&&m[c]*s[c]<0&&p.push(n[c]),w=n[c+1]-n[c],n[c],y=s[c],v=m[c+1],g=h[c]/w,x=(d=l[c+1]/w)+3*y+2*g-3*v,M=3*(d+g+2*(y-v)),(b=r(g-d+3*(y-v))+12*d*y)<=0?N=(k=x/M)>n[c]&&k<n[c+1]?[n[c],k,n[c+1]]:[n[c],n[c+1]]:(k=(x-P(b))/M,T=(x+P(b))/M,N=[n[c]],k>n[c]&&k<n[c+1]&&N.push(k),T>n[c]&&T<n[c+1]&&N.push(T),N.push(n[c+1])),A=N[0],k=this._at(A,c),f=0;f<N.length-1;f++)if(j=N[f+1],T=this._at(j,c),0!==k)if(0===T||k*T>0)A=j,k=T;else{for(var V=0;!((I=(k*j-T*A)/(k-T))<=A||I>=j);)if((_=this._at(I,c))*T>0)j=I,T=_,-1===V&&(k*=.5),V=-1;else{if(!(_*k>0))break;A=I,k=_,1===V&&(T*=.5),V=1}p.push(I),A=N[f+1],k=this._at(A,c)}else p.push(A),A=j,k=T;0===T&&p.push(j)}e[a]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(r,e,n,t){var i,u=r.length,o=[],a=[],c=[],f=numeric.sub,s=numeric.mul,m=numeric.add;for(i=u-2;i>=0;i--)a[i]=r[i+1]-r[i],c[i]=f(e[i+1],e[i]);"string"!=typeof n&&"string"!=typeof t||(n=t="periodic");var h=[[],[],[]];switch(typeof n){case"undefined":o[0]=s(3/(a[0]*a[0]),c[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/a[0],1/a[0]);break;case"string":o[0]=m(s(3/(a[u-2]*a[u-2]),c[u-2]),s(3/(a[0]*a[0]),c[0])),h[0].push(0,0,0),h[1].push(u-2,0,1),h[2].push(1/a[u-2],2/a[u-2]+2/a[0],1/a[0]);break;default:o[0]=n,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<u-1;i++)o[i]=m(s(3/(a[i-1]*a[i-1]),c[i-1]),s(3/(a[i]*a[i]),c[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof t){case"undefined":o[u-1]=s(3/(a[u-2]*a[u-2]),c[u-2]),h[0].push(u-1,u-1),h[1].push(u-2,u-1),h[2].push(1/a[u-2],2/a[u-2]);break;case"string":h[1][h[1].length-1]=0;break;default:o[u-1]=t,h[0].push(u-1),h[1].push(u-1),h[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var l=Array(o.length);if("string"==typeof n)for(i=l.length-1;-1!==i;--i)l[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),o[i]),l[i][u-1]=l[i][0];else for(i=l.length-1;-1!==i;--i)l[i]=numeric.cLUsolve(numeric.cLU(h),o[i]);return l="number"==typeof e[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,e,e,l,l)},numeric.fftpow2=function r(e,n){var t=e.length;if(1!==t){var i,u,o=Math.cos,a=Math.sin,c=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(u=t/2,i=t-1;-1!==i;--i)s[--u]=e[i],m[u]=n[i],--i,c[u]=e[i],f[u]=n[i];r(c,f),r(s,m),u=t/2;var h,l,p,g=-6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--u&&(u=t/2-1),l=o(h=g*i),p=a(h),e[i]=c[u]+l*s[u]-p*m[u],n[i]=f[u]+l*m[u]+p*s[u]}},numeric._ifftpow2=function r(e,n){var t=e.length;if(1!==t){var i,u,o=Math.cos,a=Math.sin,c=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(u=t/2,i=t-1;-1!==i;--i)s[--u]=e[i],m[u]=n[i],--i,c[u]=e[i],f[u]=n[i];r(c,f),r(s,m),u=t/2;var h,l,p,g=6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--u&&(u=t/2-1),l=o(h=g*i),p=a(h),e[i]=c[u]+l*s[u]-p*m[u],n[i]=f[u]+l*m[u]+p*s[u]}},numeric.ifftpow2=function(r,e){numeric._ifftpow2(r,e),numeric.diveq(r,r.length),numeric.diveq(e,e.length)},numeric.convpow2=function(r,e,n,t){var i,u,o,a,c;for(numeric.fftpow2(r,e),numeric.fftpow2(n,t),i=r.length-1;-1!==i;--i)u=r[i],a=e[i],o=n[i],c=t[i],r[i]=u*o-a*c,e[i]=u*c+a*o;numeric.ifftpow2(r,e)},numeric.T.prototype.fft=function(){var r,e,n=this.x,t=this.y,i=n.length,u=Math.log,o=u(2),a=Math.ceil(u(2*i-1)/o),c=Math.pow(2,a),f=numeric.rep([c],0),s=numeric.rep([c],0),m=Math.cos,h=Math.sin,l=-3.141592653589793/i,p=numeric.rep([c],0),g=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=n[r];if(void 0!==t)for(r=0;r<i;r++)g[r]=t[r];for(f[0]=1,r=1;r<=c/2;r++)e=l*r*r,f[r]=m(e),s[r]=h(e),f[c-r]=m(e),s[c-r]=h(e);var d=new numeric.T(p,g),y=new numeric.T(f,s);return d=d.mul(y),numeric.convpow2(d.x,d.y,numeric.clone(y.x),numeric.neg(y.y)),(d=d.mul(y)).x.length=i,d.y.length=i,d},numeric.T.prototype.ifft=function(){var r,e,n=this.x,t=this.y,i=n.length,u=Math.log,o=u(2),a=Math.ceil(u(2*i-1)/o),c=Math.pow(2,a),f=numeric.rep([c],0),s=numeric.rep([c],0),m=Math.cos,h=Math.sin,l=3.141592653589793/i,p=numeric.rep([c],0),g=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=n[r];if(void 0!==t)for(r=0;r<i;r++)g[r]=t[r];for(f[0]=1,r=1;r<=c/2;r++)e=l*r*r,f[r]=m(e),s[r]=h(e),f[c-r]=m(e),s[c-r]=h(e);var d=new numeric.T(p,g),y=new numeric.T(f,s);return d=d.mul(y),numeric.convpow2(d.x,d.y,numeric.clone(y.x),numeric.neg(y.y)),(d=d.mul(y)).x.length=i,d.y.length=i,d.div(i)},numeric.gradient=function(r,e){var n=e.length,t=r(e);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,u,o,a,c,f,s,m,h,l=Math.max,p=numeric.clone(e),g=Array(n),d=(numeric.div,numeric.sub,l=Math.max,Math.abs),y=Math.min,v=0;for(i=0;i<n;i++)for(var x=l(1e-6*t,1e-8);;){if(++v>20)throw new Error("Numerical gradient fails");if(p[i]=e[i]+x,u=r(p),p[i]=e[i]-x,o=r(p),p[i]=e[i],isNaN(u)||isNaN(o))x/=16;else{if(g[i]=(u-o)/(2*x),a=e[i]-x,c=e[i],f=e[i]+x,s=(u-t)/x,m=(t-o)/x,h=l(d(g[i]),d(t),d(u),d(o),d(a),d(c),d(f),1e-8),!(y(l(d(s-g[i]),d(m-g[i]),d(s-m))/h,x/h)>.001))break;x/=16}}return g},numeric.uncmin=function(r,e,n,t,i,u,o){var a=numeric.gradient;void 0===o&&(o={}),void 0===n&&(n=1e-8),void 0===t&&(t=function(e){return a(r,e)}),void 0===i&&(i=1e3);var c,f,s=(e=numeric.clone(e)).length,m=r(e);if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,l=numeric.norm2;n=h(n,numeric.epsilon);var p,g,d,y,v,x,M,b,w,N,k=o.Hinv||numeric.identity(s),T=numeric.dot,_=(numeric.inv,numeric.sub),A=numeric.add,j=numeric.tensor,I=numeric.div,S=numeric.mul,q=numeric.all,P=numeric.isFinite,V=numeric.neg,F=0,O="";for(g=t(e);F<i;){if("function"==typeof u&&u(F,e,m,g,k)){O="Callback returned true";break}if(!q(P(g))){O="Gradient has Infinity or NaN";break}if(!q(P(p=V(T(k,g))))){O="Search direction has Infinity or NaN";break}if((N=l(p))<n){O="Newton step smaller than tol";break}for(w=1,f=T(g,p),v=e;F<i&&!(w*N<n)&&(v=A(e,y=S(p,w)),(c=r(v))-m>=.1*w*f||isNaN(c));)w*=.5,++F;if(w*N<n){O="Line search step size smaller than tol";break}if(F===i){O="maxit reached during line search";break}k=_(A(k,S(((b=T(x=_(d=t(v),g),y))+T(x,M=T(k,x)))/(b*b),j(y,y))),I(A(j(M,y),j(y,M)),b)),e=v,m=c,g=d,++F}return{solution:e,f:m,gradient:g,invHessian:k,iterations:F,message:O}},numeric.Dopri=function(r,e,n,t,i,u,o){this.x=r,this.y=e,this.f=n,this.ymid=t,this.iterations=i,this.events=o,this.message=u},numeric.Dopri.prototype._at=function(r,e){function n(r){return r*r}var t,i,u,o,a,c,f,s,m,h=this.x,l=this.y,p=this.f,g=this.ymid,d=(h.length,Math.floor,numeric.add),y=numeric.mul,v=numeric.sub;return t=h[e],i=h[e+1],o=l[e],a=l[e+1],u=t+.5*(i-t),c=g[e],f=v(p[e],y(o,1/(t-u)+2/(t-i))),s=v(p[e+1],y(a,1/(i-u)+2/(i-t))),d(d(d(d(y(o,(m=[n(r-i)*(r-u)/n(t-i)/(t-u),n(r-t)*n(r-i)/n(t-u)/n(i-u),n(r-t)*(r-u)/n(i-t)/(i-u),(r-t)*n(r-i)*(r-u)/n(t-i)/(t-u),(r-i)*n(r-t)*(r-u)/n(t-i)/(i-u)])[0]),y(c,m[1])),y(a,m[2])),y(f,m[3])),y(s,m[4]))},numeric.Dopri.prototype.at=function(r){var e,n,t,i=Math.floor;if("number"!=typeof r){var u=r.length,o=Array(u);for(e=u-1;-1!==e;--e)o[e]=this.at(r[e]);return o}var a=this.x;for(e=0,n=a.length-1;n-e>1;)a[t=i(.5*(e+n))]<=r?e=t:n=t;return this._at(r,e)},numeric.dopri=function(r,e,n,t,i,u,o){void 0===i&&(i=1e-6),void 0===u&&(u=1e3);var a,c,f,s,m,h,l,p,g,d,y,v,x,M=[r],b=[n],w=[t(r,n)],N=[],k=[.075,.225],T=[44/45,-56/15,32/9],_=[19372/6561,-25360/2187,64448/6561,-212/729],A=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],j=[35/384,0,500/1113,125/192,-2187/6784,11/84],I=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],S=[.2,.3,.8,8/9,1,1],q=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],P=0,V=(e-r)/10,F=0,O=numeric.add,E=numeric.mul,L=(Math.max,Math.min),U=Math.abs,Y=numeric.norminf,D=Math.pow,B=numeric.any,R=numeric.lt,X=numeric.and,Q=(numeric.sub,new numeric.Dopri(M,b,w,N,-1,""));for("function"==typeof o&&(y=o(r,n));r<e&&F<u;)if(++F,r+V>e&&(V=e-r),a=t(r+S[0]*V,O(n,E(.2*V,w[P]))),c=t(r+S[1]*V,O(O(n,E(k[0]*V,w[P])),E(k[1]*V,a))),f=t(r+S[2]*V,O(O(O(n,E(T[0]*V,w[P])),E(T[1]*V,a)),E(T[2]*V,c))),s=t(r+S[3]*V,O(O(O(O(n,E(_[0]*V,w[P])),E(_[1]*V,a)),E(_[2]*V,c)),E(_[3]*V,f))),m=t(r+S[4]*V,O(O(O(O(O(n,E(A[0]*V,w[P])),E(A[1]*V,a)),E(A[2]*V,c)),E(A[3]*V,f)),E(A[4]*V,s))),h=t(r+V,g=O(O(O(O(O(n,E(w[P],V*j[0])),E(c,V*j[2])),E(f,V*j[3])),E(s,V*j[4])),E(m,V*j[5]))),(d="number"==typeof(l=O(O(O(O(O(E(w[P],V*q[0]),E(c,V*q[2])),E(f,V*q[3])),E(s,V*q[4])),E(m,V*q[5])),E(h,V*q[6])))?U(l):Y(l))>i){if(r+(V=.2*V*D(i/d,.25))===r){Q.msg="Step size became too small";break}}else{if(N[P]=O(O(O(O(O(O(n,E(w[P],V*I[0])),E(c,V*I[2])),E(f,V*I[3])),E(s,V*I[4])),E(m,V*I[5])),E(h,V*I[6])),M[++P]=r+V,b[P]=g,w[P]=h,"function"==typeof o){var C,Z,$=r,H=r+.5*V;if(v=o(H,N[P-1]),B(x=X(R(y,0),R(0,v)))||($=H,y=v,v=o(H=r+V,g),x=X(R(y,0),R(0,v))),B(x)){for(var G,z,K=0,J=1,W=1;;){if("number"==typeof y)Z=(W*v*$-J*y*H)/(W*v-J*y);else for(Z=H,p=y.length-1;-1!==p;--p)y[p]<0&&v[p]>0&&(Z=L(Z,(W*v[p]*$-J*y[p]*H)/(W*v[p]-J*y[p])));if(Z<=$||Z>=H)break;z=o(Z,C=Q._at(Z,P-1)),B(G=X(R(y,0),R(0,z)))?(H=Z,v=z,x=G,W=1,-1===K?J*=.5:J=1,K=-1):($=Z,y=z,J=1,1===K?W*=.5:W=1,K=1)}return g=Q._at(.5*(r+Z),P-1),Q.f[P]=t(Z,C),Q.x[P]=Z,Q.y[P]=C,Q.ymid[P-1]=g,Q.events=x,Q.iterations=F,Q}}r+=V,n=g,y=v,V=L(.8*V*D(i/d,.25),4*V)}return Q.iterations=F,Q},numeric.LU=function(r,e){e=e||!1;var n,t,i,u,o,a,c,f,s,m=Math.abs,h=r.length,l=h-1,p=new Array(h);for(e||(r=numeric.clone(r)),i=0;i<h;++i){for(c=i,s=m((a=r[i])[i]),t=i+1;t<h;++t)s<(u=m(r[t][i]))&&(s=u,c=t);for(p[i]=c,c!=i&&(r[i]=r[c],r[c]=a,a=r[i]),o=a[i],n=i+1;n<h;++n)r[n][i]/=o;for(n=i+1;n<h;++n){for(f=r[n],t=i+1;t<l;++t)f[t]-=f[i]*a[t],f[++t]-=f[i]*a[t];t===l&&(f[t]-=f[i]*a[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,e){var n,t,i,u,o,a=r.LU,c=a.length,f=numeric.clone(e),s=r.P;for(n=c-1;-1!==n;--n)f[n]=e[n];for(n=0;n<c;++n)for(i=s[n],s[n]!==n&&(o=f[n],f[n]=f[i],f[i]=o),u=a[n],t=0;t<n;++t)f[n]-=f[t]*u[t];for(n=c-1;n>=0;--n){for(u=a[n],t=n+1;t<c;++t)f[n]-=f[t]*u[t];f[n]/=u[n]}return f},numeric.solve=function(r,e,n){return numeric.LUsolve(numeric.LU(r,n),e)},numeric.echelonize=function(r){var e,n,t,i,u,o,a,c,f=numeric.dim(r),s=f[0],m=f[1],h=numeric.identity(s),l=Array(s),p=Math.abs,g=numeric.diveq;for(r=numeric.clone(r),e=0;e<s;++e){for(t=0,u=r[e],o=h[e],n=1;n<m;++n)p(u[t])<p(u[n])&&(t=n);for(l[e]=t,g(o,u[t]),g(u,u[t]),n=0;n<s;++n)if(n!==e){for(c=(a=r[n])[t],i=m-1;-1!==i;--i)a[i]-=u[i]*c;for(a=h[n],i=s-1;-1!==i;--i)a[i]-=o[i]*c}}return{I:h,A:r,P:l}},numeric.__solveLP=function(r,e,n,t,i,u,o){var a,c,f,s,m=numeric.sum,h=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,g=numeric.div,d=numeric.add,y=r.length,v=n.length,x=!1,M=1,b=(numeric.transpose(e),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),N=Math.abs,k=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,_=numeric.gt,A=Array(y),j=Array(v),I=(numeric.rep([v],1),numeric.solve),S=l(n,p(e,u)),q=p(r,r);for(f=0;f<i;++f){var P,V;for(P=v-1;-1!==P;--P)j[P]=g(e[P],S[P]);var F=b(j);for(P=y-1;-1!==P;--P)A[P]=m(F[P]);M=.25*N(q/p(r,A));var O=100*w(q/p(A,A));for((!isFinite(M)||M>O)&&(M=O),s=d(r,h(M,A)),c=p(F,j),P=y-1;-1!==P;--P)c[P][P]+=1;var E=g(S,p(e,V=I(c,g(s,M),!0))),L=1;for(P=v-1;-1!==P;--P)E[P]<0&&(L=k(L,-.999*E[P]));if(!T(_(S=l(n,p(e,a=l(u,h(V,L)))),0)))return{solution:u,message:"",iterations:f};if(u=a,M<t)return{solution:a,message:"",iterations:f};if(o){var U=p(r,s),Y=p(e,s);for(x=!0,P=v-1;-1!==P;--P)if(U*Y[P]<0){x=!1;break}}else x=!(u[y-1]>=0);if(x)return{solution:a,message:"Unbounded",iterations:f}}return{solution:u,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,e,n,t,i){var u=r.length,o=n.length,a=(numeric.sum,numeric.log,numeric.mul,numeric.sub),c=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([u],0).concat([1])),s=numeric.rep([o,1],-1),m=numeric.blockMatrix([[e,s]]),h=n,l=numeric.rep([u],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(f,m,h,t,i,l,!1),g=numeric.clone(p.solution);if(g.length=u,numeric.inf(a(n,c(e,g)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var d=numeric.__solveLP(r,e,n,t,i-p.iterations,g,!0);return d.iterations+=p.iterations,d},numeric.solveLP=function(r,e,n,t,i,u,o){if(void 0===o&&(o=1e3),void 0===u&&(u=numeric.epsilon),void 0===t)return numeric._solveLP(r,e,n,u,o);var a,c=t.length,f=t[0].length,s=e.length,m=numeric.echelonize(t),h=numeric.rep([f],0),l=m.P,p=[];for(a=l.length-1;-1!==a;--a)h[l[a]]=1;for(a=f-1;-1!==a;--a)0===h[a]&&p.push(a);var g=numeric.getRange,d=numeric.linspace(0,c-1),y=numeric.linspace(0,s-1),v=g(t,d,p),x=g(e,y,l),M=g(e,y,p),b=numeric.dot,w=numeric.sub,N=b(x,m.I),k=w(M,b(N,v)),T=w(n,b(N,i)),_=Array(l.length),A=Array(p.length);for(a=l.length-1;-1!==a;--a)_[a]=r[l[a]];for(a=p.length-1;-1!==a;--a)A[a]=r[p[a]];var j=w(A,b(_,b(m.I,v))),I=numeric._solveLP(j,k,T,u,o),S=I.solution;if(S!=S)return I;var q=b(m.I,w(i,b(v,S))),P=Array(r.length);for(a=l.length-1;-1!==a;--a)P[l[a]]=q[a];for(a=p.length-1;-1!==a;--a)P[p[a]]=S[a];return{solution:P,message:I.message,iterations:I.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\n");var e,n,t,i,u=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],a=r.length,c=0,f={},s=[],m=0,h={},l=0,p=[],g=[],d=[];function y(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+r[e]+"\nCurrent state: "+o[u]+"\n")}for(e=0;e<a;++e){var v=(t=r[e]).match(/\S*/g),x=[];for(n=0;n<v.length;++n)""!==v[n]&&x.push(v[n]);if(0!==x.length){for(n=0;n<o.length&&t.substr(0,o[n].length)!==o[n];++n);if(n<o.length){if(u=n,1===n&&(i=x[1]),6===n)return{name:i,c:p,A:numeric.transpose(g),b:d,rows:f,vars:h}}else switch(u){case 0:case 1:y("Unexpected line");case 2:switch(x[0]){case"N":0===c?c=x[1]:y("Two or more N rows");break;case"L":f[x[1]]=m,s[m]=1,d[m]=0,++m;break;case"G":f[x[1]]=m,s[m]=-1,d[m]=0,++m;break;case"E":f[x[1]]=m,s[m]=0,d[m]=0,++m;break;default:y("Parse error "+numeric.prettyPrint(x))}break;case 3:h.hasOwnProperty(x[0])||(h[x[0]]=l,p[l]=0,g[l]=numeric.rep([m],0),++l);var M=h[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==c){var b=f[x[n]];g[M][b]=(s[b]<0?-1:1)*parseFloat(x[n+1])}else p[M]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)d[f[x[n]]]=(s[f[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:y("Internal error")}}}y("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,e,n,t,i,u,o){function a(r,e,n,t){for(r+="",n=0,t=0;t<r.length;t++)e[c(t)]=c((n^=19*e[c(t)])+r.charCodeAt(t));for(t in r="",e)r+=String.fromCharCode(e[t]);return r}function c(r){return r&n-1}e.seedrandom=function(t,f){var s,m=[];return t=a(function r(e,n,t,i,u){t=[];u=typeof e;if(n&&"object"==u)for(i in e)if(i.indexOf("S")<5)try{t.push(r(e[i],n-1))}catch(r){}return t.length?t:e+("string"!=u?"\0":"")}(f?[t,r]:arguments.length?t:[(new Date).getTime(),r,window],3),m),a((s=new function(r){var e,t,i=this,u=r.length,o=0,a=i.i=i.j=i.m=0;i.S=[],i.c=[],u||(r=[u++]);for(;o<n;)i.S[o]=o++;for(o=0;o<n;o++)e=i.S[o],a=c(a+e+r[o%u]),t=i.S[a],i.S[o]=t,i.S[a]=e;i.g=function(r){var e=i.S,t=c(i.i+1),u=e[t],o=c(i.j+u),a=e[o];e[t]=a,e[o]=u;for(var f=e[c(u+a)];--r;)t=c(t+1),u=e[t],o=c(o+u),a=e[o],e[t]=a,e[o]=u,f=f*n+e[c(u+a)];return i.i=t,i.j=o,f},i.g(n)}(m)).S,r),e.random=function(){for(var r=s.g(6),e=o,t=0;r<i;)r=(r+t)*n,e*=n,t=s.g(1);for(;r>=u;)r/=2,e/=2,t>>>=1;return(r+t)/e},t},o=e.pow(n,6),i=e.pow(2,i),u=2*i,a(e.random(),r)}([],numeric.seedrandom,256,0,52),function(r){function e(r){if("object"!=typeof r)return r;var n,t=[],i=r.length;for(n=0;n<i;n++)t[n+1]=e(r[n]);return t}function n(r){if("object"!=typeof r)return r;var e,t=[],i=r.length;for(e=1;e<i;e++)t[e-1]=n(r[e]);return t}function t(r,e,n,t,i,u,o,a,c,f,s,m,h,l,p,g){var d,y,v,x,M,b,w,N,k,T,_,A,j,I,S,q,P,V,F,O,E,L,U,Y,D,B,R;j=Math.min(t,f),v=2*t+j*(j+5)/2+2*f+1,Y=1e-60;do{D=1+.1*(Y+=Y),B=1+.2*Y}while(D<=1||B<=1);for(d=1;d<=t;d+=1)p[d]=e[d];for(d=t+1;d<=v;d+=1)p[d]=0;for(d=1;d<=f;d+=1)m[d]=0;if(M=[],0===g[1]){if(function(r,e,n,t){var i,u,o,a,c,f;for(u=1;u<=n;u+=1){if(t[1]=u,f=0,(o=u-1)<1){if((f=r[u][u]-f)<=0)break;r[u][u]=Math.sqrt(f)}else{for(a=1;a<=o;a+=1){for(c=r[a][u],i=1;i<a;i+=1)c-=r[i][u]*r[i][a];c/=r[a][a],r[a][u]=c,f+=c*c}if((f=r[u][u]-f)<=0)break;r[u][u]=Math.sqrt(f)}t[1]=0}}(r,0,t,M),0!==M[1])return void(g[1]=2);!function(r,e,n,t){var i,u,o,a;for(u=1;u<=n;u+=1){for(a=0,i=1;i<u;i+=1)a+=r[i][u]*t[i];t[u]=(t[u]-a)/r[u][u]}for(o=1;o<=n;o+=1)for(t[u=n+1-o]=t[u]/r[u][u],a=-t[u],i=1;i<u;i+=1)t[i]=t[i]+a*r[i][u]}(r,0,t,e),function(r,e,n){var t,i,u,o,a;for(u=1;u<=n;u+=1){for(r[u][u]=1/r[u][u],a=-r[u][u],t=1;t<u;t+=1)r[t][u]=a*r[t][u];if(n<(o=u+1))break;for(i=o;i<=n;i+=1)for(a=r[u][i],r[u][i]=0,t=1;t<=u;t+=1)r[t][i]=r[t][i]+a*r[t][u]}}(r,0,t)}else{for(y=1;y<=t;y+=1)for(i[y]=0,d=1;d<=y;d+=1)i[y]=i[y]+r[d][y]*e[d];for(y=1;y<=t;y+=1)for(e[y]=0,d=y;d<=t;d+=1)e[y]=e[y]+r[y][d]*i[d]}for(u[1]=0,y=1;y<=t;y+=1)for(i[y]=e[y],u[1]=u[1]+p[y]*i[y],p[y]=0,d=y+1;d<=t;d+=1)r[d][y]=0;for(u[1]=-u[1]/2,g[1]=0,I=(T=(k=(_=(N=(w=t)+t)+j)+j+1)+j*(j+1)/2)+f,d=1;d<=f;d+=1){for(q=0,y=1;y<=t;y+=1)q+=o[y][d]*o[y][d];p[I+d]=Math.sqrt(q)}function X(){for(l[1]=l[1]+1,v=T,d=1;d<=f;d+=1){for(v+=1,q=-a[d],y=1;y<=t;y+=1)q+=o[y][d]*i[y];if(Math.abs(q)<Y&&(q=0),d>s)p[v]=q;else if(p[v]=-Math.abs(q),q>0){for(y=1;y<=t;y+=1)o[y][d]=-o[y][d];a[d]=-a[d]}}for(d=1;d<=h;d+=1)p[T+m[d]]=0;for(A=0,S=0,d=1;d<=f;d+=1)p[T+d]<S*p[I+d]&&(A=d,S=p[T+d]/p[I+d]);return 0===A?999:0}function Q(){for(d=1;d<=t;d+=1){for(q=0,y=1;y<=t;y+=1)q+=r[y][d]*o[y][A];p[d]=q}for(x=w,d=1;d<=t;d+=1)p[x+d]=0;for(y=h+1;y<=t;y+=1)for(d=1;d<=t;d+=1)p[x+d]=p[x+d]+r[d][y]*p[y];for(L=!0,d=h;d>=1;d-=1){for(q=p[d],x=(v=k+d*(d+3)/2)-d,y=d+1;y<=h;y+=1)q-=p[v]*p[N+y],v+=y;if(q/=p[x],p[N+d]=q,m[d]<s)break;if(q<0)break;L=!1,b=d}if(!L)for(P=p[_+b]/p[N+b],d=1;d<=h&&!(m[d]<s)&&!(p[N+d]<0);d+=1)(S=p[_+d]/p[N+d])<P&&(P=S,b=d);for(q=0,d=w+1;d<=w+t;d+=1)q+=p[d]*p[d];if(Math.abs(q)<=Y){if(L)return g[1]=1,999;for(d=1;d<=h;d+=1)p[_+d]=p[_+d]-P*p[N+d];return p[_+h+1]=p[_+h+1]+P,700}for(q=0,d=1;d<=t;d+=1)q+=p[w+d]*o[d][A];for(V=-p[T+A]/q,U=!0,L||P<V&&(V=P,U=!1),d=1;d<=t;d+=1)i[d]=i[d]+V*p[w+d],Math.abs(i[d])<Y&&(i[d]=0);for(u[1]=u[1]+V*q*(V/2+p[_+h+1]),d=1;d<=h;d+=1)p[_+d]=p[_+d]-V*p[N+d];if(p[_+h+1]=p[_+h+1]+V,!U){for(q=-a[A],y=1;y<=t;y+=1)q+=i[y]*o[y][A];if(A>s)p[T+A]=q;else if(p[T+A]=-Math.abs(q),q>0){for(y=1;y<=t;y+=1)o[y][A]=-o[y][A];a[A]=-a[A]}return 700}for(m[h+=1]=A,v=k+(h-1)*h/2+1,d=1;d<=h-1;d+=1)p[v]=p[d],v+=1;if(h===t)p[v]=p[t];else{for(d=t;d>=h+1&&0!==p[d]&&(F=Math.max(Math.abs(p[d-1]),Math.abs(p[d])),O=Math.min(Math.abs(p[d-1]),Math.abs(p[d])),S=p[d-1]>=0?Math.abs(F*Math.sqrt(1+O*O/(F*F))):-Math.abs(F*Math.sqrt(1+O*O/(F*F))),F=p[d-1]/S,O=p[d]/S,1!==F);d-=1)if(0===F)for(p[d-1]=O*S,y=1;y<=t;y+=1)S=r[y][d-1],r[y][d-1]=r[y][d],r[y][d]=S;else for(p[d-1]=S,E=O/(1+F),y=1;y<=t;y+=1)S=F*r[y][d-1]+O*r[y][d],r[y][d]=E*(r[y][d-1]+S)-r[y][d],r[y][d-1]=S;p[v]=p[h]}return 0}function C(){if(0===p[x=(v=k+b*(b+1)/2+1)+b])return 798;if(F=Math.max(Math.abs(p[x-1]),Math.abs(p[x])),O=Math.min(Math.abs(p[x-1]),Math.abs(p[x])),S=p[x-1]>=0?Math.abs(F*Math.sqrt(1+O*O/(F*F))):-Math.abs(F*Math.sqrt(1+O*O/(F*F))),F=p[x-1]/S,O=p[x]/S,1===F)return 798;if(0===F){for(d=b+1;d<=h;d+=1)S=p[x-1],p[x-1]=p[x],p[x]=S,x+=d;for(d=1;d<=t;d+=1)S=r[d][b],r[d][b]=r[d][b+1],r[d][b+1]=S}else{for(E=O/(1+F),d=b+1;d<=h;d+=1)S=F*p[x-1]+O*p[x],p[x]=E*(p[x-1]+S)-p[x],p[x-1]=S,x+=d;for(d=1;d<=t;d+=1)S=F*r[d][b]+O*r[d][b+1],r[d][b+1]=E*(r[d][b]+S)-r[d][b+1],r[d][b]=S}return 0}function Z(){for(x=v-b,d=1;d<=b;d+=1)p[x]=p[v],v+=1,x+=1;return p[_+b]=p[_+b+1],m[b]=m[b+1],(b+=1)<h?797:0}function $(){return p[_+h]=p[_+h+1],p[_+h+1]=0,m[h]=0,h-=1,l[2]=l[2]+1,0}for(h=0,l[1]=0,l[2]=0,R=0;;){if(999===(R=X()))return;for(;0!==(R=Q());){if(999===R)return;if(700===R)if(b===h)$();else{for(;C(),797===(R=Z()););$()}}}}numeric.solveQP=function(r,i,u,o,a,c){r=e(r),i=e(i),u=e(u);var f,s,m,h,l,p=[],g=[],d=[],y=[],v=[];if(a=a||0,c=c?e(c):[void 0,0],o=o?e(o):[],s=r.length-1,m=u[1].length-1,!o)for(f=1;f<=m;f+=1)o[f]=0;for(f=1;f<=m;f+=1)g[f]=0;for(h=Math.min(s,m),f=1;f<=s;f+=1)d[f]=0;for(p[1]=0,f=1;f<=2*s+h*(h+5)/2+2*m+1;f+=1)y[f]=0;for(f=1;f<=2;f+=1)v[f]=0;return t(r,i,0,s,d,p,u,o,0,m,a,g,0,v,y,c),l="",1===c[1]&&(l="constraints are inconsistent, no solution!"),2===c[1]&&(l="matrix D in quadratic function is not positive definite!"),{solution:n(d),value:n(p),unconstrained_solution:n(i),iterations:n(v),iact:n(g),message:l}}}(),numeric.svd=function(r){var e,n=numeric.epsilon,t=1e-64/n,i=0,u=0,o=0,a=0,c=0,f=numeric.clone(r),s=f.length,m=f[0].length;if(s<m)throw"Need more rows than columns";var h=new Array(m),l=new Array(m);for(u=0;u<m;u++)h[u]=l[u]=0;var p=numeric.rep([m,m],0);function g(r,e){return(r=Math.abs(r))>(e=Math.abs(e))?r*Math.sqrt(1+e*e/r/r):0==e?r:e*Math.sqrt(1+r*r/e/e)}var d=0,y=0,v=0,x=0,M=0,b=0,w=0;for(u=0;u<m;u++){for(h[u]=y,w=0,c=u+1,o=u;o<s;o++)w+=f[o][u]*f[o][u];if(w<=t)y=0;else for(d=f[u][u],y=Math.sqrt(w),d>=0&&(y=-y),v=d*y-w,f[u][u]=d-y,o=c;o<m;o++){for(w=0,a=u;a<s;a++)w+=f[a][u]*f[a][o];for(d=w/v,a=u;a<s;a++)f[a][o]+=d*f[a][u]}for(l[u]=y,w=0,o=c;o<m;o++)w+=f[u][o]*f[u][o];if(w<=t)y=0;else{for(d=f[u][u+1],y=Math.sqrt(w),d>=0&&(y=-y),v=d*y-w,f[u][u+1]=d-y,o=c;o<m;o++)h[o]=f[u][o]/v;for(o=c;o<s;o++){for(w=0,a=c;a<m;a++)w+=f[o][a]*f[u][a];for(a=c;a<m;a++)f[o][a]+=w*h[a]}}(M=Math.abs(l[u])+Math.abs(h[u]))>x&&(x=M)}for(u=m-1;-1!=u;u+=-1){if(0!=y){for(v=y*f[u][u+1],o=c;o<m;o++)p[o][u]=f[u][o]/v;for(o=c;o<m;o++){for(w=0,a=c;a<m;a++)w+=f[u][a]*p[a][o];for(a=c;a<m;a++)p[a][o]+=w*p[a][u]}}for(o=c;o<m;o++)p[u][o]=0,p[o][u]=0;p[u][u]=1,y=h[u],c=u}for(u=m-1;-1!=u;u+=-1){for(c=u+1,y=l[u],o=c;o<m;o++)f[u][o]=0;if(0!=y){for(v=f[u][u]*y,o=c;o<m;o++){for(w=0,a=c;a<s;a++)w+=f[a][u]*f[a][o];for(d=w/v,a=u;a<s;a++)f[a][o]+=d*f[a][u]}for(o=u;o<s;o++)f[o][u]=f[o][u]/y}else for(o=u;o<s;o++)f[o][u]=0;f[u][u]+=1}for(n*=x,a=m-1;-1!=a;a+=-1)for(var N=0;N<50;N++){var k=!1;for(c=a;-1!=c;c+=-1){if(Math.abs(h[c])<=n){k=!0;break}if(Math.abs(l[c-1])<=n)break}if(!k){i=0,w=1;var T=c-1;for(u=c;u<a+1&&(d=w*h[u],h[u]=i*h[u],!(Math.abs(d)<=n));u++)for(v=g(d,y=l[u]),l[u]=v,i=y/v,w=-d/v,o=0;o<s;o++)M=f[o][T],b=f[o][u],f[o][T]=M*i+b*w,f[o][u]=-M*w+b*i}if(b=l[a],c==a){if(b<0)for(l[a]=-b,o=0;o<m;o++)p[o][a]=-p[o][a];break}if(N>=49)throw"Error: no convergence.";for(x=l[c],y=g(d=(((M=l[a-1])-b)*(M+b)+((y=h[a-1])-(v=h[a]))*(y+v))/(2*v*M),1),d=d<0?((x-b)*(x+b)+v*(M/(d-y)-v))/x:((x-b)*(x+b)+v*(M/(d+y)-v))/x,i=1,w=1,u=c+1;u<a+1;u++){for(y=h[u],M=l[u],v=w*y,y*=i,b=g(d,v),h[u-1]=b,d=x*(i=d/b)+y*(w=v/b),y=-x*w+y*i,v=M*w,M*=i,o=0;o<m;o++)x=p[o][u-1],b=p[o][u],p[o][u-1]=x*i+b*w,p[o][u]=-x*w+b*i;for(b=g(d,v),l[u-1]=b,d=(i=d/b)*y+(w=v/b)*M,x=-w*y+i*M,o=0;o<s;o++)M=f[o][u-1],b=f[o][u],f[o][u-1]=M*i+b*w,f[o][u]=-M*w+b*i}h[c]=0,h[a]=d,l[a]=x}for(u=0;u<l.length;u++)l[u]<n&&(l[u]=0);for(u=0;u<m;u++)for(o=u-1;o>=0;o--)if(l[o]<l[u]){for(i=l[o],l[o]=l[u],l[u]=i,a=0;a<f.length;a++)e=f[a][u],f[a][u]=f[a][o],f[a][o]=e;for(a=0;a<p.length;a++)e=p[a][u],p[a][u]=p[a][o],p[a][o]=e;u=o}return{U:f,S:l,V:p}}}).call(exports,__webpack_require__(4))},function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"_AggregationTest",function(){return a}),n.d(e,"SkatTest",function(){return f}),n.d(e,"ZegginiBurdenTest",function(){return c}),n.d(e,"_skatDavies",function(){return s}),n.d(e,"_skatLiu",function(){return m});var t=n(6),i=n(0),u=n.n(i),o=n(7);class a{constructor(){this.label="",this.key="",this.requiresMaf=!1}run(r,e,n,t){throw new Error("Method must be implemented in a subclass")}}class c extends a{constructor(){super(...arguments),this.key="burden",this.label="Burden Test"}static weights(r){return new Array(r).fill(1/r)}run(r,e,n){for(let n of[r,e])if(!Array.isArray(n)||!n.length)throw"Please provide all required arrays";if(r.length!==e.length)throw"u and v must be same length";if(null!=n){if(n.length!==r.length)throw"w vector must be same length as score vector u"}else n=c.weights(r.length);let t=u.a.dot(n,r)/Math.sqrt(u.a.dot(u.a.dot(n,e),n));return[t,2*Object(o.c)(-Math.abs(t),0,1)]}}class f extends a{constructor(){super(...arguments),this.label="SKAT Test",this.key="skat",this.requiresMaf=!0,this._method="auto"}static weights(r,e=1,n=25){let t=Array(r.length).fill(null);for(let i=0;i<r.length;i++){let u=Object(o.a)(r[i],e,n,!1);u*=u,t[i]=u}return t}run(r,e,n,t){void 0!==n&&null!==n||(n=f.weights(t));let i,o=u.a.dot(u.a.dot(r,u.a.diag(n)),r);try{let r=u.a.svd(e),t=u.a.sqrt(r.S),o=u.a.transpose(r.U),a=u.a.dot(u.a.dot(r.U,u.a.diag(t)),o),c=u.a.dot(a,u.a.diag(n)),f=u.a.dot(c,a),s=u.a.svd(f);i=u.a.abs(s.S)}catch(r){return console.log(r),[NaN,NaN]}if(u.a.sum(i)<1e-10)return console.error("Sum of lambda values for SKAT test is essentially zero"),[NaN,NaN];if("liu"===this._method)return m(i,o);if("davies"===this._method)return s(i,o);if("auto"===this._method){if(1===i.length)return m(i,o);{let r=s(i,o);return isNaN(r[1])?m(i,o):r}}throw new Error(`Skat method ${this._method} not implemented`)}}function s(r,e){let n=r.length,i=Array(n).fill(0),u=Array(n).fill(1),o=t.a(r,i,u,n,0,e,1e4,1e-4),a=1-o[0];return 0===o[1]&&a>0&&a<=1||(a=NaN),[e,a]}function m(r,e){let n=r.length,[t,i,u,a]=Array(4).fill(0);for(let e=0;e<n;e++){let n=r[e];t+=n,i+=n*n,u+=n*n*n,a+=n*n*n*n}let c,f,s,m=u/Math.sqrt(i*i*i),h=a/(i*i),l=(e-t)/Math.sqrt(2*i);m*m>h?f=(s=1/(m-Math.sqrt(m*m-h)))*s-2*(c=m*s*s*s-s*s):(s=1/m,c=0,f=i*i*i/(u*u));let p,g=f+c,d=l*(Math.sqrt(2)*s)+g;return[e,p=0===c?Object(o.b)(d,f,0,0):Object(o.b)(d,f,c,0,0)]}},function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=n(3),i=n(1);n.d(e,"helpers",function(){return t}),n.d(e,"stats",function(){return i})},function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"_PortalVariantsHelper",function(){return f}),n.d(e,"_PortalGroupHelper",function(){return s}),n.d(e,"parsePortalJSON",function(){return h}),n.d(e,"PortalTestRunner",function(){return m});var t=n(0),i=n.n(t),u=n(5),o=n(1);const a=[o.ZegginiBurdenTest,o.SkatTest],c=Object.freeze(a.reduce(function(r,e){const n=new e;return r[n.key]={label:n.label,constructor:e},r},{}));class f{constructor(r){this._variants=r,this._variant_lookup=this.parsePortalVariantData(r)}get data(){return this._variants}parsePortalVariantData(r){let e={};return r.forEach(r=>{let{variant:n,altFreq:t,pvalue:i,score:o}=r,[a,c,f,s,m,h]=n.match(u.a),l=t,p=m;t>.5&&(o=-o,p=s,l=1-t),e[n]={variant:n,chrom:c,pos:f,pvalue:i,score:o,altAllele:m,effectAllele:p,altFreq:t,effectFreq:l}}),e}isAltEffect(r){return r.map(r=>{const e=this._variant_lookup[r];return e.altAllele===e.effectAllele})}getEffectFreq(r){return r.map(r=>this._variant_lookup[r].effectFreq)}getScores(r){return r.map(r=>this._variant_lookup[r].score)}getGroupVariants(r){return r.map(r=>this._variant_lookup[r])}}class s{constructor(r){this._groups=r,this._lookup=this._generateLookup(r)}get data(){return this._groups}byMask(r){Array.isArray(r)||(r=[r]),r=new Set(r);const e=this._groups.filter(e=>r.has(e.mask));return new this.constructor(e)}byGroup(r){Array.isArray(r)||(r=[r]),r=new Set(r);const e=this._groups.filter(e=>r.has(e.group));return new this.constructor(e)}_generateLookup(r){return r.reduce((r,e,n)=>{return r[this._getKey(e.mask,e.group)]=n,r},{})}_getKey(r,e){return`${r},${e}`}getOne(r,e){const n=this._getKey(r,e),t=this._lookup[n];return this._groups[t]}makeCovarianceMatrix(r,e){const n=r.variants.length;let t=new Array(n);for(let r=0;r<n;r++)t[r]=new Array(n).fill(null);let u=0;for(let i=0;i<n;i++)for(let o=i;o<n;o++){let n=r.covariance[u],a=e[i],c=e[o];i!==o&&!a^!c&&(n=-n),t[i][o]=n,t[o][i]=n,u+=1}return t=i.a.mul(r.nSamples,t)}}class m{constructor(r,e,n=[]){this.groups=r,this.variants=e,this._tests=[],n.forEach(r=>this.addTest(r))}addTest(r){if("string"==typeof r){let e=c[r];if(!e)throw new Error(`Cannot make unknown test type: ${r}`);r=new e.constructor}else if(!(r instanceof o._AggregationTest))throw new Error("Must specify test as name or instance");return this._tests.push(r),r}run(){let r=[];return this._tests.forEach(e=>{this.groups.data.forEach(n=>{r.push(this._runOne(e,n))})}),r}_runOne(r,e){const n=e.variants,t=this.variants.getScores(n),i=this.variants.isAltEffect(n),u=this.groups.makeCovarianceMatrix(e,i),o=this.variants.getEffectFreq(n);const[a,c]=r.run(t,u,void 0,o);return{groupType:e.groupType,group:e.group,mask:e.mask,variants:e.variants,test:r.key,stat:a,pvalue:c}}toJSON(r){return r||(r=this.run()),{data:{variants:this.variants.data,groups:r}}}}function h(r){const e=r.data||r;return[new s(e.groups),new f(e.variants)]}},function(r,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(r){"object"==typeof window&&(n=window)}r.exports=n},function(r,e,n){"use strict";n.d(e,"a",function(){return t});const t=new RegExp("(?:chr)?(.+):(\\d+)_?(\\w+)?/?([^_]+)?_?(.*)?");new RegExp("(?:chr)?(.+):(\\d+)-(\\d+)")},function(r,e,n){"use strict";n.d(e,"a",function(){return q});const t=Math.PI,i=.0866;let u,o,a,c,f,s,m,h,l,p,g,d,y,v,x,M=0;function b(r){return r<-50?0:Math.exp(r)}function w(){if((M+=1)>l)throw new RangeError("Exceeded limit of "+l+" calls")}function N(r){return r*r}function k(r,e){if(Math.abs(r)>.1)return e?Math.log(1+r):Math.log(1+r)-r;{let n,t,i,u,o;for(i=2*function(r){return r*r*r}(u=r/(2+r)),o=3,n=(e?2:-r)*u,u=N(u),t=n+i/o;t!==n;t=n+i/o)o+=2,i*=u,n=t;return n}}function T(r){let e,n,t,i,o,a,c,f;for(w(),e=r*(a=r*u),r*=2,c=h-1;c>=0;c--)f=d[c],a+=(n=v[c])*((t=x[c])/(o=1-(i=r*n))+f)/o,e=e+t*N(i/o)+f*(N(i)/o+k(-i,!1));return[b(-.5*e),a]}function _(r,e){let n,t,i,u,f,s,m;function h(r){return[m,s]=T(r),m}for(n=0,f=c,t=e/(1+e*(i=2*(e>0?o:a)));h(t)>r;t=e/(1+e*i))n=e,f=s,e*=2;for(t=(f-c)/(s-c);t<.9;t=(f-c)/(s-c))t=(n+e)/2,[m,u]=T(t/(1+t*i)),m>r?(n=t,f=u):(e=t,s=u);return[s,e]}function A(r,e){let n,i,o,a,c,f,s,m,l,p,g,y,M,T;for(w(),n=0,a=0,c=0,T=0,o=2*(i=(u+e)*N(r)),r*=2,y=0;y<h;y++)f=v[y],s=x[y],M=d[y],n+=s*(m=N(r*f))/(1+m),m>1?(a+=M*Math.log(m),c+=M*k(m,!0),T+=M):o+=M*k(m,!0);return c=o+c,m=b(-(n*=.5)-.25*(a=o+a))/t,l=b(-n-.25*c)/t,p=0==T?1:2*m/T,(g=c>1?2.5*l:1)<p&&(p=g),p<(g=(m=.5*i)<=l?1:l/m)?p:g}function j(r,e){let n,t,i=[2,1.4,1.2,1.1];if(A(n=r/4,0)>e)for(n=r;A(n,0)>e;n=r)r*=4;else for(r=n,n/=4;A(n,0)<=e;n/=4)r=n;for(t=0;t<4;t++)A(n=r/i[t],0)<=e&&(r=n);return r}function I(r,e,n,i){let o,a,c,l,p,g,y,M,w,T,_;for(o=e/t,w=r;w>=0;w--){for(c=-2*(a=(w+.5)*e)*f,l=Math.abs(c),p=-.5*u*N(a),T=h-1;T>=0;T--)p-=.25*(_=d[T])*k(y=N(g=2*v[T]*a),!0),y=x[T]*g/(1+y),c+=M=_*Math.atan(g)+y,l+=Math.abs(M),p-=.5*g*y;g=o*b(p)/a,i||(g*=1-b(-.5*n*N(a))),c=Math.sin(.5*c)*g,s+=c,m+=l=.5*l*g}}function S(r){let e,n,u,o,a,c,f,s,m;for(w(),p&&function(){let r;r:for(let e=0;e<h;e++){let n=Math.abs(v[e]);for(let r=e-1;r>=0;r--){if(!(n>Math.abs(v[y[r]]))){y[r+1]=e;continue r}y[r+1]=y[r]}y[1+(r=-1)]=e}p=!1}(),e=Math.abs(r),o=r>0?1:-1,a=0,f=h-1;f>=0;f--)if(m=y[f],v[m]*o>0){if(!((n=e-(c=Math.abs(v[m]))*(d[m]+x[m]))>(u=c/i))){for(n>u&&(e=u),a=(e-n)/c,s=f-1;s>=0;s--)a+=d[y[s]]+x[y[s]];break}e=n}return a>100?(g=!0,1):Math.pow(2,a/4)/(t*N(e))}function q(r,e,n,i,b,w,k,T){let q,P,V,F,O,E,L,U,Y,D,B,R,X,Q,C,Z,$,H,G,z,K,J,W,rr=new Array(7).fill(0),er=[1,2,4,8];function nr(){return rr[6]=M,[J,W,rr]}for(M=0,h=i,f=w,d=n,v=r,x=e,W=0,s=0,m=0,J=-1,O=T,p=!0,g=!1,L=l=k,y=new Array(h).fill(NaN),R=u=N(b),o=0,a=0,c=0,q=0;q<h;q++){if(P=d[q],z=v[q],K=x[q],P<0||K<0)return W=3,nr();R+=N(z)*(2*P+4*K),c+=z*(P+K),o<z?o=z:a>z&&(a=z)}if(0==R)return J=f>0?1:0,nr();if(0==a&&0==o&&0==b)return W=3,nr();R=Math.sqrt(R),E=o<-a?-a:o,D=16/R,$=-(Z=4.5/R);try{let r;function tr(){if(rr[3]=X,U>L)return W=1,nr();for(I(V=Math.floor(U+.5),X,0,!0),rr[2]=rr[2]+1,rr[1]=rr[1]+V+1,J=.5-s,rr[0]=m,C=(Z=m)+T/10,q=0;q<4;q++)er[q]*C==er[q]*Z&&(W=2);return nr()}return D=j(D,.5*O),0!=f&&E>.07*R&&(B=.25*O/S(f),g?g=!1:A(D,B)<.2*O&&(u+=B,D=j(D,.25*O),rr[5]=Math.sqrt(B))),rr[4]=D,O*=.5,function e(){return[r,Z]=_(O,Z),(H=r-f)<0?(J=1,nr()):([r,$]=_(O,$),(G=f-r)<0?(J=0,nr()):(U=D/(X=2*t/(H>G?H:G)),Y=3/Math.sqrt(O),U>1.5*Y?Y>L?(W=1,nr()):(F=Math.floor(Y+.5),(C=2*t/(Q=D/F))<=Math.abs(f)?tr():(B=.33*O/(1.1*(S(f-C)+S(f+C))),g?tr():(O*=.67,I(F,Q,B,!1),L-=Y,u+=B,rr[2]=rr[2]+1,rr[1]=rr[1]+F+1,D=j(D,.25*O),O*=.75,e()))):tr()))}()}catch(r){if("RangeError"===r.name)return W=4,nr();throw r}}},function(r,e,n){"use strict";e.b=yr,n.d(e,"c",function(){return Mr}),n.d(e,"a",function(){return Nr});const t=2.220446049250313e-16,i=Number.MIN_VALUE,u=Number.MAX_VALUE,o=1.157920892373162e77,a=.5772156649015329,c=1e-14,f=2.2737368458246524e-13,s=1.4901161193847656e-8,m=Math.LN2,h=Math.LN10,l=Math.PI,p=2*l,g=Math.log(2*Math.PI),d=Math.log(Math.sqrt(p)),y=5.656854249492381,v=.3989422804014327,x=308*m/t,M=-323*m,b=1,w=2,N=4,k=8,T=16;function _(r,e){if(r>b){let n="";switch(r){case b:n=`argument out of domain in ${e}`;break;case w:n=`value out of range in ${e}`;break;case N:n=`convergence failed in ${e}`;break;case k:n=`full precision may not have been achieved in ${e}`;break;case T:n=`underflow occurred in ${e}`}console.error(n)}}function A(){return _(b,""),NaN}const j=.08333333333333333,I=.002777777777777778,S=.0007936507936507937,q=.0005952380952380953,P=.0008417508417508417,V=[0,.15342640972002736,.08106146679532726,.05481412105191765,.0413406959554093,.03316287351993629,.02767792568499834,.023746163656297496,.020790672103765093,.018488450532673187,.016644691189821193,.015134973221917378,.013876128823070748,.012810465242920227,.01189670994589177,.011104559758206917,.010411265261972096,.009799416126158804,.009255462182712733,.008768700134139386,.00833056343336287,.00793411456431402,.007573675487951841,.007244554301320383,.00694284010720953,.006665247032707682,.006408994188004207,.006171712263039458,.0059513701127588475,.0057462165130101155,.005554733551962801],F=[.3224670334241132,.0673523010531981,.020580808427784546,.007385551028673986,.0028905103307415234,.001192753911703261,.0005096695247430425,.00022315475845357939,9945751278180853e-20,4492623673813314e-20,2050721277567069e-20,9439488275268397e-21,4374866789907488e-21,2039215753801366e-21,9.55141213040742e-7,4.492469198764566e-7,2.1207184805554665e-7,1.0043224823968099e-7,4.7698101693639804e-8,2.2711094608943164e-8,1.0838659214896955e-8,5.183475041970047e-9,2.4836745438024785e-9,1.1921401405860912e-9,5.731367241678862e-10,2.7595228851242334e-10,1.330476437424449e-10,6.4229645638381e-11,3.1044247747322276e-11,1.5021384080754142e-11,7.275974480239079e-12,3.527742476575915e-12,1.711991790559618e-12,8.315385841420285e-13,4.04220052528944e-13,1.9664756310966165e-13,9.573630387838556e-14,4.6640760264283744e-14,2.2737369600659724e-14,1.1091399470834522e-14],O=[-1e99,2/3,-4/135,8/2835,16/8505,-8992/12629925,-334144/492567075,698752/1477701225],E=[-1e99,1/12,1/288,-139/51840,-571/2488320,163879/209018880,5246819/75246796800,-.0005921664373536939],L=[.00857119559098933,.004415381324841007,.05685043681599363,-.00421983539641856,.0013268081812124603,-.00018930245297988805,3606925327441245e-20,-6056761904460864e-21,10558295463022833e-22,-1.811967365542384e-7,3.117724964715322e-8,-5.354219639019687e-9,9.193275519859589e-10,-1.5779412802883398e-10,2.7079806229349544e-11,-4.64681865382573e-12,7.97335019200742e-13,-1.368078209830916e-13,2.3473194865638007e-14,-4.027432614949067e-15,6.910051747372101e-16,-1.185584500221993e-16,2.034148542496374e-17,-3.490054341717406e-18,5.987993856485306e-19,-1.027378057872228e-19,1.7627028160605298e-20,-3.024320653735306e-21,5.188914660218398e-22,-8.902770842456576e-23,1.5274740684933426e-23,-2.620731256187363e-24,4.496464047830539e-25,-7.714712731336878e-26,1.323635453126044e-26,-2.2709994129429287e-27,3.8964189980039913e-28,-6.685198115125953e-29,1.1469986631400244e-29,-1.9679385863451348e-30,3.376448816585338e-31,-5.793070335782136e-32],U=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1.809129475572494e-11,6.221098041892606e-14,-3.399615005417722e-16,2.683181998482699e-18,-2.868042435334643e-20,3.9628370610464347e-22,-6.831888753985767e-24,1.4292273559424982e-25,-3.5475981581010704e-27,1.025680058010471e-28,-3.401102254316749e-30,1.276642195630063e-31],Y=[2.2352520354606837,161.02823106855587,1067.6894854603709,18154.98125334356,.06568233791820745],D=[47.202581904688245,976.0985517377767,10260.932208618979,45507.78933502673],B=[.39894151208813466,8.883149794388377,93.50665613217785,597.2702763948002,2494.5375852903726,6848.190450536283,11602.65143764735,9842.714838383978,1.0765576773720192e-8],R=[22.266688044328117,235.387901782625,1519.3775994075547,6485.558298266761,18615.571640885097,34900.95272114598,38912.00328609327,19685.429676859992],X=[.215898534057957,.12740116116024736,.022235277870649807,.0014216191932278934,29112874951168793e-21,.023073441764940174],Q=[1.284260096144911,.4682382124808651,.06598813786892856,.0037823963320275824,7297515550839662e-20],C=r=>r?-1/0:0,Z=r=>r?0:1,$=(r,e)=>r?C(e):Z(e),H=(r,e)=>r?Z(e):C(e),G=(r,e)=>e?Math.log(r):r,z=(r,e,n)=>e?G(r,n):((r,e)=>e?Math.log1p(-r):.5-r+.5)(r,n);function K(r){return r>-m?Math.log(-Math.expm1(r)):Math.log1p(-Math.exp(r))}function J(r,e){return e?r:Math.exp(r)}function W(r){return isNaN(r)?r:Number.isFinite(r)?((r%=2)<=-1?r+=2:r>1&&(r-=2),0==r||1==r?0:.5==r?1:-.5==r?-1:Math.sin(l*r)):NaN}function rr(r,e,n){var t,i,u,o,a;if(n<1||n>1e3)return NaN;if(r<-1.1||r>1.1)return NaN;for(o=2*r,u=i=0,t=0,a=1;a<=n;a++)u=i,t=o*(i=t)-u+e[n-a];return.5*(t-u)}function er(r){var e;if(r<10)return NaN;if(r>3.745194030963158e306)throw"lgammacor underflow";return r<94906265.62425156?rr((e=10/r)*e*2-1,U,5)/r:1/(12*r)}function nr(r){var e,n,t,i,u;if(isNaN(r))return r;if(0==r||r<0&&r==Math.round(r))return NaN;if((t=Math.abs(r))<=10){if(n=parseInt(r,10),r<0&&n--,t=r-n,n--,u=rr(2*t-1,L,22)+.9375,0==n)return u;if(n<0){if(r<-.5&&Math.abs(r-parseInt(r-.5,10)/r)<s)throw"gammafn precision error";if(r<2.2474362225598545e-308)return r>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;for(n=-n,e=0;e<n;e++)u/=r+e;return u}for(e=1;e<=n;e++)u*=t+e;return u}if(r>171.61447887182297)return Number.POSITIVE_INFINITY;if(r<-170.5674972726612)return 0;if(t<=50&&t==parseInt(t,10))for(u=1,e=2;e<t;e++)u*=e;else u=Math.exp((t-.5)*Math.log(t)-t-d+(2*t==parseInt(2*t,10)?ir(t):er(t)));if(r>0)return u;if(Math.abs(r-parseInt(r-.5,10)/r)<s)throw"gammafn precision error";return 0==(i=W(t))?Number.POSITIVE_INFINITY:-l/(t*i*u)}function tr(r){return function(r){var e;if(isNaN(r))return r;if(r<0&&Math.floor(-r),r<=0&&r==Math.trunc(r))return Number.POSITIVE_INFINITY;if((e=Math.abs(r))<1e-306)return-Math.log(e);if(e<=10)return Math.log(Math.abs(nr(r)));if(e>2.5327372760800758e305)return Number.POSITIVE_INFINITY;if(r>0)return r>1e17?r*(Math.log(r)-1):r>4934720?d+(r-.5)*Math.log(r)-r:d+(r-.5)*Math.log(r)-r+er(r);if(0==Math.abs(W(e)))return NaN;if(Math.abs(void 0*(r-Math.trunc(r-.5))/r)<s)throw"lgamma precision error"}(r)}function ir(r){var e;return r<=15?(e=r+r)==Math.floor(e)?V[Math.floor(e)]:tr(r+1)-(r+.5)*Math.log(r)+r-d:(e=r*r,r>500?(j-I/e)/r:r>80?(j-(I-S/e)/e)/r:r>35?(j-(I-(S-q/e)/e)/e)/r:(j-(I-(S-(q-P/e)/e)/e)/e)/r)}function ur(r,e){var n,t,u,o,a;if(!Number.isFinite(r)||!Number.isFinite(e)||0==e)return NaN;if(Math.abs(r-e)<.1*(r+e)){if(t=(r-e)*(o=(r-e)/(r+e)),Math.abs(t)<i)return t;for(n=2*r*o,o*=o,a=1;a<1e3;a++){if((u=t+(n*=o)/(2*a+1))==t)return u;t=u}}return r*Math.log(r/e)+e-r}function or(r,e,n){return 0==e?hr(1==r?1:0,n):Number.isFinite(e)?r<0?hr(0,n):r<=e*i?J(-e,n):e<r*i?J(-e+r*Math.log(e)-tr(r+1),n):function(r,e,n){return n?-.5*Math.log(r)+e:Math.exp(e)/Math.sqrt(r)}(p*r,-ir(r)-ur(r,e),n):hr(0,n)}function ar(r,e,n,t){var i,u=2*n,a=e+n,c=a+n,f=a,s=e*(a-e*r),m=n*n*r,h=c*a-m;for(m=c*s-e*m;Math.abs(h*s-f*m)>Math.abs(t*s*m);)i=a*a*r,a+=n,f=(c+=n)*h-i*f,s=c*m-i*s,i=u*u*r,u+=n,h=(c+=n)*f-i*h,m=c*s-i*m,Math.abs(m)>o?(f/=o,h/=o,s/=o,m/=o):Math.abs(m)<1/o&&(f*=o,h*=o,s*=o,m*=o);return h/m}function cr(r){if(r>1||r<-.79149064)return Math.log1p(r)-r;var e=r/(2+r),n=e*e;return Math.abs(r)<.01?e*((((2/9*n+2/7)*n+.4)*n+2/3)*n-r):e*(2*n*ar(n,3,2,c)-r)}function fr(r){if(Math.abs(r)>=.5)return tr(r+1);var e,n;for(e=f*ar(-r/2,F.length+2,1,c),n=F.length-1;n>=0;n--)e=F[n]-r*e;return(r*e-a)*r-cr(r)}function sr(r,e){return(r>e?r:e)+Math.log1p(Math.exp(-Math.abs(r-e)))}function mr(r,e,n){if(!isFinite(e))return hr(0,n);if(r>1)return or(r-1,e,n);if(e>Math.abs(r-1)*x)return J(-e-tr(r),n);var t=or(r,e,n);return n?t+Math.log(r/e):t*(r/e)}function hr(r,e){return 0===r?e?Number.NEGATIVE_INFINITY:0:e?0:1}function lr(r,e,n){return hr(0===r?e?0:1:e?1:0,n)}function pr(r,e){var n,i,u,a,c,f,s,m,h,l,p=0;if(0==r)return 0;if(i=r/e,Math.abs(r-1)<Math.abs(e)*t)return i;for(i>1&&(i=1),a=r,f=e,s=0,m=1,h=r,l=e;l>o;)s/=o,m/=o,h/=o,l/=o;for(u=0,n=-1;u<2e5;)if(s=(f+=2)*h+(c=++u*--a)*s,m=f*l+c*m,h=(f+=2)*s+(c=++u*--a)*h,(l=f*m+c*l)>o&&(s/=o,m/=o,h/=o,l/=o),0!=l){if(p=h/l,Math.abs(p-n)<=t*(Math.abs(p)>i?Math.abs(p):i))return p;n=p}return p}function gr(r,e,n,i){var u,o,a,c,f,s,m,h,l,p,g,d,y,v=O,x=E;for(l=-cr((h=e-r)/r),p=Math.sqrt(2*r*l),h<0&&(p=-p),a=0,f=c=Math.sqrt(r),m=s=p,y=1;y<8;y++)a+=f*v[y],a+=m*x[y],f=f/r+(c*=l/y),m=m/r+(s*=2*l/(2*y+1));for(u=r,o=1,y=1;y<8;y++)u+=o*x[y],o/=r;if(n||(u=-u),g=a/u,d=xr(p,0,1,!n,i),i){var M=function(r,e,n){if(r<0&&(r=-r,e=!e),r>10&&!e){var i=1/r,u=i,o=r*r,a=1;do{u+=i*=-a/o,a+=2}while(Math.abs(i)>t*u);return 1/u}return br(r,0,1,!1)/Math.exp(n)}(p,!n,d);return d+Math.log1p(g*M)}return d+g*br(p,0,1,i)}function dr(r,e,n,u){var o,a,c;if(r<1)o=function(r,e,n,i){var u,o=0,a=e,c=0;do{o+=u=(a*=-r/++c)/(e+c)}while(Math.abs(u)>t*Math.abs(o));if(n){var f,s=i?Math.log1p(o):1+o;return e>1?(f=or(e,r,i),f=i?f+r:f*Math.exp(r)):f=i?e*Math.log(r)-fr(e):Math.pow(r,e)/Math.exp(fr(e)),i?s+f:s*f}var m=e*Math.log(r)-fr(e);if(i)return K(Math.log1p(o)+m);var h=o,l=Math.expm1(m);return-(h+l+h*l)}(r,e,n,u);else if(r<=e-1&&r<.8*(e+50))c=function(r,e,n){var i=r/e,u=i;do{u+=i*=r/++e}while(i>u*t);return n?Math.log(u):u}(r,e,u),a=mr(e,r,u),o=n?u?c+a:c*a:u?K(a+c):1-a*c;else if(e-1<r&&e<.8*(r+50)){if(a=mr(e,r,u),e<1)if(r*t>1-e)c=hr(0,u);else{var f=pr(e,r-(e-1))*r/e;c=u?Math.log(f):f}else c=function(r,e){for(var n=1,i=0;e>=1&&n>i*t;)i+=n*=e/r,e--;return e!==Math.floor(e)&&(i+=n*pr(e,r+1-e)),i}(r,e-1),c=u?Math.log1p(c):1+c;o=n?u?K(a+c):1-a*c:u?c+a:c*a}else o=gr(e-1,r,!n,u);return!u&&o<i/t?Math.exp(dr(r,e,n,!0)):o}function yr(r,e,n=0,i=!0,u=!1){return r=kr(r),e=kr(e),n=kr(n),i=Tr(i),u=Tr(u),0===n?function(r,e,n,t,i){return isNaN(r)||e<0||n<0?NaN:(r/=n,0==e?lr(r<=0?0:1,t,i):dr(r,e,t,i))}(r,e/2,2,i,u):function(r,e,n=0,i=!0,u=!1){if(e<0||n<0)return NaN;let o=vr(r,e,n,1e-12,8*t,1e6,i,u);n>=80&&(i?(a=o,c=Z(u),o=isNaN(a)||isNaN(c)?a+c:a<c?a:c):(o<(u?-10*h:1e-10)&&_(k,"pnchisq"),u||(o=function(r,e){return isNaN(r)||isNaN(e)?r+e:r<e?e:r}(o,0))));var a,c;return!u||o<-1e-8?o:(o=vr(r,e,n,1e-12,8*t,1e6,!i,!1),Math.log1p(-o))}(r,e,n,i,u)}function vr(r,e,n,i,u,o,a,c){let f,s,h,l,p,g,y,v,x,b,w,N,k,T,_,A,j,I,S=-1,q=-1,P=-1;if(r<=0){if(0===r&&0===e){const r=-.5*n;return a?J(r,c):c?K(r):-function(r){let e,n=Math.abs(r);return n<t?r:n>.697?Math.exp(r)-1:(e=n>1e-8?Math.exp(r)-1:(r/2+1)*r,e-=(1+e)*(Math.log1p(e)-r))}(r)}return $(a,c)}if(!isFinite(r))return H(a,c);if(n<80){let t;if(a&&e>0&&Math.log(r)<m+2/e*(tr(e/2+1)+M)){let i,u,o=.5*n,f=-o;i=u=-1/0;for(let n=0;n<110&&(u=sr(u,f),i=sr(i,f+yr(r,e+2*n,0,a,!0)),!(u>=-1e-15));f===Math.log(o)-Math.log(++n));return t=i-u,c?t:Math.exp(t)}{let i=.5*n,u=0,o=0,f=Math.exp(-i);for(let n=0;n<110&&(o+=f,u+=f*yr(r,e+2*n,0,a,!1),!(o>=1-1e-15));f*=i/++n);return t=u/o,c?Math.log(t):t}}if((x=-(f=.5*n)<M)?(_=0,P=-f,S=Math.log(f)):_=Math.exp(-f),A=_,s=.5*r,g=e-r,b=(I=(h=.5*e)*t>.125&&Math.abs(j=s-h)<Math.sqrt(t)*h?(1-j)*(2-j/(h+1))-d-.5*Math.log(h+1):h*Math.log(s)-s-tr(h+1))<M){if(r>e+n+5*Math.sqrt(2*(e+2*n)))return H(a,c);q=Math.log(r),T=l=0,j=0}else T=l=A*(j=Math.exp(I));for(v=1,y=e+2,g+=2;!(g>0&&(k=v>o,(N=(p=j*r/g)<=i)&&(w=l<=u*T)||k));v++,y+=2,g+=2)x?(P+=S-Math.log(v))>=M&&(A=_=Math.exp(P),x=!1):A+=_*=f/v,b?(I+=q-Math.log(y))>=M&&(j=Math.exp(I),b=!1):j*=r/y,x||b||(T+=l=A*j);return k&&console.error(`pnchisq(x=${r},...) not converged in ${o}`),z(T,a,c)}function xr(r,e,n,i,u){var o;if(isNaN(r)||isNaN(e)||isNaN(n))return NaN;if(!Number.isFinite(r)&&e===r)return NaN;if(n<=0)return n<0?NaN:r<e?$(i,u):H(i,u);if(o=(r-e)/n,!Number.isFinite(o))return r<e?$(i,u):H(i,u);var a=function(r,e,n){var i,u,o,a,c,f,s,m,h,l,p,g,d=Y,x=D,M=B,b=R,w=X,N=Q;if(isNaN(r))return{cum:NaN,ccum:NaN};if(s=.5*t,p=1!=e,g=0!=e,(h=Math.abs(r))<=.67448975){if(h>s)for(m=r*r,a=d[4]*m,o=m,l=0;l<3;++l)a=(a+d[l])*m,o=(o+x[l])*m;else a=o=0;c=r*(a+d[3])/(o+x[3]),p&&(i=.5+c),g&&(u=.5-c),n&&(p&&(i=Math.log(i)),g&&(u=Math.log(u)))}else if(h<=y){for(a=M[8]*h,o=h,l=0;l<7;++l)a=(a+M[l])*h,o=(o+b[l])*h;c=(a+M[7])/(o+b[7]),f=(h-(m=Math.trunc(16*h)/16))*(h+m),n?(i=-m*m*.5+.5*-f+Math.log(c),(p&&r>0||g&&r<=0)&&(u=Math.log1p(-Math.exp(-m*m*.5)*Math.exp(.5*-f)*c))):u=1-(i=Math.exp(-m*m*.5)*Math.exp(.5*-f)*c),r>0&&(c=i,p&&(i=u),u=c)}else if(n&&h<1e170||p&&-37.5193<r&&r<8.2924||g&&r<37.5193){for(m=1/(r*r),a=w[5]*m,o=m,l=0;l<4;++l)a=(a+w[l])*m,o=(o+N[l])*m;c=m*(a+w[4])/(o+N[4]),c=(v-c)/h,f=(r-(m=Math.trunc(16*r)/16))*(r+m),n?(i=-m*m*.5+.5*-f+Math.log(c),(p&&r>0||g&&r<=0)&&(u=Math.log1p(-Math.exp(-m*m*.5)*Math.exp(.5*-f)*c))):u=1-(i=Math.exp(-m*m*.5)*Math.exp(.5*-f)*c),r>0&&(c=i,p&&(i=u),u=c)}else r>0?(i=hr(1,n),u=hr(0,n)):(i=hr(0,n),u=hr(1,n));return{cum:i,ccum:u}}(r=o,i?0:1,u);return i?a.cum:a.ccum}function Mr(r,e,n,t,i){return xr(r=kr(r),e=kr(e,0),n=kr(n,1),t=Tr(t,!0),i=Tr(i,!1))}function br(r,e,n,t){return isNaN(r)||isNaN(e)||isNaN(n)?r+e+n:Number.isFinite(n)?Number.isFinite(r)||e!=r?n<=0?n<0?NaN:r==e?Number.POSITIVE_INFINITY:hr(0,t):(r=(r-e)/n,Number.isFinite(r)?(r=Math.abs(r))>=2*Math.sqrt(u)?hr(0,t):t?-(d+.5*r*r+Math.log(n)):v*Math.exp(-.5*r*r)/n:hr(0,t)):NaN:hr(0,t)}function wr(r,e,n,t){if((e<0||n<0)&&A(),r<0||r>1)return C(t);if(0===e||0===n||!isFinite(e)||!isFinite(n))return 0===e&&0===n?0===r||1===r?Number.POSITIVE_INFINITY:C(t):0===e||e/n==0?0===r?Number.POSITIVE_INFINITY:C(t):0===n||n/e==0?1===r?Number.POSITIVE_INFINITY:C(t):.5===r?Number.POSITIVE_INFINITY:C(t);if(0===r)return e>1?C(t):e<1?Number.POSITIVE_INFINITY:G(n,t);if(1===r)return n>1?C(t):n<1?Number.POSITIVE_INFINITY:G(e,t);let i;return J(i=e<=2||n<=2?(e-1)*Math.log(r)+(n-1)*Math.log1p(-r)-function(r,e){let n,t,i;return e<(t=i=r)&&(t=e),e>i&&(i=e),t<0?A():0===t?Number.POSITIVE_INFINITY:isFinite(i)?t>=10?(n=er(t)+er(i)-er(t+i),-.5*Math.log(i)+d+n+(t-.5)*Math.log(t/(t+i))+i*Math.log1p(-t/(t+i))):i>=10?(n=er(i)-er(t+i),tr(t)+n+t-t*Math.log(t+i)+(i-.5)*Math.log1p(-t/(t+i))):t<1e-306?tr(t)+(tr(i)-tr(t+i)):Math.log(nr(t)*(nr(i)/nr(t+i))):Number.NEGATIVE_INFINITY}(e,n):Math.log(e+n-1)+function(r,e,n,t,i){let u,o;return 0===n?0===r?Z(i):C(i):0===t?r===e?Z(i):C(i):0===r?0===e?Z(i):J(o=n<.1?-ur(e,e*t)-e*n:e*Math.log(t),i):r===e?J(o=t<.1?-ur(e,e*n)-e*t:e*Math.log(n),i):r<0||r>e?C(i):J((o=ir(e)-ir(r)-ir(e-r)-ur(r,e*n)-ur(e-r,e*t))-.5*(u=g+Math.log(r)+Math.log1p(-r/e)),i)}(e-1,e+n-2,r,1-r,!0),t)}function Nr(r,e,n,t){return wr(r=kr(r),e=kr(e),n=kr(n),t=Tr(t,!1))}function kr(r,e){return void 0===r?e:+r}function Tr(r,e){return void 0===r?e:!("false"==(r||"false"))}}])});
//# sourceMappingURL=raremetal.min.js.map
