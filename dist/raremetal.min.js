!function(r,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.raremetal=n():r.raremetal=n()}(window,function(){return function(r){var n={};function e(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return r[t].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=r,e.c=n,e.d=function(r,n,t){e.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:t})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,n){if(1&n&&(r=e(r)),8&n)return r;if(4&n&&"object"==typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(e.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&n&&"string"!=typeof r)for(var i in r)e.d(t,i,function(n){return r[n]}.bind(null,i));return t},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,"a",n),n},e.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},e.p="",e(e.s=21)}([function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,n){var e,t,i;for(void 0===n&&(n=15),t=.5,e=new Date;;){for(i=t*=2;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(new Date-e>n)break}for(i=t;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*t-1)/(new Date-e)},numeric._myIndexOf=function(r){var n,e=this.length;for(n=0;n<e;++n)if(this[n]===r)return n;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){var n=[];return function r(e){var t;if(void 0===e)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return n.push('"'+e+'"'),!1;if("boolean"==typeof e)return n.push(e.toString()),!1;if("number"==typeof e){var i=function r(n){if(0===n)return"0";if(isNaN(n))return"NaN";if(n<0)return"-"+r(-n);if(isFinite(n)){var e=Math.floor(Math.log(n)/Math.log(10)),t=n/Math.pow(10,e),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(e++,i=(t=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+e.toString()}return"Infinity"}(e),o=e.toPrecision(numeric.precision),a=parseFloat(e.toString()).toString(),u=[i,o,a,parseFloat(o).toString(),parseFloat(a).toString()];for(t=1;t<u.length;t++)u[t].length<i.length&&(i=u[t]);return n.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===e)return n.push("null"),!1;if("function"==typeof e){n.push(e.toString());var c=!1;for(t in e)e.hasOwnProperty(t)&&(c?n.push(",\n"):n.push("\n{"),c=!0,n.push(t),n.push(": \n"),r(e[t]));return c&&n.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return n.push("...Large Array..."),!0;for(c=!1,n.push("["),t=0;t<e.length;t++)t>0&&(n.push(","),c&&n.push("\n ")),c=r(e[t]);return n.push("]"),!0}n.push("{");c=!1;for(t in e)e.hasOwnProperty(t)&&(c&&n.push(",\n"),c=!0,n.push(t),n.push(": \n"),r(e[t]));return n.push("}"),!0}(r),n.join("")},numeric.parseDate=function(r){return function r(n){if("string"==typeof n)return Date.parse(n.replace(/-/g,"/"));if(!(n instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseFloat=function(r){return function r(n){if("string"==typeof n)return parseFloat(n);if(!(n instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseCSV=function(r){var n,e,t,i=r.split("\n"),o=[],a=/(([^'",]*)|('[^']*')|("[^"]*")),/g,u=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,c=0;for(e=0;e<i.length;e++){var s,f=(i[e]+",").match(a);if(f.length>0){for(o[c]=[],n=0;n<f.length;n++)s=(t=f[n]).substr(0,t.length-1),u.test(s)?o[c][n]=parseFloat(s):o[c][n]=s;c++}}return o},numeric.toCSV=function(r){var n,e,t,i,o,a=numeric.dim(r);for(t=a[0],a[1],o=[],n=0;n<t;n++){for(i=[],e=0;e<t;e++)i[e]=r[n][e].toString();o[n]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r,n,e){void 0===n&&(n=0),void 0===e&&(e=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;r.length;for(t=n;t<e;t++)o=o>>>8^i[255&(o^r[t])];return-1^o}var e,t,i,o,a,u,c,s,f,l,h=r[0].length,m=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,m>>24&255,m>>16&255,m>>8&255,255&m,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(l=n(p,12,29),p[29]=l>>24&255,p[30]=l>>16&255,p[31]=l>>8&255,p[32]=255&l,e=1,t=0,c=0;c<h;c++){for(c<h-1?p.push(0):p.push(1),a=3*m+1+(0===c)&255,u=3*m+1+(0===c)>>8&255,p.push(a),p.push(u),p.push(255&~a),p.push(255&~u),0===c&&p.push(0),s=0;s<m;s++)for(i=0;i<3;i++)t=(t+(e=(e+(a=(a=r[i][c][s])>255?255:a<0?0:Math.round(a)))%65521))%65521,p.push(a);p.push(0)}return f=(t<<16)+e,p.push(f>>24&255),p.push(f>>16&255),p.push(f>>8&255),p.push(255&f),o=p.length-41,p[33]=o>>24&255,p[34]=o>>16&255,p[35]=o>>8&255,p[36]=255&o,l=n(p,37),p.push(l>>24&255),p.push(l>>16&255),p.push(l>>8&255),p.push(255&l),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(r){var n,e,t,i,o,a,u,c=r.length,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="";for(n=0;n<c;n+=3)o=((3&(e=r[n]))<<4)+((t=r[n+1])>>4),a=((15&t)<<2)+((i=r[n+2])>>6),u=63&i,n+1>=c?a=u=64:n+2>=c&&(u=64),f+=s.charAt(e>>2)+s.charAt(o)+s.charAt(a)+s.charAt(u);return f}(p)},numeric._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n;return"object"==typeof r?"object"==typeof(n=r[0])?"object"==typeof n[0]?numeric._dim(r):[r.length,n.length]:[r.length]:[]},numeric.mapreduce=function(r,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(n,e){var t,i;if(!(n instanceof Array&&e instanceof Array))return!1;if((i=n.length)!==e.length)return!1;for(t=0;t<i;t++)if(n[t]!==e[t]){if("object"!=typeof n[t])return!1;if(!r(n[t],e[t]))return!1}return!0},numeric.rep=function(r,n,e){void 0===e&&(e=0);var t,i=r[e],o=Array(i);if(e===r.length-1){for(t=i-2;t>=0;t-=2)o[t+1]=n,o[t]=n;return-1===t&&(o[0]=n),o}for(t=i-1;t>=0;t--)o[t]=numeric.rep(r,n,e+1);return o},numeric.dotMMsmall=function(r,n){var e,t,i,o,a,u,c,s,f,l,h;for(o=r.length,a=n.length,u=n[0].length,c=Array(o),e=o-1;e>=0;e--){for(s=Array(u),f=r[e],i=u-1;i>=0;i--){for(l=f[a-1]*n[a-1][i],t=a-2;t>=1;t-=2)h=t-1,l+=f[t]*n[t][i]+f[h]*n[h][i];0===t&&(l+=f[0]*n[0][i]),s[i]=l}c[e]=s}return c},numeric._getCol=function(r,n,e){var t;for(t=r.length-1;t>0;--t)e[t]=r[t][n],e[--t]=r[t][n];0===t&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var e,t,i,o=numeric._getCol,a=n.length,u=Array(a),c=r.length,s=n[0].length,f=new Array(c),l=numeric.dotVV;for(--a,t=--c;-1!==t;--t)f[t]=Array(s);for(t=--s;-1!==t;--t)for(o(n,t,u),i=c;-1!==i;--i)0,e=r[i],f[i][t]=l(e,u);return f},numeric.dotMV=function(r,n){var e,t=r.length,i=(n.length,Array(t)),o=numeric.dotVV;for(e=t-1;e>=0;e--)i[e]=o(r[e],n);return i},numeric.dotVM=function(r,n){var e,t,i,o,a,u,c;for(i=r.length,o=n[0].length,a=Array(o),t=o-1;t>=0;t--){for(u=r[i-1]*n[i-1][t],e=i-2;e>=1;e-=2)c=e-1,u+=r[e]*n[e][t]+r[c]*n[c][t];0===e&&(u+=r[0]*n[0][t]),a[t]=u}return a},numeric.dotVV=function(r,n){var e,t,i=r.length,o=r[i-1]*n[i-1];for(e=i-2;e>=1;e-=2)t=e-1,o+=r[e]*n[e]+r[t]*n[t];return 0===e&&(o+=r[0]*n[0]),o},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:return n.length<10?numeric.dotMMsmall(r,n):numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var n,e,t,i,o=r.length,a=Array(o);for(n=o-1;n>=0;n--){for(i=Array(o),e=n+2,t=o-1;t>=e;t-=2)i[t]=0,i[t-1]=0;for(t>n&&(i[t]=0),i[n]=r[n],t=n-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),a[n]=i}return a},numeric.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),t=Array(e);for(n=e-1;n>=1;--n)t[n]=r[n][n],t[--n]=r[n][n];return 0===n&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,n,e){void 0===e&&(e="");var t,i,o=[],a=/\[i\]$/,u="",c=!1;for(t=0;t<r.length;t++)a.test(r[t])?u=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(c=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+u+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(c?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n    "+n+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,n,e){void 0===e&&(e="");var t,i,o=[],a=/\[i\]$/,u="",c=!1;for(t=0;t<r.length;t++)a.test(r[t])?u=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(c=!0),o.push(i);return o[r.length]="var _n = "+u+".length;\nvar i"+(c?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+n+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function r(n,e,t,i,o){var a;if(i!==t.length-1)for(a=t[i]-1;a>=0;a--)r("object"==typeof n?n[a]:n,"object"==typeof e?e[a]:e,t,i+1,o);else o(n,e)},numeric._biforeach2=function r(n,e,t,i,o){if(i===t.length-1)return o(n,e);var a,u=t[i],c=Array(u);for(a=u-1;a>=0;--a)c[a]=r("object"==typeof n?n[a]:n,"object"==typeof e?e[a]:e,t,i+1,o);return c},numeric._foreach=function r(n,e,t,i){var o;if(t!==e.length-1)for(o=e[t]-1;o>=0;o--)r(n[o],e,t+1,i);else i(n)},numeric._foreach2=function r(n,e,t,i){if(t===e.length-1)return i(n);var o,a=e[t],u=Array(a);for(o=a-1;o>=0;o--)u[o]=r(n[o],e,t+1,i);return u},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+n+" = Math."+n+";\n",e=function(r,e,t){return r+" = "+n+"("+e+","+t+")"},t=function(r,e){return r+" = "+n+"("+r+","+e+")"}):(e=function(r,e,t){return r+" = "+e+" "+n+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e}:function(r,e){return r+" = "+r+" "+n+" "+e}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",n=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(n)&&(i="var "+n+" = Math."+n+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(n=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[r]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,n){return"object"==typeof r?"object"==typeof n?numeric.truncVV(r,n):numeric.truncVS(r,n):"object"==typeof n?numeric.truncSV(r,n):Math.round(r/n)*n},numeric.inv=function(r){var n,e,t,i,o,a,u,c=numeric.dim(r),s=Math.abs,f=c[0],l=c[1],h=numeric.clone(r),m=numeric.identity(f);for(a=0;a<l;++a){var p=-1,v=-1;for(o=a;o!==f;++o)(u=s(h[o][a]))>v&&(p=o,v=u);for(e=h[p],h[p]=h[a],h[a]=e,i=m[p],m[p]=m[a],m[a]=i,r=e[a],u=a;u!==l;++u)e[u]/=r;for(u=l-1;-1!==u;--u)i[u]/=r;for(o=f-1;-1!==o;--o)if(o!==a){for(n=h[o],t=m[o],r=n[a],u=a+1;u!==l;++u)n[u]-=e[u]*r;for(u=l-1;u>0;--u)t[u]-=i[u]*r,t[--u]-=i[u]*r;0===u&&(t[0]-=i[0]*r)}}return m},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var e,t,i,o,a,u,c,s,f=n[0],l=1,h=numeric.clone(r);for(t=0;t<f-1;t++){for(i=t,e=t+1;e<f;e++)Math.abs(h[e][t])>Math.abs(h[i][t])&&(i=e);for(i!==t&&(c=h[i],h[i]=h[t],h[t]=c,l*=-1),o=h[t],e=t+1;e<f;e++){for(u=(a=h[e])[t]/o[t],i=t+1;i<f-1;i+=2)s=i+1,a[i]-=o[i]*u,a[s]-=o[s]*u;i!==f&&(a[i]-=o[i]*u)}if(0===o[t])return 0;l*=o[t]}return l*h[t][t]},numeric.transpose=function(r){var n,e,t,i,o,a=r.length,u=r[0].length,c=Array(u);for(e=0;e<u;e++)c[e]=Array(a);for(n=a-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=u-1;e>=1;--e)(o=c[e])[n]=i[e],o[n-1]=t[e],(o=c[--e])[n]=i[e],o[n-1]=t[e];0===e&&((o=c[0])[n]=i[0],o[n-1]=t[0])}if(0===n){for(t=r[0],e=u-1;e>=1;--e)c[e][0]=t[e],c[--e][0]=t[e];0===e&&(c[0][0]=t[0])}return c},numeric.negtranspose=function(r){var n,e,t,i,o,a=r.length,u=r[0].length,c=Array(u);for(e=0;e<u;e++)c[e]=Array(a);for(n=a-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=u-1;e>=1;--e)(o=c[e])[n]=-i[e],o[n-1]=-t[e],(o=c[--e])[n]=-i[e],o[n-1]=-t[e];0===e&&((o=c[0])[n]=-i[0],o[n-1]=-t[0])}if(0===n){for(t=r[0],e=u-1;e>=1;--e)c[e][0]=-t[e],c[--e][0]=-t[e];0===e&&(c[0][0]=-t[0])}return c},numeric._random=function r(n,e){var t,i,o=n[e],a=Array(o);if(e===n.length-1){for(i=Math.random,t=o-1;t>=1;t-=2)a[t]=i(),a[t-1]=i();return 0===t&&(a[0]=i()),a}for(t=o-1;t>=0;t--)a[t]=r(n,e+1);return a},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,n,e){if(void 0===e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];var t,i=Array(e);for(t=--e;t>=0;t--)i[t]=(t*n+(e-t)*r)/e;return i},numeric.getBlock=function(r,n,e){var t=numeric.dim(r);return function r(i,o){var a,u=n[o],c=e[o]-u,s=Array(c);if(o===t.length-1){for(a=c;a>=0;a--)s[a]=i[a+u];return s}for(a=c;a>=0;a--)s[a]=r(i[a+u],o+1);return s}(r,0)},numeric.setBlock=function(r,n,e,t){var i=numeric.dim(r);return function r(t,o,a){var u,c=n[a],s=e[a]-c;if(a===i.length-1)for(u=s;u>=0;u--)t[u+c]=o[u];for(u=s;u>=0;u--)r(t[u+c],o[u],a+1)}(r,t,0),r},numeric.getRange=function(r,n,e){var t,i,o,a,u=n.length,c=e.length,s=Array(u);for(t=u-1;-1!==t;--t)for(s[t]=Array(c),o=s[t],a=r[n[t]],i=c-1;-1!==i;--i)o[i]=a[e[i]];return s},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);var e,t,i,o,a,u=n[0],c=n[1];for(e=0,t=0,i=0;i<u;++i)e+=r[i][0].length;for(o=0;o<c;++o)t+=r[0][o][0].length;var s=Array(e);for(i=0;i<e;++i)s[i]=Array(t);var f,l,h,m,p,v=0;for(i=0;i<u;++i){for(f=t,o=c-1;-1!==o;--o)for(f-=(a=r[i][o])[0].length,h=a.length-1;-1!==h;--h)for(p=a[h],l=s[v+h],m=p.length-1;-1!==m;--m)l[f+m]=p[m];v+=r[i][0].length}return s},numeric.tensor=function(r,n){if("number"==typeof r||"number"==typeof n)return numeric.mul(r,n);var e=numeric.dim(r),t=numeric.dim(n);if(1!==e.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,a,u,c=e[0],s=t[0],f=Array(c);for(o=c-1;o>=0;o--){for(i=Array(s),u=r[o],a=s-1;a>=3;--a)i[a]=u*n[a],i[--a]=u*n[a],i[--a]=u*n[a],i[--a]=u*n[a];for(;a>=0;)i[a]=u*n[a],--a;f[o]=i}return f},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,t,i){var o;numeric.indexOf;if("string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new T(n(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var n=numeric.div;return this.y?new numeric.T(n(this.x,r.x),n(this.y,r.x)):new numeric.T(n(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!=typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+n+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if(void 0===r.y)return new numeric.T(numeric.inv(r.x));var n,e,t,i,o,a,u,c,s,f,l,h,m,p,v,d,y,g,b=r.x.length,w=numeric.identity(b),x=numeric.rep([b,b],0),M=numeric.clone(r.x),T=numeric.clone(r.y);for(s=0;s<b;s++){for(h=(p=M[s][s])*p+(v=T[s][s])*v,l=s,f=s+1;f<b;f++)(m=(p=M[f][s])*p+(v=T[f][s])*v)>h&&(l=f,h=m);for(l!==s&&(g=M[s],M[s]=M[l],M[l]=g,g=T[s],T[s]=T[l],T[l]=g,g=w[s],w[s]=w[l],w[l]=g,g=x[s],x[s]=x[l],x[l]=g),n=M[s],e=T[s],o=w[s],a=x[s],p=n[s],v=e[s],f=s+1;f<b;f++)d=n[f],y=e[f],n[f]=(d*p+y*v)/h,e[f]=(y*p-d*v)/h;for(f=0;f<b;f++)d=o[f],y=a[f],o[f]=(d*p+y*v)/h,a[f]=(y*p-d*v)/h;for(f=s+1;f<b;f++){for(t=M[f],i=T[f],u=w[f],c=x[f],p=t[s],v=i[s],l=s+1;l<b;l++)d=n[l],y=e[l],t[l]-=d*p-y*v,i[l]-=y*p+d*v;for(l=0;l<b;l++)d=o[l],y=a[l],u[l]-=d*p-y*v,c[l]-=y*p+d*v}}for(s=b-1;s>0;s--)for(o=w[s],a=x[s],f=s-1;f>=0;f--)for(u=w[f],c=x[f],p=M[f][s],v=T[f][s],l=b-1;l>=0;l--)d=o[l],y=a[l],u[l]-=p*d-v*y,c[l]-=p*y+v*d;return new numeric.T(w,x)},numeric.T.prototype.get=function(r){var n,e=this.x,t=this.y,i=0,o=r.length;if(t){for(;i<o;)e=e[n=r[i]],t=t[n],i++;return new numeric.T(e,t)}for(;i<o;)e=e[n=r[i]],i++;return new numeric.T(e)},numeric.T.prototype.set=function(r,n){var e,t=this.x,i=this.y,o=0,a=r.length,u=n.x,c=n.y;if(0===a)return c?this.y=c:i&&(this.y=void 0),this.x=t,this;if(c){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);o<a-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=u,i[e]=c,this}if(i){for(;o<a-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=u,u instanceof Array?i[e]=numeric.rep(numeric.dim(u),0):i[e]=0,this}for(;o<a-1;)t=t[e=r[o]],o++;return t[e=r[o]]=u,this},numeric.T.prototype.getRows=function(r,n){var e,t,i=n-r+1,o=Array(i),a=this.x,u=this.y;for(e=r;e<=n;e++)o[e-r]=a[e];if(u){for(t=Array(i),e=r;e<=n;e++)t[e-r]=u[e];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,n,e){var t,i=this.x,o=this.y,a=e.x,u=e.y;for(t=r;t<=n;t++)i[t]=a[t-r];if(u)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),t=r;t<=n;t++)o[t]=u[t-r];else if(o)for(t=r;t<=n;t++)o[t]=numeric.rep([a[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,t=this.y,i=n.x,o=n.y;return e[r]=i,o?(t||(t=numeric.rep(numeric.dim(e),0),this.y=t),t[r]=o):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(e,r,n),i(t,r,n)):new numeric.T(i(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var t=this.x,i=this.y,o=numeric.setBlock,a=e.x,u=e.y;if(u)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(t,r,n,a),o(i,r,n,u),this;o(t,r,n,a),i&&o(i,r,n,numeric.rep(numeric.dim(a),0))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var t=n.x,i=n.y,o=numeric.rep;return i?new e(o(r,t),o(r,i)):new e(o(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var n=r.x,e=r.y,t=numeric.diag;return e?new numeric.T(t(n),t(e)):new numeric.T(t(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=(r[0]>=0?1:-1)*numeric.norm2(r);n[0]+=e;var t=numeric.norm2(n);if(0===t)throw new Error("eig: internal error");return numeric.div(n,t)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var e,t,i,o,a,u,c,s,f,l,h=n[0],m=numeric.clone(r),p=numeric.identity(h);for(t=0;t<h-2;t++){for(o=Array(h-t-1),e=t+1;e<h;e++)o[e-t-1]=m[e][t];if(numeric.norm2(o)>0){for(a=numeric.house(o),u=numeric.getBlock(m,[t+1,t],[h-1,h-1]),c=numeric.tensor(a,numeric.dot(a,u)),e=t+1;e<h;e++)for(s=m[e],f=c[e-t-1],i=t;i<h;i++)s[i]-=2*f[i-t];for(u=numeric.getBlock(m,[0,t+1],[h-1,h-1]),c=numeric.tensor(numeric.dot(u,a),a),e=0;e<h;e++)for(s=m[e],f=c[e],i=t+1;i<h;i++)s[i]-=2*f[i-t-1];for(u=Array(h-t-1),e=t+1;e<h;e++)u[e-t-1]=p[e];for(c=numeric.tensor(a,numeric.dot(a,u)),e=t+1;e<h;e++)for(l=p[e],f=c[e-t-1],i=0;i<h;i++)l[i]-=2*f[i]}}return{H:m,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,n){void 0===n&&(n=1e4),r=numeric.clone(r);numeric.clone(r);var e,t,i,o,a,u,c,s,f,l,h,m,p,v,d,y,g,b,w=numeric.dim(r)[0],x=numeric.identity(w);if(w<3)return{Q:x,B:[[0,w-1]]};var M=numeric.epsilon;for(b=0;b<n;b++){for(y=0;y<w-1;y++)if(Math.abs(r[y+1][y])<M*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var T=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),n),A=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[w-1,w-1]),n);for(m=Array(y+1),d=0;d<=y;d++)m[d]=x[d];for(p=numeric.dot(T.Q,m),d=0;d<=y;d++)x[d]=p[d];for(m=Array(w-y-1),d=y+1;d<w;d++)m[d-y-1]=x[d];for(p=numeric.dot(A.Q,m),d=y+1;d<w;d++)x[d]=p[d-y-1];return{Q:x,B:T.B.concat(numeric.add(A.B,y+1))}}var N,_,k;if(i=r[w-2][w-2],o=r[w-2][w-1],a=r[w-1][w-2],s=i+(u=r[w-1][w-1]),c=i*u-o*a,f=numeric.getBlock(r,[0,0],[2,2]),s*s>=4*c)N=.5*(s+Math.sqrt(s*s-4*c)),_=.5*(s-Math.sqrt(s*s-4*c)),f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,N+_)),numeric.diag(numeric.rep([3],N*_)));else f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,s)),numeric.diag(numeric.rep([3],c)));for(e=[f[0][0],f[1][0],f[2][0]],t=numeric.house(e),m=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,m)),d=0;d<3;d++)for(h=r[d],v=p[d],g=0;g<w;g++)h[g]-=2*v[g];for(m=numeric.getBlock(r,[0,0],[w-1,2]),p=numeric.tensor(numeric.dot(m,t),t),d=0;d<w;d++)for(h=r[d],v=p[d],g=0;g<3;g++)h[g]-=2*v[g];for(m=[x[0],x[1],x[2]],p=numeric.tensor(t,numeric.dot(t,m)),d=0;d<3;d++)for(l=x[d],v=p[d],g=0;g<w;g++)l[g]-=2*v[g];for(y=0;y<w-2;y++){for(g=y;g<=y+1;g++)if(Math.abs(r[g+1][g])<M*(Math.abs(r[g][g])+Math.abs(r[g+1][g+1]))){T=numeric.QRFrancis(numeric.getBlock(r,[0,0],[g,g]),n),A=numeric.QRFrancis(numeric.getBlock(r,[g+1,g+1],[w-1,w-1]),n);for(m=Array(g+1),d=0;d<=g;d++)m[d]=x[d];for(p=numeric.dot(T.Q,m),d=0;d<=g;d++)x[d]=p[d];for(m=Array(w-g-1),d=g+1;d<w;d++)m[d-g-1]=x[d];for(p=numeric.dot(A.Q,m),d=g+1;d<w;d++)x[d]=p[d-g-1];return{Q:x,B:T.B.concat(numeric.add(A.B,g+1))}}for(k=Math.min(w-1,y+3),e=Array(k-y),d=y+1;d<=k;d++)e[d-y-1]=r[d][y];for(t=numeric.house(e),m=numeric.getBlock(r,[y+1,y],[k,w-1]),p=numeric.tensor(t,numeric.dot(t,m)),d=y+1;d<=k;d++)for(h=r[d],v=p[d-y-1],g=y;g<w;g++)h[g]-=2*v[g-y];for(m=numeric.getBlock(r,[0,y+1],[w-1,k]),p=numeric.tensor(numeric.dot(m,t),t),d=0;d<w;d++)for(h=r[d],v=p[d],g=y+1;g<=k;g++)h[g]-=2*v[g-y-1];for(m=Array(k-y),d=y+1;d<=k;d++)m[d-y-1]=x[d];for(p=numeric.tensor(t,numeric.dot(t,m)),d=y+1;d<=k;d++)for(l=x[d],v=p[d-y-1],g=0;g<w;g++)l[g]-=2*v[g]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){var e,t,i,o,a,u,c,s,f,l,h,m,p,v,d,y,g=numeric.toUpperHessenberg(r),b=numeric.QRFrancis(g.H,n),w=numeric.T,x=r.length,M=b.B,T=numeric.dot(b.Q,numeric.dot(g.H,numeric.transpose(b.Q))),A=new w(numeric.dot(b.Q,g.Q)),N=M.length,_=Math.sqrt;for(t=0;t<N;t++)if((e=M[t][0])===M[t][1]);else{if(o=e+1,a=T[e][e],u=T[e][o],c=T[o][e],s=T[o][o],0===u&&0===c)continue;(l=(f=-a-s)*f-4*(a*s-u*c))>=0?((d=(a-(h=f<0?-.5*(f-_(l)):-.5*(f+_(l))))*(a-h)+u*u)>(y=c*c+(s-h)*(s-h))?(p=(a-h)/(d=_(d)),v=u/d):(p=c/(y=_(y)),v=(s-h)/y),i=new w([[v,-p],[p,v]]),A.setRows(e,o,i.dot(A.getRows(e,o)))):(h=-.5*f,m=.5*_(-l),(d=(a-h)*(a-h)+u*u)>(y=c*c+(s-h)*(s-h))?(p=(a-h)/(d=_(d+m*m)),v=u/d,h=0,m/=d):(p=c/(y=_(y+m*m)),v=(s-h)/y,h=m/y,m=0),i=new w([[v,-p],[p,v]],[[h,m],[m,-h]]),A.setRows(e,o,i.dot(A.getRows(e,o))))}var k=A.dot(r).dot(A.transjugate()),P=(x=r.length,numeric.T.identity(x));for(o=0;o<x;o++)if(o>0)for(t=o-1;t>=0;t--){var S=k.get([t,t]),I=k.get([o,o]);numeric.neq(S.x,I.x)||numeric.neq(S.y,I.y)?(h=k.getRow(t).getBlock([t],[o-1]),m=P.getRow(o).getBlock([t],[o-1]),P.set([o,t],k.get([t,o]).neg().sub(h.dot(m)).div(S.sub(I)))):P.setRow(o,P.getRow(t))}for(o=0;o<x;o++)h=P.getRow(o),P.setRow(o,h.div(h.norm2()));return P=P.transpose(),P=A.transjugate().dot(P),{lambda:k.getDiag(),E:P}},numeric.ccsSparse=function(r){var n,e,t,i=r.length,o=[];for(e=i-1;-1!==e;--e)for(t in n=r[e]){for(t=parseInt(t);t>=o.length;)o[o.length]=0;0!==n[t]&&o[t]++}var a=o.length,u=Array(a+1);for(u[0]=0,e=0;e<a;++e)u[e+1]=u[e]+o[e];var c=Array(u[a]),s=Array(u[a]);for(e=i-1;-1!==e;--e)for(t in n=r[e])0!==n[t]&&(o[t]--,c[u[t]+o[t]]=e,s[u[t]+o[t]]=n[t]);return[u,c,s]},numeric.ccsFull=function(r){var n,e,t,i,o=r[0],a=r[1],u=r[2],c=numeric.ccsDim(r),s=c[0],f=c[1],l=numeric.rep([s,f],0);for(n=0;n<f;n++)for(t=o[n],i=o[n+1],e=t;e<i;++e)l[a[e]][n]=u[e];return l},numeric.ccsTSolve=function(r,n,e,t,i){var o,a,u,c,s,f,l,h=r[0],m=r[1],p=r[2],v=h.length-1,d=Math.max,y=0;function g(r){var n;if(0===e[r]){for(e[r]=1,n=h[r];n<h[r+1];++n)g(m[n]);i[y]=r,++y}}for(void 0===t&&(e=numeric.rep([v],0)),void 0===t&&(t=numeric.linspace(0,e.length-1)),void 0===i&&(i=[]),o=t.length-1;-1!==o;--o)g(t[o]);for(i.length=y,o=i.length-1;-1!==o;--o)e[i[o]]=0;for(o=t.length-1;-1!==o;--o)a=t[o],e[a]=n[a];for(o=i.length-1;-1!==o;--o){for(a=i[o],u=h[a],c=d(h[a+1],u),s=u;s!==c;++s)if(m[s]===a){e[a]/=p[s];break}for(l=e[a],s=u;s!==c;++s)(f=m[s])!==a&&(e[f]-=l*p[s])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,t,i,o){var a,u,c,s=0,f=i.length,l=this.k,h=this.k1,m=this.j;if(0===t[r])for(t[r]=1,m[0]=r,l[0]=u=n[r],h[0]=c=n[r+1];;)if(u>=c){if(i[f]=m[s],0===s)return;++f,u=l[--s],c=h[s]}else 0===t[a=o[e[u]]]?(t[a]=1,l[s]=u,m[++s]=a,u=n[a],h[s]=c=n[a+1]):++u},numeric.ccsLPSolve=function(r,n,e,t,i,o,a){var u,c,s,f,l,h,m,p,v,d=r[0],y=r[1],g=r[2],b=(d.length,n[0]),w=n[1],x=n[2];for(c=b[i],s=b[i+1],t.length=0,u=c;u<s;++u)a.dfs(o[w[u]],d,y,e,t,o);for(u=t.length-1;-1!==u;--u)e[t[u]]=0;for(u=c;u!==s;++u)e[f=o[w[u]]]=x[u];for(u=t.length-1;-1!==u;--u){for(l=d[f=t[u]],h=d[f+1],m=l;m<h;++m)if(o[y[m]]===f){e[f]/=g[m];break}for(v=e[f],m=l;m<h;++m)(p=o[y[m]])!==f&&(e[p]-=v*g[m])}return e},numeric.ccsLUP1=function(r,n){var e,t,i,o,a,u,c,s=r[0].length-1,f=[numeric.rep([s+1],0),[],[]],l=[numeric.rep([s+1],0),[],[]],h=f[0],m=f[1],p=f[2],v=l[0],d=l[1],y=l[2],g=numeric.rep([s],0),b=numeric.rep([s],0),w=numeric.ccsLPSolve,x=(Math.max,Math.abs),M=numeric.linspace(0,s-1),T=numeric.linspace(0,s-1),A=new numeric.ccsDFS(s);for(void 0===n&&(n=1),e=0;e<s;++e){for(w(f,r,g,b,e,T,A),o=-1,a=-1,t=b.length-1;-1!==t;--t)(i=b[t])<=e||(u=x(g[i]))>o&&(a=i,o=u);for(x(g[e])<n*o&&(t=M[e],o=M[a],M[e]=o,T[o]=e,M[a]=t,T[t]=a,o=g[e],g[e]=g[a],g[a]=o),o=h[e],a=v[e],c=g[e],m[o]=M[e],p[o]=1,++o,t=b.length-1;-1!==t;--t)u=g[i=b[t]],b[t]=0,g[i]=0,i<=e?(d[a]=i,y[a]=u,++a):(m[o]=M[i],p[o]=u/c,++o);h[e+1]=o,v[e+1]=a}for(t=m.length-1;-1!==t;--t)m[t]=T[m[t]];return{L:f,U:l,P:M,Pinv:T}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,t,i,o,a){var u,c,s,f=0,l=i.length,h=this.k,m=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,h[0]=c=n[o[r]],m[0]=s=n[o[r]+1];;){if(isNaN(c))throw new Error("Ow!");if(c>=s){if(i[l]=o[p[f]],0===f)return;++l,c=h[--f],s=m[f]}else 0===t[u=e[c]]?(t[u]=1,h[f]=c,p[++f]=u,c=n[u=o[u]],m[f]=s=n[u+1]):++c}},numeric.ccsLPSolve0=function(r,n,e,t,i,o,a,u){var c,s,f,l,h,m,p,v,d,y=r[0],g=r[1],b=r[2],w=(y.length,n[0]),x=n[1],M=n[2];for(s=w[i],f=w[i+1],t.length=0,c=s;c<f;++c)u.dfs(x[c],y,g,e,t,o,a);for(c=t.length-1;-1!==c;--c)e[a[l=t[c]]]=0;for(c=s;c!==f;++c)e[l=x[c]]=M[c];for(c=t.length-1;-1!==c;--c){for(v=a[l=t[c]],h=y[l],m=y[l+1],p=h;p<m;++p)if(g[p]===v){e[v]/=b[p];break}for(d=e[v],p=h;p<m;++p)e[g[p]]-=d*b[p];e[v]=d}},numeric.ccsLUP0=function(r,n){var e,t,i,o,a,u,c,s=r[0].length-1,f=[numeric.rep([s+1],0),[],[]],l=[numeric.rep([s+1],0),[],[]],h=f[0],m=f[1],p=f[2],v=l[0],d=l[1],y=l[2],g=numeric.rep([s],0),b=numeric.rep([s],0),w=numeric.ccsLPSolve0,x=(Math.max,Math.abs),M=numeric.linspace(0,s-1),T=numeric.linspace(0,s-1),A=new numeric.ccsDFS0(s);for(void 0===n&&(n=1),e=0;e<s;++e){for(w(f,r,g,b,e,T,M,A),o=-1,a=-1,t=b.length-1;-1!==t;--t)(i=b[t])<=e||(u=x(g[M[i]]))>o&&(a=i,o=u);for(x(g[M[e]])<n*o&&(t=M[e],o=M[a],M[e]=o,T[o]=e,M[a]=t,T[t]=a),o=h[e],a=v[e],c=g[M[e]],m[o]=M[e],p[o]=1,++o,t=b.length-1;-1!==t;--t)u=g[M[i=b[t]]],b[t]=0,g[M[i]]=0,i<=e?(d[a]=i,y[a]=u,++a):(m[o]=M[i],p[o]=u/c,++o);h[e+1]=o,v[e+1]=a}for(t=m.length-1;-1!==t;--t)m[t]=T[m[t]];return{L:f,U:l,P:M,Pinv:T}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var t=numeric.ccsDim(r),i=t[0],o=t[1];void 0===n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]),void 0===e?e=numeric.linspace(0,o-1):"number"==typeof e&&(e=[e]);var a,u,c,s,f=n.length,l=e.length,h=numeric.rep([o],0),m=[],p=[],v=[h,m,p],d=r[0],y=r[1],g=r[2],b=numeric.rep([i],0),w=0,x=numeric.rep([i],0);for(u=0;u<l;++u){var M=d[s=e[u]],T=d[s+1];for(a=M;a<T;++a)x[c=y[a]]=1,b[c]=g[a];for(a=0;a<f;++a)x[n[a]]&&(m[w]=a,p[w]=b[n[a]],++w);for(a=M;a<T;++a)x[c=y[a]]=0;h[u+1]=w}return v},numeric.ccsDot=function(r,n){var e,t,i,o,a,u,c,s,f,l,h,m=r[0],p=r[1],v=r[2],d=n[0],y=n[1],g=n[2],b=numeric.ccsDim(r),w=numeric.ccsDim(n),x=b[0],M=(b[1],w[1]),T=numeric.rep([x],0),A=numeric.rep([x],0),N=Array(x),_=numeric.rep([M],0),k=[],P=[],S=[_,k,P];for(i=0;i!==M;++i){for(o=d[i],a=d[i+1],f=0,t=o;t<a;++t)for(l=y[t],h=g[t],u=m[l],c=m[l+1],e=u;e<c;++e)0===A[s=p[e]]&&(N[f]=s,A[s]=1,f+=1),T[s]=T[s]+v[e]*h;for(a=(o=_[i])+f,_[i+1]=a,t=f-1;-1!==t;--t)h=o+t,e=N[t],k[h]=e,P[h]=T[e],A[e]=0,T[e]=0;_[i+1]=_[i]+f}return S},numeric.ccsLUPSolve=function(r,n){var e=r.L,t=r.U,i=(r.P,n[0]),o=!1;"object"!=typeof i&&(i=(n=[[0,n.length],numeric.linspace(0,n.length-1),n])[0],o=!0);var a,u,c,s,f,l,h=n[1],m=n[2],p=e[0].length-1,v=i.length-1,d=numeric.rep([p],0),y=Array(p),g=numeric.rep([p],0),b=Array(p),w=numeric.rep([v+1],0),x=[],M=[],T=numeric.ccsTSolve,A=0;for(a=0;a<v;++a){for(f=0,c=i[a],s=i[a+1],u=c;u<s;++u)l=r.Pinv[h[u]],b[f]=l,g[l]=m[u],++f;for(b.length=f,T(e,g,d,b,y),u=b.length-1;-1!==u;--u)g[b[u]]=0;if(T(t,d,g,y,b),o)return g;for(u=y.length-1;-1!==u;--u)d[y[u]]=0;for(u=b.length-1;-1!==u;--u)l=b[u],x[A]=l,M[A]=g[l],g[l]=0,++A;w[a+1]=A}return[w,x,M]},numeric.ccsbinop=function(r,n){return void 0===n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var n,e=r[0],t=r[1],i=r[2],o=numeric.sup(t)+1,a=e.length,u=numeric.rep([o],0),c=Array(a),s=Array(a),f=numeric.rep([o],0);for(n=0;n<a;++n)f[t[n]]++;for(n=0;n<o;++n)u[n+1]=u[n]+f[n];var l,h,m=u.slice(0);for(n=0;n<a;++n)c[l=m[h=t[n]]]=e[n],s[l]=i[n],m[h]=m[h]+1;return[u,c,s]},numeric.ccsGather=function(r){var n,e,t,i,o,a=r[0],u=r[1],c=r[2],s=a.length-1,f=u.length,l=Array(f),h=Array(f),m=Array(f);for(o=0,n=0;n<s;++n)for(t=a[n],i=a[n+1],e=t;e!==i;++e)h[o]=n,l[o]=u[e],m[o]=c[e],++o;return[l,h,m]},numeric.sdim=function r(n,e,t){if(void 0===e&&(e=[]),"object"!=typeof n)return e;var i;for(i in void 0===t&&(t=0),t in e||(e[t]=0),n.length>e[t]&&(e[t]=n.length),n)n.hasOwnProperty(i)&&r(n[i],e,t+1);return e},numeric.sclone=function r(n,e,t){void 0===e&&(e=0),void 0===t&&(t=numeric.sdim(n).length);var i,o=Array(n.length);if(e===t-1){for(i in n)n.hasOwnProperty(i)&&(o[i]=n[i]);return o}for(i in n)n.hasOwnProperty(i)&&(o[i]=r(n[i],e+1,t));return o},numeric.sdiag=function(r){var n,e,t=r.length,i=Array(t);for(n=t-1;n>=1;n-=2)e=n-1,i[n]=[],i[n][n]=r[n],i[e]=[],i[e][e]=r[e];return 0===n&&(i[0]=[],i[0][0]=r[n]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var n,e,t,i=[];r.length;for(n in r)if(r.hasOwnProperty(n))for(e in t=r[n])t.hasOwnProperty(e)&&("object"!=typeof i[e]&&(i[e]=[]),i[e][n]=t[e]);return i},numeric.sLUP=function(r,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){var e,t,i,o,a,u,c,s=r.length,f=(n.length,numeric.stranspose(n)),l=f.length,h=Array(s);for(i=s-1;i>=0;i--){for(c=[],e=r[i],a=l-1;a>=0;a--){for(o in u=0,t=f[a],e)e.hasOwnProperty(o)&&o in t&&(u+=e[o]*t[o]);u&&(c[a]=u)}h[i]=c}return h},numeric.sdotMV=function(r,n){var e,t,i,o,a=r.length,u=Array(a);for(t=a-1;t>=0;t--){for(i in o=0,e=r[t])e.hasOwnProperty(i)&&n[i]&&(o+=e[i]*n[i]);o&&(u[t]=o)}return u},numeric.sdotVM=function(r,n){var e,t,i,o,a=[];for(e in r)if(r.hasOwnProperty(e))for(t in i=n[e],o=r[e],i)i.hasOwnProperty(t)&&(a[t]||(a[t]=0),a[t]+=o*i[t]);return a},numeric.sdotVV=function(r,n){var e,t=0;for(e in r)r[e]&&n[e]&&(t+=r[e]*n[e]);return t},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,t=numeric.sdim(n).length;switch(1e3*e+t){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+t)}},numeric.sscatter=function(r){var n,e,t,i,o=r[0].length,a=r.length,u=[];for(e=o-1;e>=0;--e)if(r[a-1][e]){for(i=u,t=0;t<a-2;t++)i[n=r[t][e]]||(i[n]=[]),i=i[n];i[r[t][e]]=r[t+1][e]}return u},numeric.sgather=function r(n,e,t){var i,o,a;for(o in void 0===e&&(e=[]),void 0===t&&(t=[]),i=t.length,n)if(n.hasOwnProperty(o))if(t[i]=parseInt(o),"number"==typeof(a=n[o])){if(a){if(0===e.length)for(o=i+1;o>=0;--o)e[o]=[];for(o=i;o>=0;--o)e[o].push(t[o]);e[i+1].push(a)}}else r(a,e,t);return t.length>i&&t.pop(),e},numeric.cLU=function(r){var n,e,t,i,o,a,u=r[0],c=r[1],s=r[2],f=u.length,l=0;for(n=0;n<f;n++)u[n]>l&&(l=u[n]);l++;var h,m=Array(l),p=Array(l),v=numeric.rep([l],1/0),d=numeric.rep([l],-1/0);for(t=0;t<f;t++)n=u[t],(e=c[t])<v[n]&&(v[n]=e),e>d[n]&&(d[n]=e);for(n=0;n<l-1;n++)d[n]>d[n+1]&&(d[n+1]=d[n]);for(n=l-1;n>=1;n--)v[n]<v[n-1]&&(v[n-1]=v[n]);for(n=0;n<l;n++)p[n]=numeric.rep([d[n]-v[n]+1],0),m[n]=numeric.rep([n-v[n]],0),n-v[n]+1,d[n]-n+1;for(t=0;t<f;t++)p[n=u[t]][c[t]-v[n]]=s[t];for(n=0;n<l-1;n++)for(i=n-v[n],b=p[n],e=n+1;v[e]<=n&&e<l;e++)if(o=n-v[e],a=d[n]-n,h=(w=p[e])[o]/b[i]){for(t=1;t<=a;t++)w[t+o]-=h*b[t+i];m[e][n-v[e]]=h}var y,g,b=[],w=[],x=[],M=[],T=[],A=[];for(f=0,y=0,n=0;n<l;n++){for(i=v[n],o=d[n],g=p[n],e=n;e<=o;e++)g[e-i]&&(b[f]=n,w[f]=e,x[f]=g[e-i],f++);for(g=m[n],e=i;e<n;e++)g[e-i]&&(M[y]=n,T[y]=e,A[y]=g[e-i],y++);M[y]=n,T[y]=n,A[y]=1,y++}return{U:[b,w,x],L:[M,T,A]}},numeric.cLUsolve=function(r,n){var e,t,i=r.L,o=r.U,a=numeric.clone(n),u=i[0],c=i[1],s=i[2],f=o[0],l=o[1],h=o[2],m=f.length,p=(u.length,a.length);for(t=0,e=0;e<p;e++){for(;c[t]<e;)a[e]-=s[t]*a[c[t]],t++;t++}for(t=m-1,e=p-1;e>=0;e--){for(;l[t]>e;)a[e]-=h[t]*a[l[t]],t--;a[e]/=h[t],t--}return a},numeric.cgrid=function(r,n){"number"==typeof r&&(r=[r,r]);var e,t,i,o=numeric.rep(r,-1);if("function"!=typeof n)switch(n){case"L":n=function(n,e){return n>=r[0]/2||e<r[1]/2};break;default:n=function(r,n){return!0}}for(i=0,e=1;e<r[0]-1;e++)for(t=1;t<r[1]-1;t++)n(e,t)&&(o[e][t]=i,i++);return o},numeric.cdelsq=function(r){var n,e,t,i,o,a=[[-1,0],[0,-1],[0,1],[1,0]],u=numeric.dim(r),c=u[0],s=u[1],f=[],l=[],h=[];for(n=1;n<c-1;n++)for(e=1;e<s-1;e++)if(!(r[n][e]<0)){for(t=0;t<4;t++)i=n+a[t][0],o=e+a[t][1],r[i][o]<0||(f.push(r[n][e]),l.push(r[i][o]),h.push(-1));f.push(r[n][e]),l.push(r[n][e]),h.push(4)}return[f,l,h]},numeric.cdotMV=function(r,n){var e,t,i,o=r[0],a=r[1],u=r[2],c=o.length;for(i=0,t=0;t<c;t++)o[t]>i&&(i=o[t]);for(i++,e=numeric.rep([i],0),t=0;t<c;t++)e[o[t]]+=u[t]*n[a[t]];return e},numeric.Spline=function(r,n,e,t,i){this.x=r,this.yl=n,this.yr=e,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,n){var e,t,i,o=this.x,a=this.yl,u=this.yr,c=this.kl,s=this.kr,f=numeric.add,l=numeric.sub,h=numeric.mul;e=l(h(c[n],o[n+1]-o[n]),l(u[n+1],a[n])),t=f(h(s[n+1],o[n]-o[n+1]),l(u[n+1],a[n]));var m=(i=(r-o[n])/(o[n+1]-o[n]))*(1-i);return f(f(f(h(1-i,a[n]),h(i,u[n+1])),h(e,m*(1-i))),h(t,m*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var n,e,t,i=this.x,o=i.length,a=Math.floor;for(n=0,e=o-1;e-n>1;)i[t=a((n+e)/2)]<=r?n=t:e=t;return this._at(r,n)}o=r.length;var u,c=Array(o);for(u=o-1;-1!==u;--u)c[u]=this.at(r[u]);return c},numeric.Spline.prototype.diff=function(){var r,n,e,t=this.x,i=this.yl,o=this.yr,a=this.kl,u=this.kr,c=i.length,s=a,f=u,l=Array(c),h=Array(c),m=numeric.add,p=numeric.mul,v=numeric.div,d=numeric.sub;for(r=c-1;-1!==r;--r)n=t[r+1]-t[r],e=d(o[r+1],i[r]),l[r]=v(m(p(e,6),p(a[r],-4*n),p(u[r+1],-2*n)),n*n),h[r+1]=v(m(p(e,-6),p(a[r],2*n),p(u[r+1],4*n)),n*n);return new numeric.Spline(t,s,f,l,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var n=[],e=this.x,t=this.yl,i=this.yr,o=this.kl,a=this.kr;"number"==typeof t[0]&&(t=[t],i=[i],o=[o],a=[a]);var u,c,s,f,l,h,m,p,v,d,y,g,b,w,x,M,T,A,N,_,k,P,S,I=t.length,j=e.length-1,E=(n=Array(I),Math.sqrt);for(u=0;u!==I;++u){for(f=t[u],l=i[u],h=o[u],m=a[u],p=[],c=0;c!==j;c++){for(c>0&&l[c]*f[c]<0&&p.push(e[c]),M=e[c+1]-e[c],e[c],y=f[c],g=l[c+1],v=h[c]/M,b=(d=m[c+1]/M)+3*y+2*v-3*g,w=3*(d+v+2*(y-g)),(x=r(v-d+3*(y-g))+12*d*y)<=0?T=(A=b/w)>e[c]&&A<e[c+1]?[e[c],A,e[c+1]]:[e[c],e[c+1]]:(A=(b-E(x))/w,N=(b+E(x))/w,T=[e[c]],A>e[c]&&A<e[c+1]&&T.push(A),N>e[c]&&N<e[c+1]&&T.push(N),T.push(e[c+1])),k=T[0],A=this._at(k,c),s=0;s<T.length-1;s++)if(P=T[s+1],N=this._at(P,c),0!==A)if(0===N||A*N>0)k=P,A=N;else{for(var C=0;!((S=(A*P-N*k)/(A-N))<=k||S>=P);)if((_=this._at(S,c))*N>0)P=S,N=_,-1===C&&(A*=.5),C=-1;else{if(!(_*A>0))break;k=S,A=_,1===C&&(N*=.5),C=1}p.push(S),k=T[s+1],A=this._at(k,c)}else p.push(k),k=P,A=N;0===N&&p.push(P)}n[u]=p}return"number"==typeof this.yl[0]?n[0]:n},numeric.spline=function(r,n,e,t){var i,o=r.length,a=[],u=[],c=[],s=numeric.sub,f=numeric.mul,l=numeric.add;for(i=o-2;i>=0;i--)u[i]=r[i+1]-r[i],c[i]=s(n[i+1],n[i]);"string"!=typeof e&&"string"!=typeof t||(e=t="periodic");var h=[[],[],[]];switch(typeof e){case"undefined":a[0]=f(3/(u[0]*u[0]),c[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/u[0],1/u[0]);break;case"string":a[0]=l(f(3/(u[o-2]*u[o-2]),c[o-2]),f(3/(u[0]*u[0]),c[0])),h[0].push(0,0,0),h[1].push(o-2,0,1),h[2].push(1/u[o-2],2/u[o-2]+2/u[0],1/u[0]);break;default:a[0]=e,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<o-1;i++)a[i]=l(f(3/(u[i-1]*u[i-1]),c[i-1]),f(3/(u[i]*u[i]),c[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/u[i-1],2/u[i-1]+2/u[i],1/u[i]);switch(typeof t){case"undefined":a[o-1]=f(3/(u[o-2]*u[o-2]),c[o-2]),h[0].push(o-1,o-1),h[1].push(o-2,o-1),h[2].push(1/u[o-2],2/u[o-2]);break;case"string":h[1][h[1].length-1]=0;break;default:a[o-1]=t,h[0].push(o-1),h[1].push(o-1),h[2].push(1)}a="number"!=typeof a[0]?numeric.transpose(a):[a];var m=Array(a.length);if("string"==typeof e)for(i=m.length-1;-1!==i;--i)m[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),a[i]),m[i][o-1]=m[i][0];else for(i=m.length-1;-1!==i;--i)m[i]=numeric.cLUsolve(numeric.cLU(h),a[i]);return m="number"==typeof n[0]?m[0]:numeric.transpose(m),new numeric.Spline(r,n,n,m,m)},numeric.fftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,a=Math.cos,u=Math.sin,c=Array(t/2),s=Array(t/2),f=Array(t/2),l=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)f[--o]=n[i],l[o]=e[i],--i,c[o]=n[i],s[o]=e[i];r(c,s),r(f,l),o=t/2;var h,m,p,v=-6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),m=a(h=v*i),p=u(h),n[i]=c[o]+m*f[o]-p*l[o],e[i]=s[o]+m*l[o]+p*f[o]}},numeric._ifftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,a=Math.cos,u=Math.sin,c=Array(t/2),s=Array(t/2),f=Array(t/2),l=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)f[--o]=n[i],l[o]=e[i],--i,c[o]=n[i],s[o]=e[i];r(c,s),r(f,l),o=t/2;var h,m,p,v=6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),m=a(h=v*i),p=u(h),n[i]=c[o]+m*f[o]-p*l[o],e[i]=s[o]+m*l[o]+p*f[o]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,t){var i,o,a,u,c;for(numeric.fftpow2(r,n),numeric.fftpow2(e,t),i=r.length-1;-1!==i;--i)o=r[i],u=n[i],a=e[i],c=t[i],r[i]=o*a-u*c,n[i]=o*c+u*a;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,a=o(2),u=Math.ceil(o(2*i-1)/a),c=Math.pow(2,u),s=numeric.rep([c],0),f=numeric.rep([c],0),l=Math.cos,h=Math.sin,m=-3.141592653589793/i,p=numeric.rep([c],0),v=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=e[r];if(void 0!==t)for(r=0;r<i;r++)v[r]=t[r];for(s[0]=1,r=1;r<=c/2;r++)n=m*r*r,s[r]=l(n),f[r]=h(n),s[c-r]=l(n),f[c-r]=h(n);var d=new numeric.T(p,v),y=new numeric.T(s,f);return d=d.mul(y),numeric.convpow2(d.x,d.y,numeric.clone(y.x),numeric.neg(y.y)),(d=d.mul(y)).x.length=i,d.y.length=i,d},numeric.T.prototype.ifft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,a=o(2),u=Math.ceil(o(2*i-1)/a),c=Math.pow(2,u),s=numeric.rep([c],0),f=numeric.rep([c],0),l=Math.cos,h=Math.sin,m=3.141592653589793/i,p=numeric.rep([c],0),v=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=e[r];if(void 0!==t)for(r=0;r<i;r++)v[r]=t[r];for(s[0]=1,r=1;r<=c/2;r++)n=m*r*r,s[r]=l(n),f[r]=h(n),s[c-r]=l(n),f[c-r]=h(n);var d=new numeric.T(p,v),y=new numeric.T(s,f);return d=d.mul(y),numeric.convpow2(d.x,d.y,numeric.clone(y.x),numeric.neg(y.y)),(d=d.mul(y)).x.length=i,d.y.length=i,d.div(i)},numeric.gradient=function(r,n){var e=n.length,t=r(n);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,o,a,u,c,s,f,l,h,m=Math.max,p=numeric.clone(n),v=Array(e),d=(numeric.div,numeric.sub,m=Math.max,Math.abs),y=Math.min,g=0;for(i=0;i<e;i++)for(var b=m(1e-6*t,1e-8);;){if(++g>20)throw new Error("Numerical gradient fails");if(p[i]=n[i]+b,o=r(p),p[i]=n[i]-b,a=r(p),p[i]=n[i],isNaN(o)||isNaN(a))b/=16;else{if(v[i]=(o-a)/(2*b),u=n[i]-b,c=n[i],s=n[i]+b,f=(o-t)/b,l=(t-a)/b,h=m(d(v[i]),d(t),d(o),d(a),d(u),d(c),d(s),1e-8),!(y(m(d(f-v[i]),d(l-v[i]),d(f-l))/h,b/h)>.001))break;b/=16}}return v},numeric.uncmin=function(r,n,e,t,i,o,a){var u=numeric.gradient;void 0===a&&(a={}),void 0===e&&(e=1e-8),void 0===t&&(t=function(n){return u(r,n)}),void 0===i&&(i=1e3);var c,s,f=(n=numeric.clone(n)).length,l=r(n);if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,m=numeric.norm2;e=h(e,numeric.epsilon);var p,v,d,y,g,b,w,x,M,T,A=a.Hinv||numeric.identity(f),N=numeric.dot,_=(numeric.inv,numeric.sub),k=numeric.add,P=numeric.tensor,S=numeric.div,I=numeric.mul,j=numeric.all,E=numeric.isFinite,C=numeric.neg,F=0,O="";for(v=t(n);F<i;){if("function"==typeof o&&o(F,n,l,v,A)){O="Callback returned true";break}if(!j(E(v))){O="Gradient has Infinity or NaN";break}if(!j(E(p=C(N(A,v))))){O="Search direction has Infinity or NaN";break}if((T=m(p))<e){O="Newton step smaller than tol";break}for(M=1,s=N(v,p),g=n;F<i&&!(M*T<e)&&(g=k(n,y=I(p,M)),(c=r(g))-l>=.1*M*s||isNaN(c));)M*=.5,++F;if(M*T<e){O="Line search step size smaller than tol";break}if(F===i){O="maxit reached during line search";break}x=N(b=_(d=t(g),v),y),w=N(A,b),A=_(k(A,I((x+N(b,w))/(x*x),P(y,y))),S(k(P(w,y),P(y,w)),x)),n=g,l=c,v=d,++F}return{solution:n,f:l,gradient:v,invHessian:A,iterations:F,message:O}},numeric.Dopri=function(r,n,e,t,i,o,a){this.x=r,this.y=n,this.f=e,this.ymid=t,this.iterations=i,this.events=a,this.message=o},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var t,i,o,a,u,c,s,f,l,h=this.x,m=this.y,p=this.f,v=this.ymid,d=(h.length,Math.floor,numeric.add),y=numeric.mul,g=numeric.sub;return t=h[n],i=h[n+1],a=m[n],u=m[n+1],o=t+.5*(i-t),c=v[n],s=g(p[n],y(a,1/(t-o)+2/(t-i))),f=g(p[n+1],y(u,1/(i-o)+2/(i-t))),d(d(d(d(y(a,(l=[e(r-i)*(r-o)/e(t-i)/(t-o),e(r-t)*e(r-i)/e(t-o)/e(i-o),e(r-t)*(r-o)/e(i-t)/(i-o),(r-t)*e(r-i)*(r-o)/e(t-i)/(t-o),(r-i)*e(r-t)*(r-o)/e(t-i)/(i-o)])[0]),y(c,l[1])),y(u,l[2])),y(s,l[3])),y(f,l[4]))},numeric.Dopri.prototype.at=function(r){var n,e,t,i=Math.floor;if("number"!=typeof r){var o=r.length,a=Array(o);for(n=o-1;-1!==n;--n)a[n]=this.at(r[n]);return a}var u=this.x;for(n=0,e=u.length-1;e-n>1;)u[t=i(.5*(n+e))]<=r?n=t:e=t;return this._at(r,n)},numeric.dopri=function(r,n,e,t,i,o,a){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var u,c,s,f,l,h,m,p,v,d,y,g,b,w=[r],x=[e],M=[t(r,e)],T=[],A=[.075,.225],N=[44/45,-56/15,32/9],_=[19372/6561,-25360/2187,64448/6561,-212/729],k=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],P=[35/384,0,500/1113,125/192,-2187/6784,11/84],S=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],I=[.2,.3,.8,8/9,1,1],j=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],E=0,C=(n-r)/10,F=0,O=numeric.add,q=numeric.mul,V=(Math.max,Math.min),$=Math.abs,D=numeric.norminf,R=Math.pow,L=numeric.any,U=numeric.lt,W=numeric.and,B=(numeric.sub,new numeric.Dopri(w,x,M,T,-1,""));for("function"==typeof a&&(y=a(r,e));r<n&&F<o;)if(++F,r+C>n&&(C=n-r),u=t(r+I[0]*C,O(e,q(.2*C,M[E]))),c=t(r+I[1]*C,O(O(e,q(A[0]*C,M[E])),q(A[1]*C,u))),s=t(r+I[2]*C,O(O(O(e,q(N[0]*C,M[E])),q(N[1]*C,u)),q(N[2]*C,c))),f=t(r+I[3]*C,O(O(O(O(e,q(_[0]*C,M[E])),q(_[1]*C,u)),q(_[2]*C,c)),q(_[3]*C,s))),l=t(r+I[4]*C,O(O(O(O(O(e,q(k[0]*C,M[E])),q(k[1]*C,u)),q(k[2]*C,c)),q(k[3]*C,s)),q(k[4]*C,f))),h=t(r+C,v=O(O(O(O(O(e,q(M[E],C*P[0])),q(c,C*P[2])),q(s,C*P[3])),q(f,C*P[4])),q(l,C*P[5]))),(d="number"==typeof(m=O(O(O(O(O(q(M[E],C*j[0]),q(c,C*j[2])),q(s,C*j[3])),q(f,C*j[4])),q(l,C*j[5])),q(h,C*j[6])))?$(m):D(m))>i){if(r+(C=.2*C*R(i/d,.25))===r){B.msg="Step size became too small";break}}else{if(T[E]=O(O(O(O(O(O(e,q(M[E],C*S[0])),q(c,C*S[2])),q(s,C*S[3])),q(f,C*S[4])),q(l,C*S[5])),q(h,C*S[6])),w[++E]=r+C,x[E]=v,M[E]=h,"function"==typeof a){var Y,Q,X=r,H=r+.5*C;if(g=a(H,T[E-1]),L(b=W(U(y,0),U(0,g)))||(X=H,y=g,g=a(H=r+C,v),b=W(U(y,0),U(0,g))),L(b)){for(var G,z,Z=0,K=1,J=1;;){if("number"==typeof y)Q=(J*g*X-K*y*H)/(J*g-K*y);else for(Q=H,p=y.length-1;-1!==p;--p)y[p]<0&&g[p]>0&&(Q=V(Q,(J*g[p]*X-K*y[p]*H)/(J*g[p]-K*y[p])));if(Q<=X||Q>=H)break;z=a(Q,Y=B._at(Q,E-1)),L(G=W(U(y,0),U(0,z)))?(H=Q,g=z,b=G,J=1,-1===Z?K*=.5:K=1,Z=-1):(X=Q,y=z,K=1,1===Z?J*=.5:J=1,Z=1)}return v=B._at(.5*(r+Q),E-1),B.f[E]=t(Q,Y),B.x[E]=Q,B.y[E]=Y,B.ymid[E-1]=v,B.events=b,B.iterations=F,B}}r+=C,e=v,y=g,C=V(.8*C*R(i/d,.25),4*C)}return B.iterations=F,B},numeric.LU=function(r,n){n=n||!1;var e,t,i,o,a,u,c,s,f,l=Math.abs,h=r.length,m=h-1,p=new Array(h);for(n||(r=numeric.clone(r)),i=0;i<h;++i){for(c=i,f=l((u=r[i])[i]),t=i+1;t<h;++t)f<(o=l(r[t][i]))&&(f=o,c=t);for(p[i]=c,c!=i&&(r[i]=r[c],r[c]=u,u=r[i]),a=u[i],e=i+1;e<h;++e)r[e][i]/=a;for(e=i+1;e<h;++e){for(s=r[e],t=i+1;t<m;++t)s[t]-=s[i]*u[t],s[++t]-=s[i]*u[t];t===m&&(s[t]-=s[i]*u[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,n){var e,t,i,o,a,u=r.LU,c=u.length,s=numeric.clone(n),f=r.P;for(e=c-1;-1!==e;--e)s[e]=n[e];for(e=0;e<c;++e)for(i=f[e],f[e]!==e&&(a=s[e],s[e]=s[i],s[i]=a),o=u[e],t=0;t<e;++t)s[e]-=s[t]*o[t];for(e=c-1;e>=0;--e){for(o=u[e],t=e+1;t<c;++t)s[e]-=s[t]*o[t];s[e]/=o[e]}return s},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var n,e,t,i,o,a,u,c,s=numeric.dim(r),f=s[0],l=s[1],h=numeric.identity(f),m=Array(f),p=Math.abs,v=numeric.diveq;for(r=numeric.clone(r),n=0;n<f;++n){for(t=0,o=r[n],a=h[n],e=1;e<l;++e)p(o[t])<p(o[e])&&(t=e);for(m[n]=t,v(a,o[t]),v(o,o[t]),e=0;e<f;++e)if(e!==n){for(c=(u=r[e])[t],i=l-1;-1!==i;--i)u[i]-=o[i]*c;for(u=h[e],i=f-1;-1!==i;--i)u[i]-=a[i]*c}}return{I:h,A:r,P:m}},numeric.__solveLP=function(r,n,e,t,i,o,a){var u,c,s,f,l=numeric.sum,h=(numeric.log,numeric.mul),m=numeric.sub,p=numeric.dot,v=numeric.div,d=numeric.add,y=r.length,g=e.length,b=!1,w=1,x=(numeric.transpose(n),numeric.svd,numeric.transpose),M=(numeric.leq,Math.sqrt),T=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),N=numeric.all,_=numeric.gt,k=Array(y),P=Array(g),S=(numeric.rep([g],1),numeric.solve),I=m(e,p(n,o)),j=p(r,r);for(s=0;s<i;++s){var E,C;for(E=g-1;-1!==E;--E)P[E]=v(n[E],I[E]);var F=x(P);for(E=y-1;-1!==E;--E)k[E]=l(F[E]);w=.25*T(j/p(r,k));var O=100*M(j/p(k,k));for((!isFinite(w)||w>O)&&(w=O),f=d(r,h(w,k)),c=p(F,P),E=y-1;-1!==E;--E)c[E][E]+=1;C=S(c,v(f,w),!0);var q=v(I,p(n,C)),V=1;for(E=g-1;-1!==E;--E)q[E]<0&&(V=A(V,-.999*q[E]));if(u=m(o,h(C,V)),!N(_(I=m(e,p(n,u)),0)))return{solution:o,message:"",iterations:s};if(o=u,w<t)return{solution:u,message:"",iterations:s};if(a){var $=p(r,f),D=p(n,f);for(b=!0,E=g-1;-1!==E;--E)if($*D[E]<0){b=!1;break}}else b=!(o[y-1]>=0);if(b)return{solution:u,message:"Unbounded",iterations:s}}return{solution:o,message:"maximum iteration count exceeded",iterations:s}},numeric._solveLP=function(r,n,e,t,i){var o=r.length,a=e.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),c=numeric.dot,s=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),f=numeric.rep([a,1],-1),l=numeric.blockMatrix([[n,f]]),h=e,m=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),p=numeric.__solveLP(s,l,h,t,i,m,!1),v=numeric.clone(p.solution);if(v.length=o,numeric.inf(u(e,c(n,v)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var d=numeric.__solveLP(r,n,e,t,i-p.iterations,v,!0);return d.iterations+=p.iterations,d},numeric.solveLP=function(r,n,e,t,i,o,a){if(void 0===a&&(a=1e3),void 0===o&&(o=numeric.epsilon),void 0===t)return numeric._solveLP(r,n,e,o,a);var u,c=t.length,s=t[0].length,f=n.length,l=numeric.echelonize(t),h=numeric.rep([s],0),m=l.P,p=[];for(u=m.length-1;-1!==u;--u)h[m[u]]=1;for(u=s-1;-1!==u;--u)0===h[u]&&p.push(u);var v=numeric.getRange,d=numeric.linspace(0,c-1),y=numeric.linspace(0,f-1),g=v(t,d,p),b=v(n,y,m),w=v(n,y,p),x=numeric.dot,M=numeric.sub,T=x(b,l.I),A=M(w,x(T,g)),N=M(e,x(T,i)),_=Array(m.length),k=Array(p.length);for(u=m.length-1;-1!==u;--u)_[u]=r[m[u]];for(u=p.length-1;-1!==u;--u)k[u]=r[p[u]];var P=M(k,x(_,x(l.I,g))),S=numeric._solveLP(P,A,N,o,a),I=S.solution;if(I!=I)return S;var j=x(l.I,M(i,x(g,I))),E=Array(r.length);for(u=m.length-1;-1!==u;--u)E[m[u]]=j[u];for(u=p.length-1;-1!==u;--u)E[p[u]]=I[u];return{solution:E,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\n");var n,e,t,i,o=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=r.length,c=0,s={},f=[],l=0,h={},m=0,p=[],v=[],d=[];function y(e){throw new Error("MPStoLP: "+e+"\nLine "+n+": "+r[n]+"\nCurrent state: "+a[o]+"\n")}for(n=0;n<u;++n){var g=(t=r[n]).match(/\S*/g),b=[];for(e=0;e<g.length;++e)""!==g[e]&&b.push(g[e]);if(0!==b.length){for(e=0;e<a.length&&t.substr(0,a[e].length)!==a[e];++e);if(e<a.length){if(o=e,1===e&&(i=b[1]),6===e)return{name:i,c:p,A:numeric.transpose(v),b:d,rows:s,vars:h}}else switch(o){case 0:case 1:y("Unexpected line");case 2:switch(b[0]){case"N":0===c?c=b[1]:y("Two or more N rows");break;case"L":s[b[1]]=l,f[l]=1,d[l]=0,++l;break;case"G":s[b[1]]=l,f[l]=-1,d[l]=0,++l;break;case"E":s[b[1]]=l,f[l]=0,d[l]=0,++l;break;default:y("Parse error "+numeric.prettyPrint(b))}break;case 3:h.hasOwnProperty(b[0])||(h[b[0]]=m,p[m]=0,v[m]=numeric.rep([l],0),++m);var w=h[b[0]];for(e=1;e<b.length;e+=2)if(b[e]!==c){var x=s[b[e]];v[w][x]=(f[x]<0?-1:1)*parseFloat(b[e+1])}else p[w]=parseFloat(b[e+1]);break;case 4:for(e=1;e<b.length;e+=2)d[s[b[e]]]=(f[s[b[e]]]<0?-1:1)*parseFloat(b[e+1]);break;case 5:break;case 6:y("Internal error")}}}y("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,n,e,t,i,o,a){function u(r){var n,t,i=this,o=r.length,a=0,u=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);a<e;)i.S[a]=a++;for(a=0;a<e;a++)u=s(u+(n=i.S[a])+r[a%o]),t=i.S[u],i.S[a]=t,i.S[u]=n;i.g=function(r){var n=i.S,t=s(i.i+1),o=n[t],a=s(i.j+o),u=n[a];n[t]=u,n[a]=o;for(var c=n[s(o+u)];--r;)t=s(t+1),u=n[a=s(a+(o=n[t]))],n[t]=u,n[a]=o,c=c*e+n[s(o+u)];return i.i=t,i.j=a,c},i.g(e)}function c(r,n,e,t){for(r+="",e=0,t=0;t<r.length;t++)n[s(t)]=s((e^=19*n[s(t)])+r.charCodeAt(t));for(t in r="",n)r+=String.fromCharCode(n[t]);return r}function s(r){return r&e-1}n.seedrandom=function(t,s){var f,l=[];return t=c(function r(n,e,t,i,o){t=[];o=typeof n;if(e&&"object"==o)for(i in n)if(i.indexOf("S")<5)try{t.push(r(n[i],e-1))}catch(r){}return t.length?t:n+("string"!=o?"\0":"")}(s?[t,r]:arguments.length?t:[(new Date).getTime(),r,window],3),l),c((f=new u(l)).S,r),n.random=function(){for(var r=f.g(6),n=a,t=0;r<i;)r=(r+t)*e,n*=e,t=f.g(1);for(;r>=o;)r/=2,n/=2,t>>>=1;return(r+t)/n},t},a=n.pow(e,6),i=n.pow(2,i),o=2*i,c(n.random(),r)}([],numeric.seedrandom,256,0,52),function(r){function n(r){if("object"!=typeof r)return r;var e,t=[],i=r.length;for(e=0;e<i;e++)t[e+1]=n(r[e]);return t}function e(r){if("object"!=typeof r)return r;var n,t=[],i=r.length;for(n=1;n<i;n++)t[n-1]=e(r[n]);return t}function t(r,n,e,t,i,o,a,u,c,s,f,l,h,m,p,v){var d,y,g,b,w,x,M,T,A,N,_,k,P,S,I,j,E,C,F,O,q,V,$,D,R,L,U;P=Math.min(t,s),g=2*t+P*(P+5)/2+2*s+1,D=1e-60;do{R=1+.1*(D+=D),L=1+.2*D}while(R<=1||L<=1);for(d=1;d<=t;d+=1)p[d]=n[d];for(d=t+1;d<=g;d+=1)p[d]=0;for(d=1;d<=s;d+=1)l[d]=0;if(w=[],0===v[1]){if(function(r,n,e,t){var i,o,a,u,c,s;for(o=1;o<=e;o+=1){if(t[1]=o,s=0,(a=o-1)<1){if((s=r[o][o]-s)<=0)break;r[o][o]=Math.sqrt(s)}else{for(u=1;u<=a;u+=1){for(c=r[u][o],i=1;i<u;i+=1)c-=r[i][o]*r[i][u];c/=r[u][u],r[u][o]=c,s+=c*c}if((s=r[o][o]-s)<=0)break;r[o][o]=Math.sqrt(s)}t[1]=0}}(r,0,t,w),0!==w[1])return void(v[1]=2);!function(r,n,e,t){var i,o,a,u;for(o=1;o<=e;o+=1){for(u=0,i=1;i<o;i+=1)u+=r[i][o]*t[i];t[o]=(t[o]-u)/r[o][o]}for(a=1;a<=e;a+=1)for(t[o=e+1-a]=t[o]/r[o][o],u=-t[o],i=1;i<o;i+=1)t[i]=t[i]+u*r[i][o]}(r,0,t,n),function(r,n,e){var t,i,o,a,u;for(o=1;o<=e;o+=1){for(r[o][o]=1/r[o][o],u=-r[o][o],t=1;t<o;t+=1)r[t][o]=u*r[t][o];if(e<(a=o+1))break;for(i=a;i<=e;i+=1)for(u=r[o][i],r[o][i]=0,t=1;t<=o;t+=1)r[t][i]=r[t][i]+u*r[t][o]}}(r,0,t)}else{for(y=1;y<=t;y+=1)for(i[y]=0,d=1;d<=y;d+=1)i[y]=i[y]+r[d][y]*n[d];for(y=1;y<=t;y+=1)for(n[y]=0,d=y;d<=t;d+=1)n[y]=n[y]+r[y][d]*i[d]}for(o[1]=0,y=1;y<=t;y+=1)for(i[y]=n[y],o[1]=o[1]+p[y]*i[y],p[y]=0,d=y+1;d<=t;d+=1)r[d][y]=0;for(o[1]=-o[1]/2,v[1]=0,S=(N=(A=(_=(T=(M=t)+t)+P)+P+1)+P*(P+1)/2)+s,d=1;d<=s;d+=1){for(j=0,y=1;y<=t;y+=1)j+=a[y][d]*a[y][d];p[S+d]=Math.sqrt(j)}function W(){for(m[1]=m[1]+1,g=N,d=1;d<=s;d+=1){for(g+=1,j=-u[d],y=1;y<=t;y+=1)j+=a[y][d]*i[y];if(Math.abs(j)<D&&(j=0),d>f)p[g]=j;else if(p[g]=-Math.abs(j),j>0){for(y=1;y<=t;y+=1)a[y][d]=-a[y][d];u[d]=-u[d]}}for(d=1;d<=h;d+=1)p[N+l[d]]=0;for(k=0,I=0,d=1;d<=s;d+=1)p[N+d]<I*p[S+d]&&(k=d,I=p[N+d]/p[S+d]);return 0===k?999:0}function B(){for(d=1;d<=t;d+=1){for(j=0,y=1;y<=t;y+=1)j+=r[y][d]*a[y][k];p[d]=j}for(b=M,d=1;d<=t;d+=1)p[b+d]=0;for(y=h+1;y<=t;y+=1)for(d=1;d<=t;d+=1)p[b+d]=p[b+d]+r[d][y]*p[y];for(V=!0,d=h;d>=1;d-=1){for(j=p[d],b=(g=A+d*(d+3)/2)-d,y=d+1;y<=h;y+=1)j-=p[g]*p[T+y],g+=y;if(j/=p[b],p[T+d]=j,l[d]<f)break;if(j<0)break;V=!1,x=d}if(!V)for(E=p[_+x]/p[T+x],d=1;d<=h&&!(l[d]<f)&&!(p[T+d]<0);d+=1)(I=p[_+d]/p[T+d])<E&&(E=I,x=d);for(j=0,d=M+1;d<=M+t;d+=1)j+=p[d]*p[d];if(Math.abs(j)<=D){if(V)return v[1]=1,999;for(d=1;d<=h;d+=1)p[_+d]=p[_+d]-E*p[T+d];return p[_+h+1]=p[_+h+1]+E,700}for(j=0,d=1;d<=t;d+=1)j+=p[M+d]*a[d][k];for(C=-p[N+k]/j,$=!0,V||E<C&&(C=E,$=!1),d=1;d<=t;d+=1)i[d]=i[d]+C*p[M+d],Math.abs(i[d])<D&&(i[d]=0);for(o[1]=o[1]+C*j*(C/2+p[_+h+1]),d=1;d<=h;d+=1)p[_+d]=p[_+d]-C*p[T+d];if(p[_+h+1]=p[_+h+1]+C,!$){for(j=-u[k],y=1;y<=t;y+=1)j+=i[y]*a[y][k];if(k>f)p[N+k]=j;else if(p[N+k]=-Math.abs(j),j>0){for(y=1;y<=t;y+=1)a[y][k]=-a[y][k];u[k]=-u[k]}return 700}for(l[h+=1]=k,g=A+(h-1)*h/2+1,d=1;d<=h-1;d+=1)p[g]=p[d],g+=1;if(h===t)p[g]=p[t];else{for(d=t;d>=h+1&&0!==p[d]&&(F=Math.max(Math.abs(p[d-1]),Math.abs(p[d])),O=Math.min(Math.abs(p[d-1]),Math.abs(p[d])),I=p[d-1]>=0?Math.abs(F*Math.sqrt(1+O*O/(F*F))):-Math.abs(F*Math.sqrt(1+O*O/(F*F))),F=p[d-1]/I,O=p[d]/I,1!==F);d-=1)if(0===F)for(p[d-1]=O*I,y=1;y<=t;y+=1)I=r[y][d-1],r[y][d-1]=r[y][d],r[y][d]=I;else for(p[d-1]=I,q=O/(1+F),y=1;y<=t;y+=1)I=F*r[y][d-1]+O*r[y][d],r[y][d]=q*(r[y][d-1]+I)-r[y][d],r[y][d-1]=I;p[g]=p[h]}return 0}function Y(){if(0===p[b=(g=A+x*(x+1)/2+1)+x])return 798;if(F=Math.max(Math.abs(p[b-1]),Math.abs(p[b])),O=Math.min(Math.abs(p[b-1]),Math.abs(p[b])),I=p[b-1]>=0?Math.abs(F*Math.sqrt(1+O*O/(F*F))):-Math.abs(F*Math.sqrt(1+O*O/(F*F))),F=p[b-1]/I,O=p[b]/I,1===F)return 798;if(0===F){for(d=x+1;d<=h;d+=1)I=p[b-1],p[b-1]=p[b],p[b]=I,b+=d;for(d=1;d<=t;d+=1)I=r[d][x],r[d][x]=r[d][x+1],r[d][x+1]=I}else{for(q=O/(1+F),d=x+1;d<=h;d+=1)I=F*p[b-1]+O*p[b],p[b]=q*(p[b-1]+I)-p[b],p[b-1]=I,b+=d;for(d=1;d<=t;d+=1)I=F*r[d][x]+O*r[d][x+1],r[d][x+1]=q*(r[d][x]+I)-r[d][x+1],r[d][x]=I}return 0}function Q(){for(b=g-x,d=1;d<=x;d+=1)p[b]=p[g],g+=1,b+=1;return p[_+x]=p[_+x+1],l[x]=l[x+1],(x+=1)<h?797:0}function X(){return p[_+h]=p[_+h+1],p[_+h+1]=0,l[h]=0,h-=1,m[2]=m[2]+1,0}for(h=0,m[1]=0,m[2]=0,U=0;;){if(999===(U=W()))return;for(;0!==(U=B());){if(999===U)return;if(700===U)if(x===h)X();else{for(;Y(),797===(U=Q()););X()}}}}numeric.solveQP=function(r,i,o,a,u,c){r=n(r),i=n(i),o=n(o);var s,f,l,h,m,p=[],v=[],d=[],y=[],g=[];if(u=u||0,c=c?n(c):[void 0,0],a=a?n(a):[],f=r.length-1,l=o[1].length-1,!a)for(s=1;s<=l;s+=1)a[s]=0;for(s=1;s<=l;s+=1)v[s]=0;for(h=Math.min(f,l),s=1;s<=f;s+=1)d[s]=0;for(p[1]=0,s=1;s<=2*f+h*(h+5)/2+2*l+1;s+=1)y[s]=0;for(s=1;s<=2;s+=1)g[s]=0;return t(r,i,0,f,d,p,o,a,0,l,u,v,0,g,y,c),m="",1===c[1]&&(m="constraints are inconsistent, no solution!"),2===c[1]&&(m="matrix D in quadratic function is not positive definite!"),{solution:e(d),value:e(p),unconstrained_solution:e(i),iterations:e(g),iact:e(v),message:m}}}(),numeric.svd=function(r){var n,e=numeric.epsilon,t=1e-64/e,i=0,o=0,a=0,u=0,c=0,s=numeric.clone(r),f=s.length,l=s[0].length;if(f<l)throw"Need more rows than columns";var h=new Array(l),m=new Array(l);for(o=0;o<l;o++)h[o]=m[o]=0;var p=numeric.rep([l,l],0);function v(r,n){return(r=Math.abs(r))>(n=Math.abs(n))?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var d=0,y=0,g=0,b=0,w=0,x=0,M=0;for(o=0;o<l;o++){for(h[o]=y,M=0,c=o+1,a=o;a<f;a++)M+=s[a][o]*s[a][o];if(M<=t)y=0;else for(d=s[o][o],y=Math.sqrt(M),d>=0&&(y=-y),g=d*y-M,s[o][o]=d-y,a=c;a<l;a++){for(M=0,u=o;u<f;u++)M+=s[u][o]*s[u][a];for(d=M/g,u=o;u<f;u++)s[u][a]+=d*s[u][o]}for(m[o]=y,M=0,a=c;a<l;a++)M+=s[o][a]*s[o][a];if(M<=t)y=0;else{for(d=s[o][o+1],y=Math.sqrt(M),d>=0&&(y=-y),g=d*y-M,s[o][o+1]=d-y,a=c;a<l;a++)h[a]=s[o][a]/g;for(a=c;a<f;a++){for(M=0,u=c;u<l;u++)M+=s[a][u]*s[o][u];for(u=c;u<l;u++)s[a][u]+=M*h[u]}}(w=Math.abs(m[o])+Math.abs(h[o]))>b&&(b=w)}for(o=l-1;-1!=o;o+=-1){if(0!=y){for(g=y*s[o][o+1],a=c;a<l;a++)p[a][o]=s[o][a]/g;for(a=c;a<l;a++){for(M=0,u=c;u<l;u++)M+=s[o][u]*p[u][a];for(u=c;u<l;u++)p[u][a]+=M*p[u][o]}}for(a=c;a<l;a++)p[o][a]=0,p[a][o]=0;p[o][o]=1,y=h[o],c=o}for(o=l-1;-1!=o;o+=-1){for(c=o+1,y=m[o],a=c;a<l;a++)s[o][a]=0;if(0!=y){for(g=s[o][o]*y,a=c;a<l;a++){for(M=0,u=c;u<f;u++)M+=s[u][o]*s[u][a];for(d=M/g,u=o;u<f;u++)s[u][a]+=d*s[u][o]}for(a=o;a<f;a++)s[a][o]=s[a][o]/y}else for(a=o;a<f;a++)s[a][o]=0;s[o][o]+=1}for(e*=b,u=l-1;-1!=u;u+=-1)for(var T=0;T<50;T++){var A=!1;for(c=u;-1!=c;c+=-1){if(Math.abs(h[c])<=e){A=!0;break}if(Math.abs(m[c-1])<=e)break}if(!A){i=0,M=1;var N=c-1;for(o=c;o<u+1&&(d=M*h[o],h[o]=i*h[o],!(Math.abs(d)<=e));o++)for(g=v(d,y=m[o]),m[o]=g,i=y/g,M=-d/g,a=0;a<f;a++)w=s[a][N],x=s[a][o],s[a][N]=w*i+x*M,s[a][o]=-w*M+x*i}if(x=m[u],c==u){if(x<0)for(m[u]=-x,a=0;a<l;a++)p[a][u]=-p[a][u];break}if(T>=49)throw"Error: no convergence.";for(b=m[c],y=v(d=(((w=m[u-1])-x)*(w+x)+((y=h[u-1])-(g=h[u]))*(y+g))/(2*g*w),1),d=d<0?((b-x)*(b+x)+g*(w/(d-y)-g))/b:((b-x)*(b+x)+g*(w/(d+y)-g))/b,i=1,M=1,o=c+1;o<u+1;o++){for(y=h[o],w=m[o],g=M*y,y*=i,x=v(d,g),h[o-1]=x,d=b*(i=d/x)+y*(M=g/x),y=-b*M+y*i,g=w*M,w*=i,a=0;a<l;a++)b=p[a][o-1],x=p[a][o],p[a][o-1]=b*i+x*M,p[a][o]=-b*M+x*i;for(x=v(d,g),m[o-1]=x,d=(i=d/x)*y+(M=g/x)*w,b=-M*y+i*w,a=0;a<f;a++)w=s[a][o-1],x=s[a][o],s[a][o-1]=w*i+x*M,s[a][o]=-w*M+x*i}h[c]=0,h[u]=d,m[u]=b}for(o=0;o<m.length;o++)m[o]<e&&(m[o]=0);for(o=0;o<l;o++)for(a=o-1;a>=0;a--)if(m[a]<m[o]){for(i=m[a],m[a]=m[o],m[o]=i,u=0;u<s.length;u++)n=s[u][o],s[u][o]=s[u][a],s[u][a]=n;for(u=0;u<p.length;u++)n=p[u][o],p[u][o]=p[u][a],p[u][a]=n;o=a}return{U:s,S:m,V:p}}}).call(this,__webpack_require__(17))},function(r,n,e){var t=e(14),i=e(15),o=e(16);r.exports=function(r,n){return t(r)||i(r,n)||o()}},function(r,n){r.exports=function(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}},function(r,n){function e(r,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}r.exports=function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}},function(r,n){function e(r){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function t(n){return"function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?r.exports=t=function(r){return e(r)}:r.exports=t=function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":e(r)},t(n)}r.exports=t},function(r,n,e){var t=e(11),i=e(12),o=e(13);r.exports=function(r){return t(r)||i(r)||o()}},function(r,n,e){var t=e(4),i=e(18);r.exports=function(r,n){return!n||"object"!==t(n)&&"function"!=typeof n?i(r):n}},function(r,n){function e(n){return r.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},e(n)}r.exports=e},function(r,n,e){var t=e(19);r.exports=function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),n&&t(r,n)}},function(r,n){},function(r,n,e){"use strict";(function(r,t){var i,o=e(4),a=e.n(o),u=(i="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(n){var o,u=void 0!==(n=n||{})?n:{},c={};for(o in u)u.hasOwnProperty(o)&&(c[o]=u[o]);u.arguments=[],u.thisProgram="./this.program",u.quit=function(r,n){throw n},u.preRun=[],u.postRun=[];var s,f,l=!1,h=!1;l="object"===("undefined"==typeof window?"undefined":a()(window)),h="function"==typeof importScripts,s="object"===(void 0===r?"undefined":a()(r))&&!l&&!h,f=!l&&!s&&!h;var m,p,v="";s?(v=t+"/",u.read=function(r,n){var t;return m||(m=e(9)),p||(p=e(9)),r=p.normalize(r),t=m.readFileSync(r),n?t:t.toString()},u.readBinary=function(r){var n=u.read(r,!0);return n.buffer||(n=new Uint8Array(n)),x(n.buffer),n},r.argv.length>1&&(u.thisProgram=r.argv[1].replace(/\\/g,"/")),u.arguments=r.argv.slice(2),r.on("uncaughtException",function(r){if(!(r instanceof gn))throw r}),r.on("unhandledRejection",wn),u.quit=function(n){r.exit(n)},u.inspect=function(){return"[Emscripten Module object]"}):f?("undefined"!=typeof read&&(u.read=function(r){return read(r)}),u.readBinary=function(r){var n;return"function"==typeof readbuffer?new Uint8Array(readbuffer(r)):(n=read(r,"binary"),x("object"===a()(n)),n)},"undefined"!=typeof scriptArgs?u.arguments=scriptArgs:void 0!==arguments&&(u.arguments=arguments),"function"==typeof quit&&(u.quit=function(r){quit(r)})):(l||h)&&(h?v=self.location.href:document.currentScript&&(v=document.currentScript.src),i&&(v=i),v=0!==v.indexOf("blob:")?v.substr(0,v.lastIndexOf("/")+1):"",u.read=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(null),n.responseText},h&&(u.readBinary=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),u.readAsync=function(r,n,e){var t=new XMLHttpRequest;t.open("GET",r,!0),t.responseType="arraybuffer",t.onload=function(){200==t.status||0==t.status&&t.response?n(t.response):e()},t.onerror=e,t.send(null)},u.setWindowTitle=function(r){document.title=r});var d=u.print||("undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null),y=u.printErr||("undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||d);for(o in c)c.hasOwnProperty(o)&&(u[o]=c[o]);c=void 0;var g,b={"f64-rem":function(r,n){return r%n},debugger:function(){}};new Array(0),"object"!==("undefined"==typeof WebAssembly?"undefined":a()(WebAssembly))&&y("no native wasm support detected");var w=!1;function x(r,n){r||wn("Assertion failed: "+n)}var M,T,A,N,_,k,P,S,I,j="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(r,n,e){for(var t=n+e,i=n;r[i]&&!(i>=t);)++i;if(i-n>16&&r.subarray&&j)return j.decode(r.subarray(n,i));for(var o="";n<i;){var a=r[n++];if(128&a){var u=63&r[n++];if(192!=(224&a)){var c=63&r[n++];if((a=224==(240&a)?(15&a)<<12|u<<6|c:(7&a)<<18|u<<12|c<<6|63&r[n++])<65536)o+=String.fromCharCode(a);else{var s=a-65536;o+=String.fromCharCode(55296|s>>10,56320|1023&s)}}else o+=String.fromCharCode((31&a)<<6|u)}else o+=String.fromCharCode(a)}return o}function C(r,n){return r?E(A,r,n):""}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var F=u.TOTAL_MEMORY||16777216;function O(r){for(;r.length>0;){var n=r.shift();if("function"!=typeof n){var e=n.func;"number"==typeof e?void 0===n.arg?u.dynCall_v(e):u.dynCall_vi(e,n.arg):e(void 0===n.arg?null:n.arg)}else n()}}F<5242880&&y("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+F+"! (TOTAL_STACK=5242880)"),u.buffer?M=u.buffer:"object"===("undefined"==typeof WebAssembly?"undefined":a()(WebAssembly))&&"function"==typeof WebAssembly.Memory?(g=new WebAssembly.Memory({initial:F/65536,maximum:F/65536}),M=g.buffer):M=new ArrayBuffer(F),u.HEAP8=T=new Int8Array(M),u.HEAP16=N=new Int16Array(M),u.HEAP32=k=new Int32Array(M),u.HEAPU8=A=new Uint8Array(M),u.HEAPU16=_=new Uint16Array(M),u.HEAPU32=P=new Uint32Array(M),u.HEAPF32=S=new Float32Array(M),u.HEAPF64=I=new Float64Array(M),k[1072076]=9531216;var q=[],V=[],$=[],D=[],R=!1,L=0,U=null,W=null;u.preloadedImages={},u.preloadedAudios={};var B="data:application/octet-stream;base64,";function Y(r){return String.prototype.startsWith?r.startsWith(B):0===r.indexOf(B)}var Q,X="mvtdstpack.wasm";function H(){try{if(u.wasmBinary)return new Uint8Array(u.wasmBinary);if(u.readBinary)return u.readBinary(X);throw"both async and sync fetching of the wasm failed"}catch(r){wn(r)}}function G(r){var n={env:r,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:b};function e(r,n){var e=r.exports;u.asm=e,function(r){if(L--,u.monitorRunDependencies&&u.monitorRunDependencies(L),0==L&&(null!==U&&(clearInterval(U),U=null),W)){var n=W;W=null,n()}}()}if(L++,u.monitorRunDependencies&&u.monitorRunDependencies(L),u.instantiateWasm)try{return u.instantiateWasm(n,e)}catch(r){return y("Module.instantiateWasm callback failed with error: "+r),!1}function t(r){e(r.instance)}function i(r){(u.wasmBinary||!l&&!h||"function"!=typeof fetch?new Promise(function(r,n){r(H())}):fetch(X,{credentials:"same-origin"}).then(function(r){if(!r.ok)throw"failed to load wasm binary file at '"+X+"'";return r.arrayBuffer()}).catch(function(){return H()})).then(function(r){return WebAssembly.instantiate(r,n)}).then(r,function(r){y("failed to asynchronously prepare wasm: "+r),wn(r)})}return u.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||Y(X)||"function"!=typeof fetch?i(t):WebAssembly.instantiateStreaming(fetch(X,{credentials:"same-origin"}),n).then(t,function(r){y("wasm streaming compile failed: "+r),y("falling back to ArrayBuffer instantiation"),i(t)}),{}}function z(){return!!z.uncaught_exception}Y(X)||(Q=X,X=u.locateFile?u.locateFile(Q,v):v+Q),u.asm=function(r,n,e){return n.memory=g,n.table=new WebAssembly.Table({initial:110,maximum:110,element:"anyfunc"}),n.__memory_base=1024,n.__table_base=0,G(n)},V.push({func:function(){yn()}});var Z={last:0,caught:[],infos:{},deAdjust:function(r){if(!r||Z.infos[r])return r;for(var n in Z.infos)for(var e=+n,t=Z.infos[e].adjusted,i=t.length,o=0;o<i;o++)if(t[o]===r)return e;return r},addRef:function(r){r&&Z.infos[r].refcount++},decRef:function(r){if(r){var n=Z.infos[r];x(n.refcount>0),n.refcount--,0!==n.refcount||n.rethrown||(n.destructor&&u.dynCall_vi(n.destructor,r),delete Z.infos[r],function(r){try{vn(r)}catch(r){}}(r))}},clearRef:function(r){r&&(Z.infos[r].refcount=0)}},K={buffers:[null,[],[]],printChar:function(r,n){var e=K.buffers[r];0===n||10===n?((1===r?d:y)(E(e,0)),e.length=0):e.push(n)},varargs:0,get:function(r){return K.varargs+=4,k[K.varargs-4>>2]},getStr:function(){return C(K.get())},get64:function(){var r=K.get();return K.get(),r},getZero:function(){K.get()}},J={};function rr(r){for(;r.length;){var n=r.pop();r.pop()(n)}}function nr(r){return this.fromWireType(P[r>>2])}var er={},tr={},ir={},or=48,ar=57;function ur(r){if(void 0===r)return"_unknown";var n=(r=r.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return n>=or&&n<=ar?"_"+r:r}function cr(r,n){return r=ur(r),new Function("body","return function "+r+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(n)}function sr(r,n){var e=cr(n,function(r){this.name=n,this.message=r;var e=new Error(r).stack;void 0!==e&&(this.stack=this.toString()+"\n"+e.replace(/^Error(:[^\n]*)?\n/,""))});return e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},e}var fr=void 0;function lr(r){throw new fr(r)}function hr(r,n,e){function t(n){var t=e(n);t.length!==r.length&&lr("Mismatched type converter count");for(var i=0;i<r.length;++i)gr(r[i],t[i])}r.forEach(function(r){ir[r]=n});var i=new Array(n.length),o=[],a=0;n.forEach(function(r,n){tr.hasOwnProperty(r)?i[n]=tr[r]:(o.push(r),er.hasOwnProperty(r)||(er[r]=[]),er[r].push(function(){i[n]=tr[r],++a===o.length&&t(i)}))}),0===o.length&&t(i)}function mr(r){switch(r){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+r)}}var pr=void 0;function vr(r){for(var n="",e=r;A[e];)n+=pr[A[e++]];return n}var dr=void 0;function yr(r){throw new dr(r)}function gr(r,n,e){if(e=e||{},!("argPackAdvance"in n))throw new TypeError("registerType registeredInstance requires argPackAdvance");var t=n.name;if(r||yr('type "'+t+'" must have a positive integer typeid pointer'),tr.hasOwnProperty(r)){if(e.ignoreDuplicateRegistrations)return;yr("Cannot register type '"+t+"' twice")}if(tr[r]=n,delete ir[r],er.hasOwnProperty(r)){var i=er[r];delete er[r],i.forEach(function(r){r()})}}function br(r){if(!(this instanceof Pr))return!1;if(!(r instanceof Pr))return!1;for(var n=this.$$.ptrType.registeredClass,e=this.$$.ptr,t=r.$$.ptrType.registeredClass,i=r.$$.ptr;n.baseClass;)e=n.upcast(e),n=n.baseClass;for(;t.baseClass;)i=t.upcast(i),t=t.baseClass;return n===t&&e===i}function wr(r){yr(r.$$.ptrType.registeredClass.name+" instance already deleted")}function xr(){if(this.$$.ptr||wr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var r,n=Object.create(Object.getPrototypeOf(this),{$$:{value:(r=this.$$,{count:r.count,deleteScheduled:r.deleteScheduled,preservePointerOnDelete:r.preservePointerOnDelete,ptr:r.ptr,ptrType:r.ptrType,smartPtr:r.smartPtr,smartPtrType:r.smartPtrType})}});return n.$$.count.value+=1,n.$$.deleteScheduled=!1,n}function Mr(){var r;this.$$.ptr||wr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&yr("Object already scheduled for deletion"),this.$$.count.value-=1,0===this.$$.count.value&&((r=this.$$).smartPtr?r.smartPtrType.rawDestructor(r.smartPtr):r.ptrType.registeredClass.rawDestructor(r.ptr)),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Tr(){return!this.$$.ptr}var Ar=void 0,Nr=[];function _r(){for(;Nr.length;){var r=Nr.pop();r.$$.deleteScheduled=!1,r.delete()}}function kr(){return this.$$.ptr||wr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&yr("Object already scheduled for deletion"),Nr.push(this),1===Nr.length&&Ar&&Ar(_r),this.$$.deleteScheduled=!0,this}function Pr(){}var Sr={};function Ir(r,n,e){if(void 0===r[n].overloadTable){var t=r[n];r[n]=function(){return r[n].overloadTable.hasOwnProperty(arguments.length)||yr("Function '"+e+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+r[n].overloadTable+")!"),r[n].overloadTable[arguments.length].apply(this,arguments)},r[n].overloadTable=[],r[n].overloadTable[t.argCount]=t}}function jr(r,n,e){u.hasOwnProperty(r)?((void 0===e||void 0!==u[r].overloadTable&&void 0!==u[r].overloadTable[e])&&yr("Cannot register public name '"+r+"' twice"),Ir(u,r,r),u.hasOwnProperty(e)&&yr("Cannot register multiple overloads of a function with the same number of arguments ("+e+")!"),u[r].overloadTable[e]=n):(u[r]=n,void 0!==e&&(u[r].numArguments=e))}function Er(r,n,e,t,i,o,a,u){this.name=r,this.constructor=n,this.instancePrototype=e,this.rawDestructor=t,this.baseClass=i,this.getActualType=o,this.upcast=a,this.downcast=u,this.pureVirtualFunctions=[]}function Cr(r,n,e){for(;n!==e;)n.upcast||yr("Expected null or instance of "+e.name+", got an instance of "+n.name),r=n.upcast(r),n=n.baseClass;return r}function Fr(r,n){if(null===n)return this.isReference&&yr("null is not a valid "+this.name),0;n.$$||yr('Cannot pass "'+cn(n)+'" as a '+this.name),n.$$.ptr||yr("Cannot pass deleted object as a pointer of type "+this.name);var e=n.$$.ptrType.registeredClass;return Cr(n.$$.ptr,e,this.registeredClass)}function Or(r,n){var e;if(null===n)return this.isReference&&yr("null is not a valid "+this.name),this.isSmartPointer?(e=this.rawConstructor(),null!==r&&r.push(this.rawDestructor,e),e):0;n.$$||yr('Cannot pass "'+cn(n)+'" as a '+this.name),n.$$.ptr||yr("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&n.$$.ptrType.isConst&&yr("Cannot convert argument of type "+(n.$$.smartPtrType?n.$$.smartPtrType.name:n.$$.ptrType.name)+" to parameter type "+this.name);var t=n.$$.ptrType.registeredClass;if(e=Cr(n.$$.ptr,t,this.registeredClass),this.isSmartPointer)switch(void 0===n.$$.smartPtr&&yr("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:n.$$.smartPtrType===this?e=n.$$.smartPtr:yr("Cannot convert argument of type "+(n.$$.smartPtrType?n.$$.smartPtrType.name:n.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:e=n.$$.smartPtr;break;case 2:if(n.$$.smartPtrType===this)e=n.$$.smartPtr;else{var i=n.clone();e=this.rawShare(e,un(function(){i.delete()})),null!==r&&r.push(this.rawDestructor,e)}break;default:yr("Unsupporting sharing policy")}return e}function qr(r,n){if(null===n)return this.isReference&&yr("null is not a valid "+this.name),0;n.$$||yr('Cannot pass "'+cn(n)+'" as a '+this.name),n.$$.ptr||yr("Cannot pass deleted object as a pointer of type "+this.name),n.$$.ptrType.isConst&&yr("Cannot convert argument of type "+n.$$.ptrType.name+" to parameter type "+this.name);var e=n.$$.ptrType.registeredClass;return Cr(n.$$.ptr,e,this.registeredClass)}function Vr(r){return this.rawGetPointee&&(r=this.rawGetPointee(r)),r}function $r(r){this.rawDestructor&&this.rawDestructor(r)}function Dr(r){null!==r&&r.delete()}function Rr(){return Object.keys(Wr).length}function Lr(){var r=[];for(var n in Wr)Wr.hasOwnProperty(n)&&r.push(Wr[n]);return r}function Ur(r){Ar=r,Nr.length&&Ar&&Ar(_r)}var Wr={};function Br(r,n){return n=function(r,n){for(void 0===n&&yr("ptr should not be undefined");r.baseClass;)n=r.upcast(n),r=r.baseClass;return n}(r,n),Wr[n]}function Yr(r,n){return n.ptrType&&n.ptr||lr("makeClassHandle requires ptr and ptrType"),!!n.smartPtrType!=!!n.smartPtr&&lr("Both smartPtrType and smartPtr must be specified"),n.count={value:1},Object.create(r,{$$:{value:n}})}function Qr(r){var n=this.getPointee(r);if(!n)return this.destructor(r),null;var e=Br(this.registeredClass,n);if(void 0!==e){if(0===e.$$.count.value)return e.$$.ptr=n,e.$$.smartPtr=r,e.clone();var t=e.clone();return this.destructor(r),t}function i(){return this.isSmartPointer?Yr(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:n,smartPtrType:this,smartPtr:r}):Yr(this.registeredClass.instancePrototype,{ptrType:this,ptr:r})}var o,a=this.registeredClass.getActualType(n),u=Sr[a];if(!u)return i.call(this);o=this.isConst?u.constPointerType:u.pointerType;var c=function r(n,e,t){if(e===t)return n;if(void 0===t.baseClass)return null;var i=r(n,e,t.baseClass);return null===i?null:t.downcast(i)}(n,this.registeredClass,o.registeredClass);return null===c?i.call(this):this.isSmartPointer?Yr(o.registeredClass.instancePrototype,{ptrType:o,ptr:c,smartPtrType:this,smartPtr:r}):Yr(o.registeredClass.instancePrototype,{ptrType:o,ptr:c})}function Xr(r,n,e,t,i,o,a,u,c,s,f){this.name=r,this.registeredClass=n,this.isReference=e,this.isConst=t,this.isSmartPointer=i,this.pointeeType=o,this.sharingPolicy=a,this.rawGetPointee=u,this.rawConstructor=c,this.rawShare=s,this.rawDestructor=f,i||void 0!==n.baseClass?this.toWireType=Or:t?(this.toWireType=Fr,this.destructorFunction=null):(this.toWireType=qr,this.destructorFunction=null)}function Hr(r,n,e){u.hasOwnProperty(r)||lr("Replacing nonexistant public symbol"),void 0!==u[r].overloadTable&&void 0!==e?u[r].overloadTable[e]=n:(u[r]=n,u[r].argCount=e)}function Gr(r,n){var e;if(r=vr(r),void 0!==u["FUNCTION_TABLE_"+r])e=u["FUNCTION_TABLE_"+r][n];else if("undefined"!=typeof FUNCTION_TABLE)e=FUNCTION_TABLE[n];else{var t=u["dynCall_"+r];void 0===t&&void 0===(t=u["dynCall_"+r.replace(/f/g,"d")])&&yr("No dynCall invoker for signature: "+r),e=function(e){for(var t=[],i=1;i<r.length;++i)t.push("a"+i);var o="return function dynCall_"+r+"_"+n+"("+t.join(", ")+") {\n";return o+="    return dynCall(rawFunction"+(t.length?", ":"")+t.join(", ")+");\n",o+="};\n",new Function("dynCall","rawFunction",o)(e,n)}(t)}return"function"!=typeof e&&yr("unknown function pointer with signature "+r+": "+n),e}var zr=void 0;function Zr(r){var n=pn(r),e=vr(n);return vn(n),e}function Kr(r,n){var e=[],t={};throw n.forEach(function r(n){t[n]||tr[n]||(ir[n]?ir[n].forEach(r):(e.push(n),t[n]=!0))}),new zr(r+": "+e.map(Zr).join([", "]))}function Jr(r,n){for(var e=[],t=0;t<r;t++)e.push(k[(n>>2)+t]);return e}function rn(r,n,e,t,i){var o=n.length;o<2&&yr("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var u=null!==n[1]&&null!==e,c=!1,s=1;s<n.length;++s)if(null!==n[s]&&void 0===n[s].destructorFunction){c=!0;break}var f="void"!==n[0].name,l="",h="";for(s=0;s<o-2;++s)l+=(0!==s?", ":"")+"arg"+s,h+=(0!==s?", ":"")+"arg"+s+"Wired";var m="return function "+ur(r)+"("+l+") {\nif (arguments.length !== "+(o-2)+") {\nthrowBindingError('function "+r+" called with ' + arguments.length + ' arguments, expected "+(o-2)+" args!');\n}\n";c&&(m+="var destructors = [];\n");var p=c?"destructors":"null",v=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],d=[yr,t,i,rr,n[0],n[1]];for(u&&(m+="var thisWired = classParam.toWireType("+p+", this);\n"),s=0;s<o-2;++s)m+="var arg"+s+"Wired = argType"+s+".toWireType("+p+", arg"+s+"); // "+n[s+2].name+"\n",v.push("argType"+s),d.push(n[s+2]);if(u&&(h="thisWired"+(h.length>0?", ":"")+h),m+=(f?"var rv = ":"")+"invoker(fn"+(h.length>0?", ":"")+h+");\n",c)m+="runDestructors(destructors);\n";else for(s=u?1:2;s<n.length;++s){var y=1===s?"thisWired":"arg"+(s-2)+"Wired";null!==n[s].destructorFunction&&(m+=y+"_dtor("+y+"); // "+n[s].name+"\n",v.push(y+"_dtor"),d.push(n[s].destructorFunction))}return f&&(m+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),m+="}\n",v.push(m),function(r,n){if(!(r instanceof Function))throw new TypeError("new_ called with constructor type "+a()(r)+" which is not a function");var e=cr(r.name||"unknownFunctionName",function(){});e.prototype=r.prototype;var t=new e,i=r.apply(t,n);return i instanceof Object?i:t}(Function,v).apply(null,d)}var nn=[],en=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function tn(r){r>4&&0==--en[r].refcount&&(en[r]=void 0,nn.push(r))}function on(){for(var r=0,n=5;n<en.length;++n)void 0!==en[n]&&++r;return r}function an(){for(var r=5;r<en.length;++r)if(void 0!==en[r])return en[r];return null}function un(r){switch(r){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var n=nn.length?nn.pop():en.length;return en[n]={refcount:1,value:r},n}}function cn(r){if(null===r)return"null";var n=a()(r);return"object"===n||"array"===n||"function"===n?r.toString():""+r}function sn(r,n){switch(n){case 2:return function(r){return this.fromWireType(S[r>>2])};case 3:return function(r){return this.fromWireType(I[r>>3])};default:throw new TypeError("Unknown float type: "+r)}}function fn(r,n,e){switch(n){case 0:return e?function(r){return T[r]}:function(r){return A[r]};case 1:return e?function(r){return N[r>>1]}:function(r){return _[r>>1]};case 2:return e?function(r){return k[r>>2]}:function(r){return P[r>>2]};default:throw new TypeError("Unknown integer type: "+r)}}function ln(r){wn("OOM")}fr=u.InternalError=sr(Error,"InternalError"),function(){for(var r=new Array(256),n=0;n<256;++n)r[n]=String.fromCharCode(n);pr=r}(),dr=u.BindingError=sr(Error,"BindingError"),Pr.prototype.isAliasOf=br,Pr.prototype.clone=xr,Pr.prototype.delete=Mr,Pr.prototype.isDeleted=Tr,Pr.prototype.deleteLater=kr,Xr.prototype.getPointee=Vr,Xr.prototype.destructor=$r,Xr.prototype.argPackAdvance=8,Xr.prototype.readValueFromPointer=nr,Xr.prototype.deleteObject=Dr,Xr.prototype.fromWireType=Qr,u.getInheritedInstanceCount=Rr,u.getLiveInheritedInstances=Lr,u.flushPendingDeletes=_r,u.setDelayFunction=Ur,zr=u.UnboundTypeError=sr(Error,"UnboundTypeError"),u.count_emval_handles=on,u.get_first_emval=an;var hn={b:wn,u:function(r){},p:function(r){return dn(r)},l:function(r,n,e){throw Z.infos[r]={ptr:r,adjusted:[r],type:n,destructor:e,refcount:0,caught:!1,rethrown:!1},Z.last=r,"uncaught_exception"in z?z.uncaught_exception++:z.uncaught_exception=1,r},i:function(r){return u.___errno_location&&(k[u.___errno_location()>>2]=r),r},t:function(r,n){K.varargs=n;try{return K.getStreamFromFD(),K.get(),K.get(),K.get(),K.get(),0}catch(r){return"undefined"!=typeof FS&&r instanceof FS.ErrnoError||wn(r),-r.errno}},h:function(r,n){K.varargs=n;try{for(var e=K.get(),t=K.get(),i=K.get(),o=0,a=0;a<i;a++){for(var u=k[t+8*a>>2],c=k[t+(8*a+4)>>2],s=0;s<c;s++)K.printChar(e,A[u+s]);o+=c}return o}catch(r){return"undefined"!=typeof FS&&r instanceof FS.ErrnoError||wn(r),-r.errno}},s:function(r,n){K.varargs=n;try{return K.getStreamFromFD(),0}catch(r){return"undefined"!=typeof FS&&r instanceof FS.ErrnoError||wn(r),-r.errno}},r:function(r){var n=J[r];delete J[r];var e=n.rawConstructor,t=n.rawDestructor,i=n.fields;hr([r],i.map(function(r){return r.getterReturnType}).concat(i.map(function(r){return r.setterArgumentType})),function(r){var o={};return i.forEach(function(n,e){var t=n.fieldName,a=r[e],u=n.getter,c=n.getterContext,s=r[e+i.length],f=n.setter,l=n.setterContext;o[t]={read:function(r){return a.fromWireType(u(c,r))},write:function(r,n){var e=[];f(l,r,s.toWireType(e,n)),rr(e)}}}),[{name:n.name,fromWireType:function(r){var n={};for(var e in o)n[e]=o[e].read(r);return t(r),n},toWireType:function(r,n){for(var i in o)if(!(i in n))throw new TypeError("Missing field");var a=e();for(i in o)o[i].write(a,n[i]);return null!==r&&r.push(t,a),a},argPackAdvance:8,readValueFromPointer:nr,destructorFunction:t}]})},q:function(r,n,e,t,i){var o=mr(e);gr(r,{name:n=vr(n),fromWireType:function(r){return!!r},toWireType:function(r,n){return n?t:i},argPackAdvance:8,readValueFromPointer:function(r){var t;if(1===e)t=T;else if(2===e)t=N;else{if(4!==e)throw new TypeError("Unknown boolean type size: "+n);t=k}return this.fromWireType(t[r>>o])},destructorFunction:null})},g:function(r,n,e,t,i,o,a,u,c,s,f,l,h){f=vr(f),o=Gr(i,o),u&&(u=Gr(a,u)),s&&(s=Gr(c,s)),h=Gr(l,h);var m=ur(f);jr(m,function(){Kr("Cannot construct "+f+" due to unbound types",[t])}),hr([r,n,e],t?[t]:[],function(n){var e,i;n=n[0],i=t?(e=n.registeredClass).instancePrototype:Pr.prototype;var a=cr(m,function(){if(Object.getPrototypeOf(this)!==c)throw new dr("Use 'new' to construct "+f);if(void 0===l.constructor_body)throw new dr(f+" has no accessible constructor");var r=l.constructor_body[arguments.length];if(void 0===r)throw new dr("Tried to invoke ctor of "+f+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(l.constructor_body).toString()+") parameters instead!");return r.apply(this,arguments)}),c=Object.create(i,{constructor:{value:a}});a.prototype=c;var l=new Er(f,a,c,h,e,o,u,s),p=new Xr(f,l,!0,!1,!1),v=new Xr(f+"*",l,!1,!1,!1),d=new Xr(f+" const*",l,!1,!0,!1);return Sr[r]={pointerType:v,constPointerType:d},Hr(m,a),[p,v,d]})},o:function(r,n,e,t,i,o){var a=Jr(n,e);i=Gr(t,i),hr([],[r],function(r){var e="constructor "+(r=r[0]).name;if(void 0===r.registeredClass.constructor_body&&(r.registeredClass.constructor_body=[]),void 0!==r.registeredClass.constructor_body[n-1])throw new dr("Cannot register multiple constructors with identical number of parameters ("+(n-1)+") for class '"+r.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return r.registeredClass.constructor_body[n-1]=function(){Kr("Cannot construct "+r.name+" due to unbound types",a)},hr([],a,function(t){return r.registeredClass.constructor_body[n-1]=function(){arguments.length!==n-1&&yr(e+" called with "+arguments.length+" arguments, expected "+(n-1));var r=[],a=new Array(n);a[0]=o;for(var u=1;u<n;++u)a[u]=t[u].toWireType(r,arguments[u-1]);var c=i.apply(null,a);return rr(r),t[0].fromWireType(c)},[]}),[]})},d:function(r,n,e,t,i,o,a,u){var c=Jr(e,t);n=vr(n),o=Gr(i,o),hr([],[r],function(r){var t=(r=r[0]).name+"."+n;function i(){Kr("Cannot call "+t+" due to unbound types",c)}u&&r.registeredClass.pureVirtualFunctions.push(n);var s=r.registeredClass.instancePrototype,f=s[n];return void 0===f||void 0===f.overloadTable&&f.className!==r.name&&f.argCount===e-2?(i.argCount=e-2,i.className=r.name,s[n]=i):(Ir(s,n,t),s[n].overloadTable[e-2]=i),hr([],c,function(i){var u=rn(t,i,r,o,a);return void 0===s[n].overloadTable?(u.argCount=e-2,s[n]=u):s[n].overloadTable[e-2]=u,[]}),[]})},F:function(r,n){gr(r,{name:n=vr(n),fromWireType:function(r){var n=en[r].value;return tn(r),n},toWireType:function(r,n){return un(n)},argPackAdvance:8,readValueFromPointer:nr,destructorFunction:null})},n:function(r,n,e){var t=mr(e);gr(r,{name:n=vr(n),fromWireType:function(r){return r},toWireType:function(r,n){if("number"!=typeof n&&"boolean"!=typeof n)throw new TypeError('Cannot convert "'+cn(n)+'" to '+this.name);return n},argPackAdvance:8,readValueFromPointer:sn(n,t),destructorFunction:null})},E:function(r,n,e,t,i,o){var a=Jr(n,e);r=vr(r),i=Gr(t,i),jr(r,function(){Kr("Cannot call "+r+" due to unbound types",a)},n-1),hr([],a,function(e){var t=[e[0],null].concat(e.slice(1));return Hr(r,rn(r,t,null,i,o),n-1),[]})},e:function(r,n,e,t,i){n=vr(n),-1===i&&(i=4294967295);var o=mr(e),a=function(r){return r};if(0===t){var u=32-8*e;a=function(r){return r<<u>>>u}}var c=-1!=n.indexOf("unsigned");gr(r,{name:n,fromWireType:a,toWireType:function(r,e){if("number"!=typeof e&&"boolean"!=typeof e)throw new TypeError('Cannot convert "'+cn(e)+'" to '+this.name);if(e<t||e>i)throw new TypeError('Passing a number "'+cn(e)+'" from JS side to C/C++ side to an argument of type "'+n+'", which is outside the valid range ['+t+", "+i+"]!");return c?e>>>0:0|e},argPackAdvance:8,readValueFromPointer:fn(n,o,0!==t),destructorFunction:null})},c:function(r,n,e){var t=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][n];function i(r){var n=P,e=n[r>>=2],i=n[r+1];return new t(n.buffer,i,e)}gr(r,{name:e=vr(e),fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},m:function(r,n){var e="std::string"===(n=vr(n));gr(r,{name:n,fromWireType:function(r){var n,t=P[r>>2];if(e){var i=A[r+4+t],o=0;0!=i&&(o=i,A[r+4+t]=0);for(var a=r+4,u=0;u<=t;++u){var c=r+4+u;if(0==A[c]){var s=C(a);void 0===n?n=s:(n+=String.fromCharCode(0),n+=s),a=c+1}}0!=o&&(A[r+4+t]=o)}else{var f=new Array(t);for(u=0;u<t;++u)f[u]=String.fromCharCode(A[r+4+u]);n=f.join("")}return vn(r),n},toWireType:function(r,n){n instanceof ArrayBuffer&&(n=new Uint8Array(n));var t="string"==typeof n;t||n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Int8Array||yr("Cannot pass non-string to std::string");var i=(e&&t?function(){return function(r){for(var n=0,e=0;e<r.length;++e){var t=r.charCodeAt(e);t>=55296&&t<=57343&&(t=65536+((1023&t)<<10)|1023&r.charCodeAt(++e)),t<=127?++n:n+=t<=2047?2:t<=65535?3:4}return n}(n)}:function(){return n.length})(),o=dn(4+i+1);if(P[o>>2]=i,e&&t)!function(r,n,e,t){if(!(t>0))return 0;for(var i=e+t-1,o=0;o<r.length;++o){var a=r.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&r.charCodeAt(++o)),a<=127){if(e>=i)break;n[e++]=a}else if(a<=2047){if(e+1>=i)break;n[e++]=192|a>>6,n[e++]=128|63&a}else if(a<=65535){if(e+2>=i)break;n[e++]=224|a>>12,n[e++]=128|a>>6&63,n[e++]=128|63&a}else{if(e+3>=i)break;n[e++]=240|a>>18,n[e++]=128|a>>12&63,n[e++]=128|a>>6&63,n[e++]=128|63&a}}n[e]=0}(n,A,o+4,i+1);else if(t)for(var a=0;a<i;++a){var u=n.charCodeAt(a);u>255&&(vn(o),yr("String has UTF-16 code units that do not fit in 8 bits")),A[o+4+a]=u}else for(a=0;a<i;++a)A[o+4+a]=n[a];return null!==r&&r.push(vn,o),o},argPackAdvance:8,readValueFromPointer:nr,destructorFunction:function(r){vn(r)}})},D:function(r,n,e){var t,i;e=vr(e),2===n?(t=function(){return _},i=1):4===n&&(t=function(){return P},i=2),gr(r,{name:e,fromWireType:function(r){for(var n=t(),e=P[r>>2],o=new Array(e),a=r+4>>i,u=0;u<e;++u)o[u]=String.fromCharCode(n[a+u]);return vn(r),o.join("")},toWireType:function(r,e){var o=t(),a=e.length,u=dn(4+a*n);P[u>>2]=a;for(var c=u+4>>i,s=0;s<a;++s)o[c+s]=e.charCodeAt(s);return null!==r&&r.push(vn,u),u},argPackAdvance:8,readValueFromPointer:nr,destructorFunction:function(r){vn(r)}})},C:function(r,n,e,t,i,o){J[r]={name:vr(n),rawConstructor:Gr(e,t),rawDestructor:Gr(i,o),fields:[]}},k:function(r,n,e,t,i,o,a,u,c,s){J[r].fields.push({fieldName:vr(n),getterReturnType:e,getter:Gr(t,i),getterContext:o,setterArgumentType:a,setter:Gr(u,c),setterContext:s})},B:function(r,n){gr(r,{isVoid:!0,name:n=vr(n),argPackAdvance:0,fromWireType:function(){},toWireType:function(r,n){}})},A:tn,z:function(r){r>4&&(en[r].refcount+=1)},j:function(r,n){var e,t,i;return t="_emval_take_value",void 0===(i=tr[e=r])&&yr(t+" has unknown type "+Zr(e)),un((r=i).readValueFromPointer(n))},f:function(){u.abort()},y:function(){return T.length},x:function(r,n,e){A.set(A.subarray(n,n+e),r)},w:function(r){ln()},v:ln,a:4288304},mn=u.asm({},hn,M);u.asm=mn,u.___errno_location=function(){return u.asm.G.apply(null,arguments)};var pn=u.___getTypeName=function(){return u.asm.H.apply(null,arguments)},vn=u._free=function(){return u.asm.I.apply(null,arguments)},dn=u._malloc=function(){return u.asm.J.apply(null,arguments)},yn=u.globalCtors=function(){return u.asm.ca.apply(null,arguments)};function gn(r){this.name="ExitStatus",this.message="Program terminated with exit("+r+")",this.status=r}function bn(r){function n(){u.calledRun||(u.calledRun=!0,w||(R||(R=!0,O(V)),O($),u.onRuntimeInitialized&&u.onRuntimeInitialized(),function(){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;)r=u.postRun.shift(),D.unshift(r);var r;O(D)}()))}r=r||u.arguments,L>0||(function(){if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)r=u.preRun.shift(),q.unshift(r);var r;O(q)}(),L>0||u.calledRun||(u.setStatus?(u.setStatus("Running..."),setTimeout(function(){setTimeout(function(){u.setStatus("")},1),n()},1)):n()))}function wn(r){throw u.onAbort&&u.onAbort(r),void 0!==r?(d(r),y(r),r=JSON.stringify(r)):r="",w=!0,"abort("+r+"). Build with -s ASSERTIONS=1 for more info."}if(u.dynCall_dii=function(){return u.asm.K.apply(null,arguments)},u.dynCall_i=function(){return u.asm.L.apply(null,arguments)},u.dynCall_ii=function(){return u.asm.M.apply(null,arguments)},u.dynCall_iidiiii=function(){return u.asm.N.apply(null,arguments)},u.dynCall_iii=function(){return u.asm.O.apply(null,arguments)},u.dynCall_iiii=function(){return u.asm.P.apply(null,arguments)},u.dynCall_iiiid=function(){return u.asm.Q.apply(null,arguments)},u.dynCall_iiiii=function(){return u.asm.R.apply(null,arguments)},u.dynCall_iiiiiiiiiidd=function(){return u.asm.S.apply(null,arguments)},u.dynCall_jiji=function(){return u.asm.T.apply(null,arguments)},u.dynCall_v=function(){return u.asm.U.apply(null,arguments)},u.dynCall_vi=function(){return u.asm.V.apply(null,arguments)},u.dynCall_vii=function(){return u.asm.W.apply(null,arguments)},u.dynCall_viid=function(){return u.asm.X.apply(null,arguments)},u.dynCall_viii=function(){return u.asm.Y.apply(null,arguments)},u.dynCall_viiid=function(){return u.asm.Z.apply(null,arguments)},u.dynCall_viiii=function(){return u.asm._.apply(null,arguments)},u.dynCall_viiiii=function(){return u.asm.$.apply(null,arguments)},u.dynCall_viiiiii=function(){return u.asm.aa.apply(null,arguments)},u.dynCall_viiiiiiiiidd=function(){return u.asm.ba.apply(null,arguments)},u.asm=mn,u.then=function(r){if(u.calledRun)r(u);else{var n=u.onRuntimeInitialized;u.onRuntimeInitialized=function(){n&&n(),r(u)}}return u},gn.prototype=new Error,gn.prototype.constructor=gn,W=function r(){u.calledRun||bn(),u.calledRun||(W=r)},u.run=bn,u.abort=wn,u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();return u.noExitRuntime=!0,bn(),n});n.a=u}).call(this,e(20),"/")},function(r,n){r.exports=function(r){if(Array.isArray(r)){for(var n=0,e=new Array(r.length);n<r.length;n++)e[n]=r[n];return e}}},function(r,n){r.exports=function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}},function(r,n){r.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(r,n){r.exports=function(r){if(Array.isArray(r))return r}},function(r,n){r.exports=function(r,n){var e=[],t=!0,i=!1,o=void 0;try{for(var a,u=r[Symbol.iterator]();!(t=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);t=!0);}catch(r){i=!0,o=r}finally{try{t||null==u.return||u.return()}finally{if(i)throw o}}return e}},function(r,n){r.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(r,n){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(r){"object"==typeof window&&(e=window)}r.exports=e},function(r,n){r.exports=function(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}},function(r,n){function e(n,t){return r.exports=e=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},e(n,t)}r.exports=e},function(r,n){var e,t,i=r.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(r){if(e===setTimeout)return setTimeout(r,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(r,0);try{return e(r,0)}catch(n){try{return e.call(null,r,0)}catch(n){return e.call(this,r,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(r){e=o}try{t="function"==typeof clearTimeout?clearTimeout:a}catch(r){t=a}}();var c,s=[],f=!1,l=-1;function h(){f&&c&&(f=!1,c.length?s=c.concat(s):l=-1,s.length&&m())}function m(){if(!f){var r=u(h);f=!0;for(var n=s.length;n;){for(c=s,s=[];++l<n;)c&&c[l].run();l=-1,n=s.length}c=null,f=!1,function(r){if(t===clearTimeout)return clearTimeout(r);if((t===a||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(r);try{t(r)}catch(n){try{return t.call(null,r)}catch(n){return t.call(this,r)}}}(r)}}function p(r,n){this.fun=r,this.array=n}function v(){}i.nextTick=function(r){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];s.push(new p(r,n)),1!==s.length||f||u(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(r){return[]},i.binding=function(r){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(r){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(r,n,e){"use strict";e.r(n);var t={};e.r(t),e.d(t,"_AggregationTest",function(){return Qn}),e.d(t,"_get_conditional_dist",function(){return Bn}),e.d(t,"SkatTest",function(){return zn}),e.d(t,"SkatOptimalTest",function(){return te}),e.d(t,"ZegginiBurdenTest",function(){return Xn}),e.d(t,"VTTest",function(){return Gn}),e.d(t,"MVT_WASM_HELPERS",function(){return Ln}),e.d(t,"calculate_mvt_pvalue",function(){return Yn}),e.d(t,"_skatDavies",function(){return Zn}),e.d(t,"_skatLiu",function(){return Kn});var i={};e.r(i),e.d(i,"_PortalVariantsHelper",function(){return ae}),e.d(i,"_PortalGroupHelper",function(){return ue}),e.d(i,"parsePortalJSON",function(){return se}),e.d(i,"PortalTestRunner",function(){return ce}),e.d(i,"AGGREGATION_TESTS",function(){return oe});var o=e(5),a=e.n(o),u=e(1),c=e.n(u),s=e(2),f=e.n(s),l=e(3),h=e.n(l),m=e(0),p=e.n(m),v=new RegExp("(?:chr)?(.+):(\\d+)_?(\\w+)?/?([^_]+)?_?(.*)?"),d=(new RegExp("(?:chr)?(.+):(\\d+)-(\\d+)"),e(6)),y=e.n(d),g=e(7),b=e.n(g),w=e(8),x=e.n(w);function M(r){for(var n=r.length,e=p.a.rep([n,n],0),t=0;t<n;t++)for(var i=0;i<=t;i++){for(var o=r[i][t],a=0;a<=i-1;a++)o-=e[i][a]*e[t][a];i<t?e[t][i]=o/e[i][i]:e[t][t]=Math.sqrt(o)}return e}var T,A,N,_,k,P,S,I,j,E,C,F,O,q,V,$=e(10),D=Math.PI,R=.0866,L=0;function U(r){return r<-50?0:Math.exp(r)}function W(){if((L+=1)>j)throw new RangeError("Exceeded limit of "+j+" calls")}function B(r){return r*r}function Y(r,n){if(Math.abs(r)>.1)return n?Math.log(1+r):Math.log(1+r)-r;var e,t,i,o,a;for(i=2*function(r){return r*r*r}(o=r/(2+r)),a=3,e=(n?2:-r)*o,o=B(o),t=e+i/a;t!==e;t=e+i/a)a+=2,i*=o,e=t;return e}function Q(r){var n,e,t,i,o,a,u,c;for(W(),n=r*(a=r*T),r*=2,u=I-1;u>=0;u--)c=F[u],a+=(e=q[u])*((t=V[u])/(o=1-(i=r*e))+c)/o,n=n+t*B(i/o)+c*(B(i)/o+Y(-i,!1));return[U(-.5*n),a]}function X(r,n){var e,t,i,o,a,u,s;function f(r){var n=Q(r),e=c()(n,2);return s=e[0],u=e[1],s}for(e=0,a=_,t=n/(1+n*(i=2*(n>0?A:N)));f(t)>r;t=n/(1+n*i))e=n,a=u,n*=2;for(t=(a-_)/(u-_);t<.9;t=(a-_)/(u-_)){var l=Q((t=(e+n)/2)/(1+t*i)),h=c()(l,2);s=h[0],o=h[1],s>r?(e=t,a=o):(n=t,u=o)}return[u,n]}function H(r,n){var e,t,i,o,a,u,c,s,f,l,h,m,p,v;for(W(),e=0,o=0,a=0,v=0,i=2*(t=(T+n)*B(r)),r*=2,m=0;m<I;m++)u=q[m],c=V[m],p=F[m],e+=c*(s=B(r*u))/(1+s),s>1?(o+=p*Math.log(s),a+=p*Y(s,!0),v+=p):i+=p*Y(s,!0);return a=i+a,s=U(-(e*=.5)-.25*(o=i+o))/D,f=U(-e-.25*a)/D,(h=a>1?2.5*f:1)<(l=0==v?1:2*s/v)&&(l=h),l<(h=(s=.5*t)<=f?1:f/s)?l:h}function G(r,n){var e,t,i=[2,1.4,1.2,1.1];if(H(e=r/4,0)>n)for(e=r;H(e,0)>n;e=r)r*=4;else for(r=e,e/=4;H(e,0)<=n;e/=4)r=e;for(t=0;t<4;t++)H(e=r/i[t],0)<=n&&(r=e);return r}function z(r,n,e,t){var i,o,a,u,c,s,f,l,h,m,p;for(i=n/D,h=r;h>=0;h--){for(a=-2*(o=(h+.5)*n)*k,u=Math.abs(a),c=-.5*T*B(o),m=I-1;m>=0;m--)c-=.25*(p=F[m])*Y(f=B(s=2*q[m]*o),!0),f=V[m]*s/(1+f),a+=l=p*Math.atan(s)+f,u+=Math.abs(l),c-=.5*s*f;s=i*U(c)/o,t||(s*=1-U(-.5*e*B(o))),a=Math.sin(.5*a)*s,P+=a,S+=u=.5*u*s}}function Z(r){var n,e,t,i,o,a,u,c,s;for(W(),E&&function(){r:for(var r=0;r<I;r++){for(var n=Math.abs(q[r]),e=r-1;e>=0;e--){if(!(n>Math.abs(q[O[e]]))){O[e+1]=r;continue r}O[e+1]=O[e]}O[0]=r}E=!1}(),n=Math.abs(r),i=r>0?1:-1,o=0,u=I-1;u>=0;u--)if(s=O[u],q[s]*i>0){if(!((e=n-(a=Math.abs(q[s]))*(F[s]+V[s]))>(t=a/R))){for(e>t&&(n=t),o=(n-e)/a,c=u-1;c>=0;c--)o+=F[O[c]]+V[O[c]];break}n=e}return o>100?(C=!0,1):Math.pow(2,o/4)/(D*B(n))}function K(r,n,e,t,i,o,a,u){var s,f,l,h,m,p,v,d,y,g,b,w,x,M,$,R,U,W,Y,Q,K,J,rr,nr=new Array(7).fill(0),er=[1,2,4,8];function tr(){return nr[6]=L,[J,rr,nr]}for(L=0,I=t,k=o,F=e,q=r,V=n,rr=0,P=0,S=0,J=-1,m=u,E=!0,C=!1,v=j=a,O=new Array(I).fill(NaN),w=T=B(i),A=0,N=0,_=0,s=0;s<I;s++){if(f=F[s],Q=q[s],K=V[s],f<0||K<0)return rr=3,tr();w+=B(Q)*(2*f+4*K),_+=Q*(f+K),A<Q?A=Q:N>Q&&(N=Q)}if(0==w)return J=k>0?1:0,tr();if(0==N&&0==A&&0==i)return rr=3,tr();w=Math.sqrt(w),p=A<-N?-N:A,g=16/w,U=-(R=4.5/w);try{var ir,or=function(){if(nr[3]=x,d>v)return rr=1,tr();for(z(l=Math.floor(d+.5),x,0,!0),nr[2]=nr[2]+1,nr[1]=nr[1]+l+1,J=.5-P,nr[0]=S,$=(R=S)+u/10,s=0;s<4;s++)er[s]*$==er[s]*R&&(rr=2);return tr()};return g=G(g,.5*m),0!=k&&p>.07*w&&(b=.25*m/Z(k),C?C=!1:H(g,b)<.2*m&&(T+=b,g=G(g,.25*m),nr[5]=Math.sqrt(b))),nr[4]=g,m*=.5,function r(){var n=X(m,R),e=c()(n,2);if(ir=e[0],R=e[1],(W=ir-k)<0)return J=1,tr();var t=X(m,U),i=c()(t,2);return ir=i[0],U=i[1],(Y=k-ir)<0?(J=0,tr()):(d=g/(x=2*D/(W>Y?W:Y)),y=3/Math.sqrt(m),d>1.5*y?y>v?(rr=1,tr()):(h=Math.floor(y+.5),($=2*D/(M=g/h))<=Math.abs(k)?or():(b=.33*m/(1.1*(Z(k-$)+Z(k+$))),C?or():(m*=.67,z(h,M,b,!1),v-=y,T+=b,nr[2]=nr[2]+1,nr[1]=nr[1]+h+1,g=G(g,.25*m),m*=.75,r()))):or())}()}catch(r){if("RangeError"===r.name)return rr=4,tr();throw r}}var J={21:[0,.14887433898163122,.2943928627014602,.4333953941292472,.5627571346686047,.6794095682990244,.7808177265864169,.8650633666889845,.9301574913557082,.9739065285171717,.9956571630258081],31:[0,.1011420669187175,.20119409399743451,.29918000715316884,.3941513470775634,.4850818636402397,.5709721726085388,.650996741297417,.7244177313601701,.790418501442466,.8482065834104272,.8972645323440819,.937273392400706,.9677390756791391,.9879925180204854,.9980022986933971],61:[0,.0514718425553177,.10280693796673702,.15386991360858354,.20452511668230988,.25463692616788985,.30407320227362505,.3527047255308781,.4004012548303944,.44703376953808915,.49248046786177857,.5366241481420199,.5793452358263617,.6205261829892429,.6600610641266269,.6978504947933158,.7337900624532268,.7677774321048262,.799727835821839,.8295657623827684,.8572052335460612,.8825605357920527,.9055733076999078,.9262000474292743,.94437444474856,.9600218649683075,.9731163225011262,.9836681232797472,.9916309968704046,.9968934840746495,.9994844100504906]},rr={21:[.1494455540029169,.14773910490133849,.14277593857706009,.13470921731147334,.12349197626206584,.10938715880229764,.0931254545836976,.07503967481091996,.054755896574351995,.032558162307964725,.011694638867371874],31:[.10133000701479154,.10076984552387559,.09917359872179196,.09664272698362368,.09312659817082532,.08856444305621176,.08308050282313302,.07684968075772038,.06985412131872826,.06200956780067064,.05348152469092809,.04458975132476488,.03534636079137585,.02546084732671532,.015007947329316122,.005377479872923349],61:[.05149472942945157,.05142612853745902,.051221547849258774,.05088179589874961,.05040592140278235,.04979568342707421,.04905543455502978,.04818586175708713,.04718554656929915,.04605923827100699,.04481480013316266,.04345253970135607,.041969810215164244,.040374538951535956,.038678945624727595,.03688236465182123,.034979338028060025,.03298144705748372,.030907257562387762,.02875404876504129,.0265099548823331,.0241911620780806,.021828035821609193,.019414141193942382,.01692088918905327,.014369729507045804,.011823015253496341,.009273279659517764,.0066307039159312926,.003890461127099884,.0013890136986770077]},nr={10:[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],15:[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],30:[.10285265289355884,.1017623897484055,.09959342058679527,.09636873717464425,.09212252223778612,.08689978720108298,.08075589522942021,.0737559747377052,.06597422988218049,.057493156217619065,.04840267283059405,.03879919256962705,.02878470788332337,.01846646831109096,.007968192496166605]},er=Math.sqrt(Number.EPSILON),tr=function(){function r(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:er;f()(this,r),this.N=n,this.maxDepth=e,this.maxRelativeError=t,this.error=0}return h()(r,[{key:"_integrateNonAdaptive",value:function(r){var n,e,t=this.N,i=2,o=1,a=0,u=0;1&(t-1)/2?(a=(n=r(0))*rr[t][0],u+=n*nr[(t-1)/2][0]):(a=(n=r(0))*rr[t][0],i=1,o=2);for(var c=i;c<J[t].length;c+=2)a+=((n=r(J[t][c]))+(e=r(-J[t][c])))*rr[t][c],u+=(n+e)*nr[(t-1)/2][Math.floor(c/2)];for(var s=o;s<J[t].length;s+=2)a+=((n=r(J[t][s]))+(e=r(-J[t][s])))*rr[t][s];return[a,Math.max(Math.abs(a-u),Math.abs(a*Number.EPSILON*2))]}},{key:"_recursiveAdaptiveIntegrate",value:function(r,n,e,t,i){var o,a,u=(e+n)/2,s=(e-n)/2,f=this._integrateNonAdaptive(function(n){return r(s*n+u)}),l=c()(f,2);a=l[0],o=l[1],a*=s;var h=Math.abs(a*this.maxRelativeError);if(i||(i=h),t&&i<o){var m=(n+e)/2,p=this._recursiveAdaptiveIntegrate(r,n,m,t-1,i/2);a=c()(p,1)[0];var v=this._recursiveAdaptiveIntegrate(r,m,e,t-1,i/2);return a+=v[0],this.error+=v[1],[a,o]}return this.error=o,[a,o]}},{key:"integrate",value:function(r,n,e){if(!isFinite(n)||!isFinite(e))throw new Error("Additional integration limits not implemented");return this._recursiveAdaptiveIntegrate(r,n,e,this.maxDepth,0)}}]),r}(),ir=2.220446049250313e-16,or=Number.MIN_VALUE,ar=Number.MAX_VALUE,ur=1.157920892373162e77,cr=.5772156649015329,sr=1e-14,fr=2.2737368458246524e-13,lr=1.4901161193847656e-8,hr=Math.LN2,mr=Math.LN10,pr=Math.PI,vr=2*pr,dr=Math.log(2*Math.PI),yr=Math.log(Math.sqrt(vr)),gr=5.656854249492381,br=.3989422804014327,wr=308*hr/ir,xr=-323*hr,Mr=1,Tr=2,Ar=4,Nr=8,_r=16;function kr(r,n){if(r>Mr){var e="";switch(r){case Mr:e="argument out of domain in ".concat(n);break;case Tr:e="value out of range in ".concat(n);break;case Ar:e="convergence failed in ".concat(n);break;case Nr:e="full precision may not have been achieved in ".concat(n);break;case _r:e="underflow occurred in ".concat(n)}console.error(e)}}function Pr(){return kr(Mr,""),NaN}var Sr=.08333333333333333,Ir=.002777777777777778,jr=.0007936507936507937,Er=.0005952380952380953,Cr=.0008417508417508417,Fr=[0,.15342640972002736,.08106146679532726,.05481412105191765,.0413406959554093,.03316287351993629,.02767792568499834,.023746163656297496,.020790672103765093,.018488450532673187,.016644691189821193,.015134973221917378,.013876128823070748,.012810465242920227,.01189670994589177,.011104559758206917,.010411265261972096,.009799416126158804,.009255462182712733,.008768700134139386,.00833056343336287,.00793411456431402,.007573675487951841,.007244554301320383,.00694284010720953,.006665247032707682,.006408994188004207,.006171712263039458,.0059513701127588475,.0057462165130101155,.005554733551962801],Or=[.3224670334241132,.0673523010531981,.020580808427784546,.007385551028673986,.0028905103307415234,.001192753911703261,.0005096695247430425,.00022315475845357939,9945751278180853e-20,4492623673813314e-20,2050721277567069e-20,9439488275268397e-21,4374866789907488e-21,2039215753801366e-21,9.55141213040742e-7,4.492469198764566e-7,2.1207184805554665e-7,1.0043224823968099e-7,4.7698101693639804e-8,2.2711094608943164e-8,1.0838659214896955e-8,5.183475041970047e-9,2.4836745438024785e-9,1.1921401405860912e-9,5.731367241678862e-10,2.7595228851242334e-10,1.330476437424449e-10,6.4229645638381e-11,3.1044247747322276e-11,1.5021384080754142e-11,7.275974480239079e-12,3.527742476575915e-12,1.711991790559618e-12,8.315385841420285e-13,4.04220052528944e-13,1.9664756310966165e-13,9.573630387838556e-14,4.6640760264283744e-14,2.2737369600659724e-14,1.1091399470834522e-14],qr=[-1e99,2/3,-4/135,8/2835,16/8505,-8992/12629925,-334144/492567075,698752/1477701225],Vr=[-1e99,1/12,1/288,-139/51840,-571/2488320,163879/209018880,5246819/75246796800,-.0005921664373536939],$r=[.00857119559098933,.004415381324841007,.05685043681599363,-.00421983539641856,.0013268081812124603,-.00018930245297988805,3606925327441245e-20,-6056761904460864e-21,10558295463022833e-22,-1.811967365542384e-7,3.117724964715322e-8,-5.354219639019687e-9,9.193275519859589e-10,-1.5779412802883398e-10,2.7079806229349544e-11,-4.64681865382573e-12,7.97335019200742e-13,-1.368078209830916e-13,2.3473194865638007e-14,-4.027432614949067e-15,6.910051747372101e-16,-1.185584500221993e-16,2.034148542496374e-17,-3.490054341717406e-18,5.987993856485306e-19,-1.027378057872228e-19,1.7627028160605298e-20,-3.024320653735306e-21,5.188914660218398e-22,-8.902770842456576e-23,1.5274740684933426e-23,-2.620731256187363e-24,4.496464047830539e-25,-7.714712731336878e-26,1.323635453126044e-26,-2.2709994129429287e-27,3.8964189980039913e-28,-6.685198115125953e-29,1.1469986631400244e-29,-1.9679385863451348e-30,3.376448816585338e-31,-5.793070335782136e-32],Dr=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1.809129475572494e-11,6.221098041892606e-14,-3.399615005417722e-16,2.683181998482699e-18,-2.868042435334643e-20,3.9628370610464347e-22,-6.831888753985767e-24,1.4292273559424982e-25,-3.5475981581010704e-27,1.025680058010471e-28,-3.401102254316749e-30,1.276642195630063e-31],Rr=[2.2352520354606837,161.02823106855587,1067.6894854603709,18154.98125334356,.06568233791820745],Lr=[47.202581904688245,976.0985517377767,10260.932208618979,45507.78933502673],Ur=[.39894151208813466,8.883149794388377,93.50665613217785,597.2702763948002,2494.5375852903726,6848.190450536283,11602.65143764735,9842.714838383978,1.0765576773720192e-8],Wr=[22.266688044328117,235.387901782625,1519.3775994075547,6485.558298266761,18615.571640885097,34900.95272114598,38912.00328609327,19685.429676859992],Br=[.215898534057957,.12740116116024736,.022235277870649807,.0014216191932278934,29112874951168793e-21,.023073441764940174],Yr=[1.284260096144911,.4682382124808651,.06598813786892856,.0037823963320275824,7297515550839662e-20],Qr=function(r){return r?-1/0:0},Xr=function(r){return r?0:1},Hr=function(r,n){return r?Qr(n):Xr(n)},Gr=function(r,n){return r?Xr(n):Qr(n)},zr=function(r,n){return n?r:.5-r+.5},Zr=function(r,n){return n?.5-r+.5:r},Kr=function(r,n){return n?Math.log(r):r},Jr=function(r,n){return n?r:Math.log(r)},rn=function(r,n,e){return n?Kr(r,e):function(r,n){return n?Math.log1p(-r):.5-r+.5}(r,e)},nn=function(r,n){return n?un(r):Math.log1p(-r)},en=function(r,n){return n?Jr(r):nn(r)},tn=function(r,n){return n?nn(r):Jr(r)};function on(r,n,e,t,i){if(e){if(r>0)throw Pr();if(0===r)throw n?i:t;if(r===Number.NEGATIVE_INFINITY)throw n?t:i}else{if(r<0||r>1)throw Pr();if(0===r)throw n?t:i;if(1===r)throw n?i:t}}function an(r,n,e){return e?n?Math.exp(r):-Math.expm1(r):zr(r,n)}function un(r){return r>-hr?Math.log(-Math.expm1(r)):Math.log1p(-Math.exp(r))}function cn(r,n){return n?r:Math.exp(r)}function sn(r){return isNaN(r)?r:Number.isFinite(r)?((r%=2)<=-1?r+=2:r>1&&(r-=2),0==r||1==r?0:.5==r?1:-.5==r?-1:Math.sin(pr*r)):NaN}function fn(r,n,e){var t,i,o,a,u;if(e<1||e>1e3)return NaN;if(r<-1.1||r>1.1)return NaN;for(a=2*r,o=i=0,t=0,u=1;u<=e;u++)o=i,t=a*(i=t)-o+n[e-u];return.5*(t-o)}function ln(r){var n;if(r<10)return NaN;if(r>3.745194030963158e306)throw"lgammacor underflow";return r<94906265.62425156?fn((n=10/r)*n*2-1,Dr,5)/r:1/(12*r)}function hn(r){var n,e,t,i,o;if(isNaN(r))return r;if(0==r||r<0&&r==Math.round(r))return NaN;if((t=Math.abs(r))<=10){if(e=parseInt(r,10),r<0&&e--,t=r-e,e--,o=fn(2*t-1,$r,22)+.9375,0==e)return o;if(e<0){if(r<-.5&&Math.abs(r-parseInt(r-.5,10)/r)<lr)throw"gammafn precision error";if(r<2.2474362225598545e-308)return r>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;for(e=-e,n=0;n<e;n++)o/=r+n;return o}for(n=1;n<=e;n++)o*=t+n;return o}if(r>171.61447887182297)return Number.POSITIVE_INFINITY;if(r<-170.5674972726612)return 0;if(t<=50&&t==parseInt(t,10))for(o=1,n=2;n<t;n++)o*=n;else o=Math.exp((t-.5)*Math.log(t)-t-yr+(2*t==parseInt(2*t,10)?pn(t):ln(t)));if(r>0)return o;if(Math.abs(r-parseInt(r-.5,10)/r)<lr)throw"gammafn precision error";return 0==(i=sn(t))?Number.POSITIVE_INFINITY:-pr/(t*i*o)}function mn(r){return function(r){var n;if(isNaN(r))return r;if(r<0&&Math.floor(-r),r<=0&&r==Math.trunc(r))return Number.POSITIVE_INFINITY;if((n=Math.abs(r))<1e-306)return-Math.log(n);if(n<=10)return Math.log(Math.abs(hn(r)));if(n>2.5327372760800758e305)return Number.POSITIVE_INFINITY;if(r>0)return r>1e17?r*(Math.log(r)-1):r>4934720?yr+(r-.5)*Math.log(r)-r:yr+(r-.5)*Math.log(r)-r+ln(r);if(0==Math.abs(sn(n)))return NaN;if(Math.abs(void 0*(r-Math.trunc(r-.5))/r)<lr)throw"lgamma precision error"}(r)}function pn(r){var n;return r<=15?(n=r+r)==Math.floor(n)?Fr[Math.floor(n)]:mn(r+1)-(r+.5)*Math.log(r)+r-yr:(n=r*r,r>500?(Sr-Ir/n)/r:r>80?(Sr-(Ir-jr/n)/n)/r:r>35?(Sr-(Ir-(jr-Er/n)/n)/n)/r:(Sr-(Ir-(jr-(Er-Cr/n)/n)/n)/n)/r)}function vn(r,n){var e,t,i,o,a;if(!Number.isFinite(r)||!Number.isFinite(n)||0==n)return NaN;if(Math.abs(r-n)<.1*(r+n)){if(t=(r-n)*(o=(r-n)/(r+n)),Math.abs(t)<or)return t;for(e=2*r*o,o*=o,a=1;a<1e3;a++){if((i=t+(e*=o)/(2*a+1))==t)return i;t=i}}return r*Math.log(r/n)+n-r}function dn(r,n,e){return 0==n?Mn(1==r?1:0,e):Number.isFinite(n)?r<0?Mn(0,e):r<=n*or?cn(-n,e):n<r*or?cn(-n+r*Math.log(n)-mn(r+1),e):function(r,n,e){return e?-.5*Math.log(r)+n:Math.exp(n)/Math.sqrt(r)}(vr*r,-pn(r)-vn(r,n),e):Mn(0,e)}function yn(r,n,e,t){var i,o=2*e,a=n+e,u=a+e,c=a,s=n*(a-n*r),f=e*e*r,l=u*a-f;for(f=u*s-n*f;Math.abs(l*s-c*f)>Math.abs(t*s*f);)i=a*a*r,a+=e,c=(u+=e)*l-i*c,s=u*f-i*s,i=o*o*r,o+=e,l=(u+=e)*c-i*l,f=u*s-i*f,Math.abs(f)>ur?(c/=ur,l/=ur,s/=ur,f/=ur):Math.abs(f)<1/ur&&(c*=ur,l*=ur,s*=ur,f*=ur);return l/f}function gn(r){if(r>1||r<-.79149064)return Math.log1p(r)-r;var n=r/(2+r),e=n*n;return Math.abs(r)<.01?n*((((2/9*e+2/7)*e+.4)*e+2/3)*e-r):n*(2*e*yn(e,3,2,sr)-r)}function bn(r){if(Math.abs(r)>=.5)return mn(r+1);var n,e;for(n=fr*yn(-r/2,Or.length+2,1,sr),e=Or.length-1;e>=0;e--)n=Or[e]-r*n;return(r*n-cr)*r-gn(r)}function wn(r,n){return(r>n?r:n)+Math.log1p(Math.exp(-Math.abs(r-n)))}function xn(r,n,e){if(!isFinite(n))return Mn(0,e);if(r>1)return dn(r-1,n,e);if(n>Math.abs(r-1)*wr)return cn(-n-mn(r),e);var t=dn(r,n,e);return e?t+Math.log(r/n):t*(r/n)}function Mn(r,n){return 0===r?n?Number.NEGATIVE_INFINITY:0:n?0:1}function Tn(r,n,e){return Mn(0===r?n?0:1:n?1:0,e)}function An(r,n){var e,t,i,o,a,u,c,s,f,l,h=0;if(0==r)return 0;if(t=r/n,Math.abs(r-1)<Math.abs(n)*ir)return t;for(t>1&&(t=1),o=r,u=n,c=0,s=1,f=r,l=n;l>ur;)c/=ur,s/=ur,f/=ur,l/=ur;for(i=0,e=-1;i<2e5;)if(c=(u+=2)*f+(a=++i*--o)*c,s=u*l+a*s,f=(u+=2)*c+(a=++i*--o)*f,(l=u*s+a*l)>ur&&(c/=ur,s/=ur,f/=ur,l/=ur),0!=l){if(h=f/l,Math.abs(h-e)<=ir*(Math.abs(h)>t?Math.abs(h):t))return h;e=h}return h}function Nn(r,n,e,t){var i,o,a,u,c,s,f,l,h,m,p,v,d,y=qr,g=Vr;for(h=-gn((l=n-r)/r),m=Math.sqrt(2*r*h),l<0&&(m=-m),a=0,c=u=Math.sqrt(r),f=s=m,d=1;d<8;d++)a+=c*y[d],a+=f*g[d],c=c/r+(u*=h/d),f=f/r+(s*=2*h/(2*d+1));for(i=r,o=1,d=1;d<8;d++)i+=o*g[d],o/=r;if(e||(i=-i),p=a/i,v=On(m,0,1,!e,t),t){var b=function(r,n,e){if(r<0&&(r=-r,n=!n),r>10&&!n){var t=1/r,i=t,o=r*r,a=1;do{i+=t*=-a/o,a+=2}while(Math.abs(t)>ir*i);return 1/i}return qn(r,0,1,!1)/Math.exp(e)}(m,!e,v);return v+Math.log1p(p*b)}return v+p*qn(m,0,1,t)}function _n(r,n,e,t){var i,o,a;try{!function(r,n,e,t,i){if(r<=n)throw Hr(t,i);if(r>=e)throw Gr(t,i)}(r,0,Number.POSITIVE_INFINITY,e,t)}catch(r){return r}if(r<1)i=function(r,n,e,t){var i,o=0,a=n,u=0;do{o+=i=(a*=-r/++u)/(n+u)}while(Math.abs(i)>ir*Math.abs(o));if(e){var c,s=t?Math.log1p(o):1+o;return n>1?(c=dn(n,r,t),c=t?c+r:c*Math.exp(r)):c=t?n*Math.log(r)-bn(n):Math.pow(r,n)/Math.exp(bn(n)),t?s+c:s*c}var f=n*Math.log(r)-bn(n);if(t)return un(Math.log1p(o)+f);var l=o,h=Math.expm1(f);return-(l+h+l*h)}(r,n,e,t);else if(r<=n-1&&r<.8*(n+50))a=function(r,n,e){var t=r/n,i=t;do{i+=t*=r/++n}while(t>i*ir);return e?Math.log(i):i}(r,n,t),o=xn(n,r,t),i=e?t?a+o:a*o:t?un(o+a):1-o*a;else if(n-1<r&&n<.8*(r+50)){if(o=xn(n,r,t),n<1)if(r*ir>1-n)a=Mn(0,t);else{var u=An(n,r-(n-1))*r/n;a=t?Math.log(u):u}else a=function(r,n){for(var e=1,t=0;n>=1&&e>t*ir;)t+=e*=n/r,n--;return n!==Math.floor(n)&&(t+=e*An(n,r+1-n)),t}(r,n-1),a=t?Math.log1p(a):1+a;i=e?t?un(o+a):1-o*a:t?a+o:a*o}else i=Nn(n-1,r,!e,t);return!t&&i<or/ir?Math.exp(_n(r,n,e,!0)):i}function kn(r,n,e,t,i){return isNaN(r)||n<0||e<0?NaN:(r/=e,0==n?Tn(r<=0?0:1,t,i):_n(r,n,t,i))}function Pn(r,n,e,t){var i;return r=Dn(r),n=Dn(n),e=Dn(e),t=Rn(t),isNaN(r)||isNaN(n)||isNaN(e)?r+n+e:r<0?Qr(t):0===n?0===r?1/0:Qr(t):0===r?n<1?1/0:n>1?Qr(t):t?-Math.log(e):1/e:n<1?(i=dn(n,r/e,t),t?i+Math.log(n/r):i*n/r):(i=dn(n-1,r/e,t),t?i-Math.log(e):i/e)}function Sn(r,n,e){return Pn(r,n/2,2,e)}function In(r,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,t=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return r=Dn(r),n=Dn(n),e=Dn(e),t=Rn(t),i=Rn(i),0===e?kn(r,n/2,2,t,i):function(r,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,t=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(n<0||e<0)return NaN;var o=jn(r,n,e,1e-12,8*ir,1e6,t,i);e>=80&&(t?(a=o,u=Xr(i),o=isNaN(a)||isNaN(u)?a+u:a<u?a:u):(o<(i?-10*mr:1e-10)&&kr(Nr,"pnchisq"),i||(o=function(r,n){return isNaN(r)||isNaN(n)?r+n:r<n?n:r}(o,0))));var a,u;return!i||o<-1e-8?o:(o=jn(r,n,e,1e-12,8*ir,1e6,!t,!1),Math.log1p(-o))}(r,n,e,t,i)}function jn(r,n,e,t,i,o,a,u){var c,s,f,l,h,m,p,v,d,y,g,b,w,x,M,T=-1,A=-1,N=-1;if(r<=0){if(0===r&&0===n){var _=-.5*e;return a?cn(_,u):u?un(_):-function(r){var n,e=Math.abs(r);return e<ir?r:e>.697?Math.exp(r)-1:(n=e>1e-8?Math.exp(r)-1:(r/2+1)*r,n-=(1+n)*(Math.log1p(n)-r))}(_)}return Hr(a,u)}if(!isFinite(r))return Gr(a,u);if(e<80){var k;if(a&&n>0&&Math.log(r)<hr+2/n*(mn(n/2+1)+xr)){var P,S,I=.5*e,j=-I;P=S=-1/0;for(var E=0;E<110&&(S=wn(S,j),P=wn(P,j+In(r,n+2*E,0,a,!0)),!(S>=-1e-15));j===Math.log(I)-Math.log(++E));return k=P-S,u?k:Math.exp(k)}for(var C=.5*e,F=0,O=0,q=Math.exp(-C),V=0;V<110&&(O+=q,F+=q*In(r,n+2*V,0,a,!1),!(O>=1-1e-15));q*=C/++V);return k=F/O,u?Math.log(k):k}if((v=-(c=.5*e)<xr)?(b=0,N=-c,T=Math.log(c)):b=Math.exp(-c),w=b,s=.5*r,h=n-r,d=(M=(f=.5*n)*ir>.125&&Math.abs(x=s-f)<Math.sqrt(ir)*f?(1-x)*(2-x/(f+1))-yr-.5*Math.log(f+1):f*Math.log(s)-s-mn(f+1))<xr){if(r>n+e+5*Math.sqrt(2*(n+2*e)))return Gr(a,u);A=Math.log(r),g=l=0,x=0}else g=l=w*(x=Math.exp(M));for(p=1,m=n+2,h+=2;!(h>0&&(y=p>o,x*r/h<=t&&l<=i*g||y));p++,m+=2,h+=2)v?(N+=T-Math.log(p))>=xr&&(w=b=Math.exp(N),v=!1):w+=b*=c/p,d?(M+=A-Math.log(m))>=xr&&(x=Math.exp(M),d=!1):x*=r/m,v||d||(g+=l=w*x);return y&&console.error("pnchisq(x=".concat(r,",...) not converged in ").concat(o)),rn(g,a,u)}function En(r,n,e,t,i){var o,a,u,c;if(isNaN(r)||isNaN(n)||isNaN(e))return r+n+e;try{on(r,t,i,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY)}catch(r){return r}return e<0?Pr():0===e?n:(a=(o=an(r,t,i))-.5,Math.abs(a)<=.425?c=a*(((((((2509.0809287301227*(u=.180625-a*a)+33430.57558358813)*u+67265.7709270087)*u+45921.95393154987)*u+13731.69376550946)*u+1971.5909503065513)*u+133.14166789178438)*u+3.3871328727963665)/(((((((5226.495278852854*u+28729.085735721943)*u+39307.89580009271)*u+21213.794301586597)*u+5394.196021424751)*u+687.1870074920579)*u+42.31333070160091)*u+1):(u=a>0?function(r,n,e){return e?n?-Math.expm1(r):Math.exp(r):Zr(r)}(r,t,i):o,c=(u=Math.sqrt(-(i&&(t&&a<=0||!t&&a>0)?r:Math.log(u))))<=5?(((((((.0007745450142783414*(u+=-1.6)+.022723844989269184)*u+.2417807251774506)*u+1.2704582524523684)*u+3.6478483247632045)*u+5.769497221460691)*u+4.630337846156546)*u+1.4234371107496835)/(((((((1.0507500716444169e-9*u+.0005475938084995345)*u+.015198666563616457)*u+.14810397642748008)*u+.6897673349851)*u+1.6763848301838038)*u+2.053191626637759)*u+1):(((((((2.0103343992922881e-7*(u+=-5)+27115555687434876e-21)*u+.0012426609473880784)*u+.026532189526576124)*u+.29656057182850487)*u+1.7848265399172913)*u+5.463784911164114)*u+6.657904643501103)/(((((((2.0442631033899397e-15*u+1.421511758316446e-7)*u+18463183175100548e-21)*u+.0007868691311456133)*u+.014875361290850615)*u+.1369298809227358)*u+.599832206555888)*u+1),a<0&&(c=-c)),n+e*c)}function Cn(r,n,e,t,i,o){var a,u,c,s,f,l,h,m,p;if(isNaN(r)||isNaN(n))return r+n;try{!function(r,n){if(n&&r>0||!n&&(r<0||r>1))throw Pr()}(r,i)}catch(r){return r}if(n<=0)return Pr();if(c=(a=.5*n)-1,n<-1.24*(f=en(r))){var v=a<.5?bn(a):Math.log(a)+e;s=Math.exp((v+f)/a+hr)}else if(n>.32)p=En(r,0,1,t,i),f=2/(9*n),(s=n*Math.pow(p*Math.sqrt(f)+1-f,3))>2.2*n+6&&(s=-2*(tn(r,t)-c*Math.log(.5*s)+e));else{s=.4,u=tn(r,t)+e+c*hr;do{h=s,m=(4.67+2*s)*(f=1/(1+s*(4.67+s)))-.5-(6.73+s*(13.32+3*s))/(l=s*(6.73+s*(6.66+s))),s-=(1-Math.exp(u+.5*s)*l*f)/m}while(Math.abs(h-s)>o*Math.abs(s))}return s}function Fn(r,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,t=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(0!==e)throw"Non-central chi-squared not yet supported";return function(r,n,e,t,i){var o,a,u,c,s,f,l,h,m,p,v,d,y,g,b=1e-15,w=1;if(isNaN(r)||isNaN(n)||isNaN(e))return r+n+e;try{on(r,t,i,0,Number.POSITIVE_INFINITY)}catch(r){return r}if(n<0||e<=0)return Pr();if(0===n)return 0;function x(){if(g=.5*e*f,w){if(i||(r=Math.log(r),i=!0),0===g){if(o=kn(g=or,n,e,t,i),t&&o>r*(1+1e-7)||!t&&o<r*(1-1e-7))return 0}else o=kn(g,n,e,t,i);if(o===Number.NEGATIVE_INFINITY)return 0}for(var a=1;a<=w&&(h=o-r,!(Math.abs(h)<Math.abs(b*r)))&&(s=Pn(g,n,e,i))!==Qr(i)&&(y=i?h*Math.exp(o-s):h/s,o=kn(y=t?g-y:g+y,n,e,t,i),!(Math.abs(o-r)>Math.abs(h)||a>1&&Math.abs(o-r)===Math.abs(h)));a++)g=y;return g}if(n<1e-10&&(w=7),o=an(r,t,i),s=mn(n),f=Cn(r,2*n,s,t,i,.01),!isFinite(f))return w=0,x();if(f<5e-7)return w=20,x();if(o>1-1e-14||o<1e-100)return w=20,x();d=1/5040*(120+(c=n-1)*(346+127*c)),l=f;for(var M=1;M<=1e3;M++){if(p=f,m=o-_n(h=.5*f,n,!0,!1),!isFinite(m)||f<=0)return f=l,w=27,x();if(y=m*Math.exp(n*hr+s+h-c*Math.log(f)),f+=y*(1+.5*y*(v=1/420*(210+(a=.5*y-(u=y/f)*c)*(140+a*(105+a*(84+a*(70+60*a))))))-u*c*(v-u*(1/2520*(420+a*(735+a*(966+a*(1141+1278*a))))-u*(1/2520*(210+a*(462+a*(707+932*a)))-u*(1/5040*(252+a*(672+1182*a)+c*(294+a*(889+1740*a)))-u*(1/2520*(84+2264*a+c*(1175+606*a))-u*d)))))),Math.abs(p-f)<5e-7*f)return x();Math.abs(p-f)>.1*f&&(f=f<p?.9*p:1.1*p)}return x()}(r,.5*n,2,t,i)}function On(r,n,e,t,i){var o;if(isNaN(r)||isNaN(n)||isNaN(e))return NaN;if(!Number.isFinite(r)&&n===r)return NaN;if(e<=0)return e<0?NaN:r<n?Hr(t,i):Gr(t,i);if(o=(r-n)/e,!Number.isFinite(o))return r<n?Hr(t,i):Gr(t,i);var a=function(r,n,e){var t,i,o,a,u,c,s,f,l,h,m,p,v=Rr,d=Lr,y=Ur,g=Wr,b=Br,w=Yr;if(isNaN(r))return{cum:NaN,ccum:NaN};if(s=.5*ir,m=1!=n,p=0!=n,(l=Math.abs(r))<=.67448975){if(l>s)for(f=r*r,a=v[4]*f,o=f,h=0;h<3;++h)a=(a+v[h])*f,o=(o+d[h])*f;else a=o=0;u=r*(a+v[3])/(o+d[3]),m&&(t=.5+u),p&&(i=.5-u),e&&(m&&(t=Math.log(t)),p&&(i=Math.log(i)))}else if(l<=gr){for(a=y[8]*l,o=l,h=0;h<7;++h)a=(a+y[h])*l,o=(o+g[h])*l;u=(a+y[7])/(o+g[7]),c=(l-(f=Math.trunc(16*l)/16))*(l+f),e?(t=-f*f*.5+.5*-c+Math.log(u),(m&&r>0||p&&r<=0)&&(i=Math.log1p(-Math.exp(-f*f*.5)*Math.exp(.5*-c)*u))):i=1-(t=Math.exp(-f*f*.5)*Math.exp(.5*-c)*u),r>0&&(u=t,m&&(t=i),i=u)}else if(e&&l<1e170||m&&-37.5193<r&&r<8.2924||p&&r<37.5193){for(f=1/(r*r),a=b[5]*f,o=f,h=0;h<4;++h)a=(a+b[h])*f,o=(o+w[h])*f;u=f*(a+b[4])/(o+w[4]),u=(br-u)/l,c=(r-(f=Math.trunc(16*r)/16))*(r+f),e?(t=-f*f*.5+.5*-c+Math.log(u),(m&&r>0||p&&r<=0)&&(i=Math.log1p(-Math.exp(-f*f*.5)*Math.exp(.5*-c)*u))):i=1-(t=Math.exp(-f*f*.5)*Math.exp(.5*-c)*u),r>0&&(u=t,m&&(t=i),i=u)}else r>0?(t=Mn(1,e),i=Mn(0,e)):(t=Mn(0,e),i=Mn(1,e));return{cum:t,ccum:i}}(r=o,t?0:1,i);return t?a.cum:a.ccum}function qn(r,n,e,t){return isNaN(r)||isNaN(n)||isNaN(e)?r+n+e:Number.isFinite(e)?Number.isFinite(r)||n!=r?e<=0?e<0?NaN:r==n?Number.POSITIVE_INFINITY:Mn(0,t):(r=(r-n)/e,Number.isFinite(r)?(r=Math.abs(r))>=2*Math.sqrt(ar)?Mn(0,t):t?-(yr+.5*r*r+Math.log(e)):br*Math.exp(-.5*r*r)/e:Mn(0,t)):NaN:Mn(0,t)}function Vn(r,n,e,t){return(n<0||e<0)&&Pr(),r<0||r>1?Qr(t):0!==n&&0!==e&&isFinite(n)&&isFinite(e)?0===r?n>1?Qr(t):n<1?Number.POSITIVE_INFINITY:Kr(e,t):1===r?e>1?Qr(t):e<1?Number.POSITIVE_INFINITY:Kr(n,t):(i=n<=2||e<=2?(n-1)*Math.log(r)+(e-1)*Math.log1p(-r)-function(r,n){var e,t,i;return n<(t=i=r)&&(t=n),n>i&&(i=n),t<0?Pr():0===t?Number.POSITIVE_INFINITY:isFinite(i)?t>=10?(e=ln(t)+ln(i)-ln(t+i),-.5*Math.log(i)+yr+e+(t-.5)*Math.log(t/(t+i))+i*Math.log1p(-t/(t+i))):i>=10?(e=ln(i)-ln(t+i),mn(t)+e+t-t*Math.log(t+i)+(i-.5)*Math.log1p(-t/(t+i))):t<1e-306?mn(t)+(mn(i)-mn(t+i)):Math.log(hn(t)*(hn(i)/hn(t+i))):Number.NEGATIVE_INFINITY}(n,e):Math.log(n+e-1)+function(r,n,e,t,i){return 0===e?0===r?Xr(i):Qr(i):0===t?r===n?Xr(i):Qr(i):0===r?0===n?Xr(i):cn(e<.1?-vn(n,n*t)-n*e:n*Math.log(t),i):r===n?cn(t<.1?-vn(n,n*e)-n*t:n*Math.log(e),i):r<0||r>n?Qr(i):cn(pn(n)-pn(r)-pn(n-r)-vn(r,n*e)-vn(n-r,n*t)-.5*(dr+Math.log(r)+Math.log1p(-r/n)),i)}(n-1,n+e-2,r,1-r,!0),cn(i,t)):0===n&&0===e?0===r||1===r?Number.POSITIVE_INFINITY:Qr(t):0===n||n/e==0?0===r?Number.POSITIVE_INFINITY:Qr(t):0===e||e/n==0?1===r?Number.POSITIVE_INFINITY:Qr(t):.5===r?Number.POSITIVE_INFINITY:Qr(t);var i}function $n(r,n,e,t){return Vn(r=Dn(r),n=Dn(n),e=Dn(e),t=Rn(t,!1))}function Dn(r,n){return void 0===r?n:+r}function Rn(r,n){return void 0===r?n:!("false"==(r||"false"))}var Ln=new Promise(function(r,n){try{Object($.a)().then(function(n){function e(r){var e=new n.DoubleVec;return e.resize(r,NaN),e}function t(r){var e=new n.IntVec;return e.resize(r,NaN),e}function i(r){for(var e=new(arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DoubleVec),t=0;t<r.length;t++)e.push_back(r[t]);return e}r({makeDoubleVec:e,makeIntVec:t,copyToDoubleVec:i,pmvnorm:function(r,o,a,u){for(var c=u.length,s=t(c),f=e(c),l=e(c*(c-1)/2),h=Wn(u),m=0;m<c;m++)for(var v=m+1;v<c;v++){var d=m+1+(v-1)*v/2-1;l.set(d,h[v][m])}for(var y=0;y<c;y++)f.set(y,0),r[y]!==1/0&&r[y]!==-1/0&&(r[y]=(r[y]-a[y])/Math.sqrt(u[y][y])),o[y]!==1/0&&o[y]!==-1/0&&(o[y]=(o[y]-a[y])/Math.sqrt(u[y][y])),r[y]===-1/0&&s.set(y,0),o[y]===1/0&&s.set(y,1),r[y]===-1/0&&o[y]===1/0&&s.set(y,-1),r[y]!==-1/0&&o[y]!==1/0&&s.set(y,2),r[y]===-1/0&&(r[y]=0),o[y]===1/0&&(o[y]=0);for(var g=0,b=0,w=0,x=0,M=0;M<c;M++)x+=s.get(M);if(x===-c)g=0,b=1;else{var T=n.mvtdst(c,0,i(r),i(o),s,l,f,5e4,.001,0);w=T.error,g=T.inform,b=T.value}if(3===g){for(;g>1;){for(var A=p.a.eig(h,1e5),N=A.lambda.x,_=0;_<c;_++)N[_]<0&&(N[_]=0);var k=p.a.diag(N),P=A.E.x;h=p.a.dot(p.a.dot(P,k),p.a.transpose(P));for(var S=Array(c),I=0;I<c;I++)S[I]=h[I][I];for(var j=p.a.dot(p.a.transpose([S]),[S]),E=0;E<c;E++)for(var C=E+1;C<c;C++){var F=E+1+(C-1)*C/2-1;l.set(F,h[C][E]/Math.sqrt(j[C][E]))}var O=n.mvtdst(c,0,i(r),i(o),s,l,f,5e4,.001,0);w=O.error,g=O.inform,b=O.value}g>1&&(b=-1)}return{error:w,inform:g,value:b}}})})}catch(r){n(r)}});function Un(r,n){for(var e=new Array(r),t=0;t<r;t++)e[t]=new Array(n).fill(NaN);return e}function Wn(r){for(var n=Un(r.length,r[0].length),e=0;e<r.length;e++)for(var t=e;t<r[0].length;t++)if(e===t)n[e][t]=1;else{var i=r[e][t]/(Math.sqrt(r[e][e])*Math.sqrt(r[t][t]));n[e][t]=i,n[t][e]=i}return n}function Bn(r,n,e){for(var t=new Array(2).fill(0),i=[],o=e.length-1,a=Un(o,o),u=0;u<o;u++){var c=e[u+1];i[u]=r[c];for(var s=0;s<o;s++){var f=e[s+1];a[u][s]=n[c][f]}}for(var l=p.a.inv(a),h=new Array(o).fill(NaN),m=0;m<o;m++){var v=e[0],d=e[m+1];h[m]=n[v][d]}for(var y=new Array(o).fill(0),g=0;g<o;g++)y[g]+=p.a.dot(h,l[g]);return t[0]=p.a.dot(y,i),t[1]=1-p.a.dot(y,h),t[1]<0&&(t[1]=Math.abs(t[1])),t}function Yn(r,n,e){var t=0,i=r.length,o=e*e,u={};if(1===i)return t=In(o,1,0,0);var c=In(o,1,0,0);t+=i*c;for(var s=[],f=a()(Array(i).keys()),l=2;l<=i;l++)for(var h=l,m=[],p=[],v=l;v<=h;v++){for(var d=v,y=!0,g=0;g<d;g++)s.push(g);for(;y;){y=!1;for(var b=0;b<d;b++)m.push(f[s[b]]);var w=void 0,x=void 0,M=void 0;0===(p=Bn(r,n,m))[1]?x=0:((w=(e-p[0])*(e-p[0])/p[1])<0&&(w=-w),x=In(w,1,0,0));var T="";if(2===d)T+=m[0],M=x*c,u[T+=m[1]]=M,T="";else{for(var A=1;A<d;A++)T+=m[A];M=u[T],M*=x;var N="";N+=m[0],u[N+=T]=M,T=""}t-=M,m=[];for(var _=d-1;_>=0;_--)if(s[_]<=i-1-(d-_)){s[_]++;for(var k=_+1;k<d;k++)s[k]=s[k-1]+1;_=-1,y=!0}}s=[]}return t}var Qn=function(){function r(){f()(this,r),this.label="",this.key="",this.requiresMaf=!1}return h()(r,[{key:"run",value:function(r,n,e,t){throw new Error("Method must be implemented in a subclass")}}]),r}(),Xn=function(r){function n(){var r;return f()(this,n),(r=y()(this,b()(n).apply(this,arguments))).key="burden",r.label="Burden",r}return x()(n,r),h()(n,[{key:"run",value:function(r,e,t){for(var i=0,o=[r,e];i<o.length;i++){var a=o[i];if(!Array.isArray(a)||!a.length)throw"Please provide all required arrays"}if(r.length!==e.length)throw"u and v must be same length";if(null!=t){if(t.length!==r.length)throw"w vector must be same length as score vector u"}else t=n.weights(r.length);var u,c,s,f,l,h=p.a.dot(t,r)/Math.sqrt(p.a.dot(p.a.dot(t,e),t));return[h,2*(u=-Math.abs(h),c=0,s=1,On(u=Dn(u),c=Dn(c,0),s=Dn(s,1),f=Rn(f,!0),l=Rn(l,!1)))]}}],[{key:"weights",value:function(r){return new Array(r).fill(1/r)}}]),n}(Qn);function Hn(r,n,e,t){var i=Un(r.length,n.length),o=-1/0,u=Array(r.length).fill(0);if(r.map(function(r,a){var c=t.map(function(n){return n<=r?1:0});i[a]=c;var s=p.a.dot(c,n),f=p.a.dot(p.a.dot(c,e),c),l=Math.abs(s/Math.sqrt(f));u[a]=l,l>o&&(o=l)}),0===Math.max.apply(Math,a()(u)))throw"No scores were able to be calculated for this group";var c=Wn(p.a.dot(p.a.dot(i,e),p.a.transpose(i)));return[u,c,o]}var Gn=function(r){function n(){var r;return f()(this,n),(r=y()(this,b()(n).apply(this,arguments))).label="Variable Threshold",r.key="vt",r.requiresMaf=!0,r._method="auto",r}return x()(n,r),h()(n,[{key:"run",value:function(r,n,e,t){if(null!=e)throw"w vector is not accepted in with VT test";for(var i=[],o=a()(t).sort(),u=0;u<t.length;u++)o[u]>i.slice(-1)&&i.push(o[u]);var s=Hn(i,r,n,t),f=c()(s,3),l=f[0],h=f[1],m=f[2],p=new Array(i.length).fill(-m),v=new Array(i.length).fill(m),d=new Array(i.length).fill(0);return Ln.then(function(e){var o,a=e.pmvnorm(p,v,d,h);if(-1===a.value)throw"Error: correlation matrix is not positive semi-definite";if(1===a.value)if(i.length>20){var u=Hn(i=i.slice(-20),r,n,t),s=c()(u,3);o=Yn(s[0],s[1],s[2])}else o=Yn(l,h,m);else o=1-a.value;return o>1&&(o=1),[m,o]})}}]),n}(Qn),zn=function(r){function n(){var r;return f()(this,n),(r=y()(this,b()(n).apply(this,arguments))).label="SKAT",r.key="skat",r.requiresMaf=!0,r._method="auto",r}return x()(n,r),h()(n,[{key:"run",value:function(r,e,t,i){null==t&&(t=n.weights(i));var o,a=p.a.dot(p.a.dot(r,p.a.diag(t)),r);try{var u=p.a.svd(e),c=p.a.sqrt(u.S),s=p.a.transpose(u.U),f=p.a.dot(p.a.dot(u.U,p.a.diag(c)),s),l=p.a.dot(f,p.a.diag(t)),h=p.a.dot(l,f),m=p.a.svd(h);o=p.a.abs(m.S)}catch(r){return console.log(r),[NaN,NaN]}if(p.a.sum(o)<1e-10)return console.error("Sum of lambda values for SKAT test is essentially zero"),[NaN,NaN];if("liu"===this._method)return Kn(o,a);if("davies"===this._method)return Zn(o,a);if("auto"===this._method){if(1===o.length)return Kn(o,a);var v=Zn(o,a);return isNaN(v[1])?Kn(o,a):v}throw new Error("Skat method ".concat(this._method," not implemented"))}}],[{key:"weights",value:function(r){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,t=Array(r.length).fill(null),i=0;i<r.length;i++){var o=$n(r[i],n,e,!1);o*=o,t[i]=o}return t}}]),n}(Qn);function Zn(r,n){var e=r.length,t=K(r,Array(e).fill(0),Array(e).fill(1),e,0,n,1e4,1e-4),i=1-t[0];return 0===t[1]&&i>0&&i<=1||(i=NaN),[n,i]}function Kn(r,n){for(var e=r.length,t=Array(4).fill(0),i=c()(t,4),o=i[0],a=i[1],u=i[2],s=i[3],f=0;f<e;f++){var l=r[f];o+=l,a+=l*l,u+=l*l*l,s+=l*l*l*l}var h,m,p,v=u/Math.sqrt(a*a*a),d=s/(a*a),y=(n-o)/Math.sqrt(2*a);v*v>d?m=(p=1/(v-Math.sqrt(v*v-d)))*p-2*(h=v*p*p*p-p*p):(p=1/v,h=0,m=a*a*a/(u*u));var g=m+h,b=y*(Math.sqrt(2)*p)+g;return[n,0===h?In(b,m,0,0):In(b,m,h,0,0)]}function Jn(r){for(var n=p.a.eig(r,1e6).lambda.x.sort(function(r,n){return r-n}),e=n.length,t=0,i=0,o=0;o<e;o++)n[o]>0&&(t++,i+=n[o]);if(0===t)throw new Error("All eigenvalues were 0 when calculating SKAT-O test");for(var a=i/t/1e5,u=e,c=0;c<e&&n[c]<a;c++)u--;for(var s=new Array(u).fill(null),f=0;f<u;f++)s[f]=n[e-1-f];return s}function re(r){var n=new Array(4).fill(NaN);n[0]=p.a.sum(r),n[1]=p.a.sum(p.a.pow(r,2)),n[2]=p.a.sum(p.a.pow(r,3)),n[3]=p.a.sum(p.a.pow(r,4));var e,t=n[0],i=Math.sqrt(2*n[1]),o=n[2]/n[1]/Math.sqrt(n[1]),a=n[3]/(n[1]*n[1]);return{muQ:t,varQ:i*i,df:o*o>a?(e=1/(o-Math.sqrt(o*o-a)))*e-2*(o*e-e*e):1/a}}function ne(r,n){return(Fn(r,n.df,0,!1,!1)-n.df)/Math.sqrt(2*n.df)*Math.sqrt(n.varQ)+n.muQ}var ee=function(){function r(n,e,t,i,o,a,u,c){f()(this,r),this.rhos=n,this.lambda=e,this.Qs_minP=t,this.taus=i,this.MuQ=o,this.VarQ=a,this.VarZeta=u,this.Df=c,this.gkPoints=21,this.gkDepth=30,this.gkError=Math.pow(Number.EPSILON,.25)}return h()(r,[{key:"setIntegrationParams",value:function(r,n,e){this.gkPoints=r,this.gkDepth=n,this.gkError=e}},{key:"integrandDavies",value:function(n){for(var e,t=Number.MAX_VALUE,i=this.rhos.length,o=0;o<i;o++){var a=(this.Qs_minP[o]-this.taus[o]*n)/(1-this.rhos[o]);0===o&&(t=a),a<t&&(t=a)}if(t>1e4*p.a.sum(this.lambda))e=0;else{var u=(t-this.MuQ)*Math.sqrt(this.VarQ-this.VarZeta)/Math.sqrt(this.VarQ)+this.MuQ;((e=r.pvalueDavies(u,this.lambda))<=0||1===e)&&(e=r.pvalueLiu(u,this.lambda))}return(1-e)*Sn(n,1)}},{key:"integrandLiu",value:function(r){for(var n=Number.MAX_VALUE,e=this.rhos.length,t=0;t<e;t++){var i=(this.Qs_minP[t]-this.taus[t]*r)/(1-this.rhos[t]);i<n&&(n=i)}var o=(n-this.MuQ)/Math.sqrt(this.VarQ)*Math.sqrt(2*this.Df)+this.Df;return o<=0?0:In(o,this.Df)*Sn(r,1)}},{key:"_debugWriteIntegrandDavies",value:function(r){for(var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001,a=e(9).createWriteStream(r),u=t;u<i;u+=o)n=this.integrandDavies(u),a.write(u+"\t"+n+"\n")}},{key:"skatOptimalIntegral",value:function(){var r,n=new tr(this.gkPoints,this.gkDepth,this.gkError);try{r=n.integrate(this.integrandDavies.bind(this),0,40)}catch(e){try{r=n.integrate(this.integrandLiu.bind(this),0,40)}catch(r){throw console.error("Could not integrate Davies or Liu integrands (SKAT-O)"),r}}return r[0]}}],[{key:"pvalueDavies",value:function(r,n){var e=n.length,t=K(n,Array(e).fill(0),Array(e).fill(1),e,0,r,1e4,1e-4),i=1-t[0];return i>1&&(i=1),t[1]&&(i=-1),i}},{key:"pvalueLiu",value:function(r,n){for(var e=n.length,t=Array(4).fill(0),i=c()(t,4),o=i[0],a=i[1],u=i[2],s=i[3],f=0;f<e;f++){var l=n[f];o+=l,a+=l*l,u+=l*l*l,s+=l*l*l*l}var h,m,p,v=u/Math.sqrt(a*a*a),d=s/(a*a),y=(r-o)/Math.sqrt(2*a);v*v>d?m=(p=1/(v-Math.sqrt(v*v-d)))*p-2*(h=v*p*p*p-p*p):(p=1/v,h=0,m=a*a*a/(u*u));var g=m+h,b=y*(Math.sqrt(2)*p)+g;return b<0?1:0===h?In(b,m,0,0):In(b,m,h,0,0)}}]),r}(),te=function(r){function n(){var r;return f()(this,n),(r=y()(this,b()(n).apply(this,arguments))).label="SKAT Optimal",r.key="skat-o",r.requiresMaf=!0,r._method="auto",r}return x()(n,r),h()(n,[{key:"run",value:function(r,e,t,i,o){var a=p.a.dot,u=p.a.sum,c=p.a.mul,s=p.a.div,f=p.a.sub,l=p.a.rep,h=p.a.pow,m=p.a.diag,v=p.a.transpose;if(1===r.length)return(new zn).run(r,e,t,i);null==t&&(t=n.weights(i));var d=r.length;if(t=m(t),r=v([r]),!o){o=[];for(var y=0;y<=10;y++){var g=y/10;g>.999&&(g=.999),o.push(g)}}for(var b=o.length,w=new Array(b).fill(null),x=0;x<b;x++){for(var T=l([d,d],o[x]),A=0;A<T.length;A++)T[A][A]=1;w[x]=T}for(var N=[],_=0;_<b;_++)N[_]=a(v(r),a(t,a(w[_],a(t,r))))[0][0],N[_]=N[_]/2;for(var k=new Array(b).fill(null),P=s(a(t,a(e,t)),2),S=0;S<b;S++){var I=M(w[S]),j=a(v(I),a(P,I));try{k[S]=Jn(j)}catch(r){return console.error(r.message),[NaN,NaN]}}for(var E=new Array(b).fill(null),C=0;C<b;C++)E[C]=re(k[C]);for(var F,O,q=new Array(b).fill(null),V=0;V<b;V++)q[V]=(F=N[V],O=E[V],In((F-O.muQ)/Math.sqrt(O.varQ)*Math.sqrt(2*O.df)+O.df,O.df,0,!1,!1));for(var $=q[0],D=0,R=1;R<b;R++)q[R]<$&&($=q[R],D=R);for(var L=N[D],U=new Array(b).fill(null),W=0;W<b;W++)U[W]=ne($,E[W]);var B,Y=a(P,l([d,1],1)),Q=P,X=s(a(Y,v(Y)),u(Q)),H=f(Q,X);try{B=Jn(H)}catch(r){return console.error(r.message),[NaN,NaN]}for(var G=4*u(c(X,H)),z=u(B),Z=2*u(h(B,2))+G,K=12/(12*u(h(B,4))/Math.pow(u(h(B,2)),2)),J=u(Q)/Math.pow(d,2),rr=u(a(Q,Q))/Math.pow(d,2)/J,nr=new Array(b).fill(null),er=0;er<b;er++)nr[er]=d*d*o[er]*J+rr*(1-o[er]);if(new Set([o.length,U.length,nr.length]).size>1)throw"Parameter arrays for SKAT integration must all be the same length";var tr=new ee(o,B,U,nr,z,Z,G,K);tr.setIntegrationParams(21,30,Math.pow(Number.EPSILON,.25));var ir=1-tr.skatOptimalIntegral();if(ir<1e-4&&(tr.setIntegrationParams(21,45,Math.pow(Number.EPSILON,.15)),ir=1-tr.skatOptimalIntegral()),b&&ir<=0){var or=$*(b<3?2:3);ir<or&&(ir=or)}if(0===ir){ir=q[0];for(var ar=1;ar<b;ar++)q[ar]>0&&q[ar]<ir&&(ir=q[ar])}return[L,ir]}}],[{key:"weights",value:function(r){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,t=Array(r.length).fill(null),i=0;i<r.length;i++){var o=$n(r[i],n,e,!1);t[i]=o}return t}}]),n}(Qn),ie=[Xn,zn,Gn,te],oe=Object.freeze(ie.reduce(function(r,n){var e=new n;return r[e.key]={label:e.label,constructor:n},r},{})),ae=function(){function r(n){f()(this,r),this._variants=n,this._variant_lookup=this.parsePortalVariantData(n)}return h()(r,[{key:"parsePortalVariantData",value:function(r){var n={};return r.forEach(function(r){var e=r.variant,t=r.altFreq,i=r.pvalue,o=r.score,a=e.match(v),u=c()(a,6),s=(u[0],u[1]),f=u[2],l=u[3],h=u[4],m=(u[5],t),p=h;t>.5&&(o=-o,p=l,m=1-t),n[e]={variant:e,chrom:s,pos:f,pvalue:i,score:o,altAllele:h,effectAllele:p,altFreq:t,effectFreq:m}}),n}},{key:"isAltEffect",value:function(r){var n=this;return r.map(function(r){var e=n._variant_lookup[r];return e.altAllele===e.effectAllele})}},{key:"getEffectFreq",value:function(r){var n=this;return r.map(function(r){return n._variant_lookup[r].effectFreq})}},{key:"getScores",value:function(r){var n=this;return r.map(function(r){return n._variant_lookup[r].score})}},{key:"getGroupVariants",value:function(r){var n=this;return r.map(function(r){return n._variant_lookup[r]})}},{key:"data",get:function(){return this._variants}}]),r}(),ue=function(){function r(n){f()(this,r),this._groups=n,this._lookup=this._generateLookup(n)}return h()(r,[{key:"byMask",value:function(r){Array.isArray(r)||(r=[r]),r=new Set(r);var n=this._groups.filter(function(n){return r.has(n.mask)});return new this.constructor(n)}},{key:"byGroup",value:function(r){Array.isArray(r)||(r=[r]),r=new Set(r);var n=this._groups.filter(function(n){return r.has(n.group)});return new this.constructor(n)}},{key:"_generateLookup",value:function(r){var n=this;return r.reduce(function(r,e,t){return r[n._getKey(e.mask,e.group)]=t,r},{})}},{key:"_getKey",value:function(r,n){return"".concat(r,",").concat(n)}},{key:"getOne",value:function(r,n){var e=this._getKey(r,n),t=this._lookup[e];return this._groups[t]}},{key:"makeCovarianceMatrix",value:function(r,n){for(var e=r.variants.length,t=new Array(e),i=0;i<e;i++)t[i]=new Array(e).fill(null);for(var o=0,a=0;a<e;a++)for(var u=a;u<e;u++){var c=r.covariance[o],s=n[a],f=n[u];a!==u&&!s^!f&&(c=-c),t[a][u]=c,t[u][a]=c,o+=1}return t=p.a.mul(r.nSamples,t)}},{key:"data",get:function(){return this._groups}}]),r}(),ce=function(){function r(n,e){var t=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];f()(this,r),this.groups=n,this.variants=e,this._tests=[],i.forEach(function(r){return t.addTest(r)})}return h()(r,[{key:"addTest",value:function(r){if("string"==typeof r){var n=oe[r];if(!n)throw new Error("Cannot make unknown test type: ".concat(r));r=new n.constructor}else if(!(r instanceof Qn))throw new Error("Must specify test as name or instance");return this._tests.push(r),r}},{key:"run",value:function(){var r=this,n=[];return this._tests.forEach(function(e){r.groups.data.forEach(function(t){n.push(r._runOne.bind(r,e,t))})}),n.reduce(function(r,n){return r.then(function(r){return n().then(function(n){return[].concat(a()(r),[n])})})},Promise.resolve([]))}},{key:"_runOne",value:function(r,n){var e=n.variants,t=this.variants.getScores(e),i=this.variants.isAltEffect(e),o=this.groups.makeCovarianceMatrix(n,i),a=this.variants.getEffectFreq(e),u=r.run(t,o,void 0,a);return Promise.resolve(u).then(function(e){var t=c()(e,2),i=t[0],o=t[1];return{groupType:n.groupType,group:n.group,mask:n.mask,variants:n.variants,test:r.key,stat:i,pvalue:o}})}},{key:"toJSON",value:function(r){var n=this;return(r=r?Promise.resolve(r):this.run()).then(function(r){return{data:{variants:n.variants.data,groups:r}}})}}]),r}();function se(r){var n=r.data||r;return[new ue(n.groups.map(function(r){return r.nSamples=n.nSamples,r.sigmaSquared=n.sigmaSquared,r})),new ae(n.variants)]}e.d(n,"helpers",function(){return i}),e.d(n,"stats",function(){return t})}])});
//# sourceMappingURL=raremetal.min.js.map
