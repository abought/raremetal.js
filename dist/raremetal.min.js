!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.raremetal=e():r.raremetal=e()}("undefined"!=typeof self?self:this,function(){return function(r){var e={};function n(t){if(e[t])return e[t].exports;var i=e[t]={i:t,l:!1,exports:{}};return r[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=r,n.c=e,n.d=function(r,e,t){n.o(r,e)||Object.defineProperty(r,e,{configurable:!1,enumerable:!0,get:t})},n.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(e,"a",e),e},n.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},n.p="",n(n.s=2)}([function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,e){var n,t,i;for(void 0===e&&(e=15),t=.5,n=new Date;;){for(i=t*=2;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(new Date-n>e)break}for(i=t;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*t-1)/(new Date-n)},numeric._myIndexOf=function(r){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){var e=[];return function r(n){var t;if(void 0===n)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return e.push('"'+n+'"'),!1;if("boolean"==typeof n)return e.push(n.toString()),!1;if("number"==typeof n){var i=function r(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+r(-e);if(isFinite(e)){var n=Math.floor(Math.log(e)/Math.log(10)),t=e/Math.pow(10,n),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,i=(t=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}(n),o=n.toPrecision(numeric.precision),u=parseFloat(n.toString()).toString(),a=[i,o,u,parseFloat(o).toString(),parseFloat(u).toString()];for(t=1;t<a.length;t++)a[t].length<i.length&&(i=a[t]);return e.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===n)return e.push("null"),!1;if("function"==typeof n){e.push(n.toString());var c=!1;for(t in n)n.hasOwnProperty(t)&&(c?e.push(",\n"):e.push("\n{"),c=!0,e.push(t),e.push(": \n"),r(n[t]));return c&&e.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return e.push("...Large Array..."),!0;for(c=!1,e.push("["),t=0;t<n.length;t++)t>0&&(e.push(","),c&&e.push("\n ")),c=r(n[t]);return e.push("]"),!0}e.push("{");c=!1;for(t in n)n.hasOwnProperty(t)&&(c&&e.push(",\n"),c=!0,e.push(t),e.push(": \n"),r(n[t]));return e.push("}"),!0}(r),e.join("")},numeric.parseDate=function(r){return function r(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,t=[];for(n=0;n<e.length;n++)t[n]=r(e[n]);return t}(r)},numeric.parseFloat=function(r){return function r(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,t=[];for(n=0;n<e.length;n++)t[n]=r(e[n]);return t}(r)},numeric.parseCSV=function(r){var e,n,t,i=r.split("\n"),o=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,c=0;for(n=0;n<i.length;n++){var f,s=(i[n]+",").match(u);if(s.length>0){for(o[c]=[],e=0;e<s.length;e++)f=(t=s[e]).substr(0,t.length-1),a.test(f)?o[c][e]=parseFloat(f):o[c][e]=f;c++}}return o},numeric.toCSV=function(r){var e,n,t,i,o,u=numeric.dim(r);for(t=u[0],u[1],o=[],e=0;e<t;e++){for(i=[],n=0;n<t;n++)i[n]=r[e][n].toString();o[e]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(r){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.send(),e},numeric.imageURL=function(r){function e(r,e,n){void 0===e&&(e=0),void 0===n&&(n=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;r.length;for(t=e;t<n;t++)o=o>>>8^i[255&(o^r[t])];return-1^o}var n,t,i,o,u,a,c,f,s,m,h=r[0].length,l=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,l>>24&255,l>>16&255,l>>8&255,255&l,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=e(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,n=1,t=0,c=0;c<h;c++){for(c<h-1?p.push(0):p.push(1),u=3*l+1+(0===c)&255,a=3*l+1+(0===c)>>8&255,p.push(u),p.push(a),p.push(255&~u),p.push(255&~a),0===c&&p.push(0),f=0;f<l;f++)for(i=0;i<3;i++)t=(t+(n=(n+(u=(u=r[i][c][f])>255?255:u<0?0:Math.round(u)))%65521))%65521,p.push(u);p.push(0)}return s=(t<<16)+n,p.push(s>>24&255),p.push(s>>16&255),p.push(s>>8&255),p.push(255&s),o=p.length-41,p[33]=o>>24&255,p[34]=o>>16&255,p[35]=o>>8&255,p[36]=255&o,m=e(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(r){var e,n,t,i,o,u,a,c=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(e=0;e<c;e+=3)o=((3&(n=r[e]))<<4)+((t=r[e+1])>>4),u=((15&t)<<2)+((i=r[e+2])>>6),a=63&i,e+1>=c?u=a=64:e+2>=c&&(a=64),s+=f.charAt(n>>2)+f.charAt(o)+f.charAt(u)+f.charAt(a);return s}(p)},numeric._dim=function(r){for(var e=[];"object"==typeof r;)e.push(r.length),r=r[0];return e},numeric.dim=function(r){var e;return"object"==typeof r?"object"==typeof(e=r[0])?"object"==typeof e[0]?numeric._dim(r):[r.length,e.length]:[r.length]:[]},numeric.mapreduce=function(r,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(e,n){var t,i;if(!(e instanceof Array&&n instanceof Array))return!1;if((i=e.length)!==n.length)return!1;for(t=0;t<i;t++)if(e[t]!==n[t]){if("object"!=typeof e[t])return!1;if(!r(e[t],n[t]))return!1}return!0},numeric.rep=function(r,e,n){void 0===n&&(n=0);var t,i=r[n],o=Array(i);if(n===r.length-1){for(t=i-2;t>=0;t-=2)o[t+1]=e,o[t]=e;return-1===t&&(o[0]=e),o}for(t=i-1;t>=0;t--)o[t]=numeric.rep(r,e,n+1);return o},numeric.dotMMsmall=function(r,e){var n,t,i,o,u,a,c,f,s,m,h;for(o=r.length,u=e.length,a=e[0].length,c=Array(o),n=o-1;n>=0;n--){for(f=Array(a),s=r[n],i=a-1;i>=0;i--){for(m=s[u-1]*e[u-1][i],t=u-2;t>=1;t-=2)h=t-1,m+=s[t]*e[t][i]+s[h]*e[h][i];0===t&&(m+=s[0]*e[0][i]),f[i]=m}c[n]=f}return c},numeric._getCol=function(r,e,n){var t;for(t=r.length-1;t>0;--t)n[t]=r[t][e],n[--t]=r[t][e];0===t&&(n[0]=r[0][e])},numeric.dotMMbig=function(r,e){var n,t,i,o=numeric._getCol,u=e.length,a=Array(u),c=r.length,f=e[0].length,s=new Array(c),m=numeric.dotVV;for(--u,t=--c;-1!==t;--t)s[t]=Array(f);for(t=--f;-1!==t;--t)for(o(e,t,a),i=c;-1!==i;--i)0,n=r[i],s[i][t]=m(n,a);return s},numeric.dotMV=function(r,e){var n,t=r.length,i=(e.length,Array(t)),o=numeric.dotVV;for(n=t-1;n>=0;n--)i[n]=o(r[n],e);return i},numeric.dotVM=function(r,e){var n,t,i,o,u,a,c;for(i=r.length,o=e[0].length,u=Array(o),t=o-1;t>=0;t--){for(a=r[i-1]*e[i-1][t],n=i-2;n>=1;n-=2)c=n-1,a+=r[n]*e[n][t]+r[c]*e[c][t];0===n&&(a+=r[0]*e[0][t]),u[t]=a}return u},numeric.dotVV=function(r,e){var n,t,i=r.length,o=r[i-1]*e[i-1];for(n=i-2;n>=1;n-=2)t=n-1,o+=r[n]*e[n]+r[t]*e[t];return 0===n&&(o+=r[0]*e[0]),o},numeric.dot=function(r,e){var n=numeric.dim;switch(1e3*n(r).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(r,e):numeric.dotMMbig(r,e);case 2001:return numeric.dotMV(r,e);case 1002:return numeric.dotVM(r,e);case 1001:return numeric.dotVV(r,e);case 1e3:return numeric.mulVS(r,e);case 1:return numeric.mulSV(r,e);case 0:return r*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var e,n,t,i,o=r.length,u=Array(o);for(e=o-1;e>=0;e--){for(i=Array(o),n=e+2,t=o-1;t>=n;t-=2)i[t]=0,i[t-1]=0;for(t>e&&(i[t]=0),i[e]=r[e],t=e-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),u[e]=i}return u},numeric.getDiag=function(r){var e,n=Math.min(r.length,r[0].length),t=Array(n);for(e=n-1;e>=1;--e)t[e]=r[e][e],t[--e]=r[e][e];return 0===e&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,e,n){void 0===n&&(n="");var t,i,o=[],u=/\[i\]$/,a="",c=!1;for(t=0;t<r.length;t++)u.test(r[t])?a=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(c=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(c?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,e,n){void 0===n&&(n="");var t,i,o=[],u=/\[i\]$/,a="",c=!1;for(t=0;t<r.length;t++)u.test(r[t])?a=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(c=!0),o.push(i);return o[r.length]="var _n = "+a+".length;\nvar i"+(c?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function r(e,n,t,i,o){var u;if(i!==t.length-1)for(u=t[i]-1;u>=0;u--)r("object"==typeof e?e[u]:e,"object"==typeof n?n[u]:n,t,i+1,o);else o(e,n)},numeric._biforeach2=function r(e,n,t,i,o){if(i===t.length-1)return o(e,n);var u,a=t[i],c=Array(a);for(u=a-1;u>=0;--u)c[u]=r("object"==typeof e?e[u]:e,"object"==typeof n?n[u]:n,t,i+1,o);return c},numeric._foreach=function r(e,n,t,i){var o;if(t!==n.length-1)for(o=n[t]-1;o>=0;o--)r(e[o],n,t+1,i);else i(e)},numeric._foreach2=function r(e,n,t,i){if(t===n.length-1)return i(e);var o,u=n[t],a=Array(u);for(o=u-1;o>=0;o--)a[o]=r(e[o],n,t+1,i);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,e;for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],numeric.ops2[e]=e;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){e=numeric.ops2[r];var n,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+e+" = Math."+e+";\n",n=function(r,n,t){return r+" = "+e+"("+n+","+t+")"},t=function(r,n){return r+" = "+e+"("+r+","+n+")"}):(n=function(r,n,t){return r+" = "+n+" "+e+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+e+"= "+n}:function(r,n){return r+" = "+r+" "+e+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],delete numeric.ops2[e];for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],numeric.ops1[e]=e;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",e=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],delete numeric.ops1[e];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(e=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[r]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,e){return"object"==typeof r?"object"==typeof e?numeric.truncVV(r,e):numeric.truncVS(r,e):"object"==typeof e?numeric.truncSV(r,e):Math.round(r/e)*e},numeric.inv=function(r){var e,n,t,i,o,u,a,c=numeric.dim(r),f=Math.abs,s=c[0],m=c[1],h=numeric.clone(r),l=numeric.identity(s);for(u=0;u<m;++u){var p=-1,g=-1;for(o=u;o!==s;++o)(a=f(h[o][u]))>g&&(p=o,g=a);for(n=h[p],h[p]=h[u],h[u]=n,i=l[p],l[p]=l[u],l[u]=i,r=n[u],a=u;a!==m;++a)n[a]/=r;for(a=m-1;-1!==a;--a)i[a]/=r;for(o=s-1;-1!==o;--o)if(o!==u){for(e=h[o],t=l[o],r=e[u],a=u+1;a!==m;++a)e[a]-=n[a]*r;for(a=m-1;a>0;--a)t[a]-=i[a]*r,t[--a]-=i[a]*r;0===a&&(t[0]-=i[0]*r)}}return l},numeric.det=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,t,i,o,u,a,c,f,s=e[0],m=1,h=numeric.clone(r);for(t=0;t<s-1;t++){for(i=t,n=t+1;n<s;n++)Math.abs(h[n][t])>Math.abs(h[i][t])&&(i=n);for(i!==t&&(c=h[i],h[i]=h[t],h[t]=c,m*=-1),o=h[t],n=t+1;n<s;n++){for(a=(u=h[n])[t]/o[t],i=t+1;i<s-1;i+=2)f=i+1,u[i]-=o[i]*a,u[f]-=o[f]*a;i!==s&&(u[i]-=o[i]*a)}if(0===o[t])return 0;m*=o[t]}return m*h[t][t]},numeric.transpose=function(r){var e,n,t,i,o,u=r.length,a=r[0].length,c=Array(a);for(n=0;n<a;n++)c[n]=Array(u);for(e=u-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=a-1;n>=1;--n)(o=c[n])[e]=i[n],o[e-1]=t[n],(o=c[--n])[e]=i[n],o[e-1]=t[n];0===n&&((o=c[0])[e]=i[0],o[e-1]=t[0])}if(0===e){for(t=r[0],n=a-1;n>=1;--n)c[n][0]=t[n],c[--n][0]=t[n];0===n&&(c[0][0]=t[0])}return c},numeric.negtranspose=function(r){var e,n,t,i,o,u=r.length,a=r[0].length,c=Array(a);for(n=0;n<a;n++)c[n]=Array(u);for(e=u-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=a-1;n>=1;--n)(o=c[n])[e]=-i[n],o[e-1]=-t[n],(o=c[--n])[e]=-i[n],o[e-1]=-t[n];0===n&&((o=c[0])[e]=-i[0],o[e-1]=-t[0])}if(0===e){for(t=r[0],n=a-1;n>=1;--n)c[n][0]=-t[n],c[--n][0]=-t[n];0===n&&(c[0][0]=-t[0])}return c},numeric._random=function r(e,n){var t,i,o=e[n],u=Array(o);if(n===e.length-1){for(i=Math.random,t=o-1;t>=1;t-=2)u[t]=i(),u[t-1]=i();return 0===t&&(u[0]=i()),u}for(t=o-1;t>=0;t--)u[t]=r(e,n+1);return u},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,e,n){if(void 0===n&&(n=Math.max(Math.round(e-r)+1,1)),n<2)return 1===n?[r]:[];var t,i=Array(n);for(t=--n;t>=0;t--)i[t]=(t*e+(n-t)*r)/n;return i},numeric.getBlock=function(r,e,n){var t=numeric.dim(r);return function r(i,o){var u,a=e[o],c=n[o]-a,f=Array(c);if(o===t.length-1){for(u=c;u>=0;u--)f[u]=i[u+a];return f}for(u=c;u>=0;u--)f[u]=r(i[u+a],o+1);return f}(r,0)},numeric.setBlock=function(r,e,n,t){var i=numeric.dim(r);return function r(t,o,u){var a,c=e[u],f=n[u]-c;if(u===i.length-1)for(a=f;a>=0;a--)t[a+c]=o[a];for(a=f;a>=0;a--)r(t[a+c],o[a],u+1)}(r,t,0),r},numeric.getRange=function(r,e,n){var t,i,o,u,a=e.length,c=n.length,f=Array(a);for(t=a-1;-1!==t;--t)for(f[t]=Array(c),o=f[t],u=r[e[t]],i=c-1;-1!==i;--i)o[i]=u[n[i]];return f},numeric.blockMatrix=function(r){var e=numeric.dim(r);if(e.length<4)return numeric.blockMatrix([r]);var n,t,i,o,u,a=e[0],c=e[1];for(n=0,t=0,i=0;i<a;++i)n+=r[i][0].length;for(o=0;o<c;++o)t+=r[0][o][0].length;var f=Array(n);for(i=0;i<n;++i)f[i]=Array(t);var s,m,h,l,p,g=0;for(i=0;i<a;++i){for(s=t,o=c-1;-1!==o;--o)for(s-=(u=r[i][o])[0].length,h=u.length-1;-1!==h;--h)for(p=u[h],m=f[g+h],l=p.length-1;-1!==l;--l)m[s+l]=p[l];g+=r[i][0].length}return f},numeric.tensor=function(r,e){if("number"==typeof r||"number"==typeof e)return numeric.mul(r,e);var n=numeric.dim(r),t=numeric.dim(e);if(1!==n.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,u,a,c=n[0],f=t[0],s=Array(c);for(o=c-1;o>=0;o--){for(i=Array(f),a=r[o],u=f-1;u>=3;--u)i[u]=a*e[u],i[--u]=a*e[u],i[--u]=a*e[u],i[--u]=a*e[u];for(;u>=0;)i[u]=a*e[u],--u;s[o]=i}return s},numeric.T=function(r,e){this.x=r,this.y=e},numeric.t=function(r,e){return new numeric.T(r,e)},numeric.Tbinop=function(r,e,n,t,i){var o;numeric.indexOf;if("string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||e.indexOf(o)>=0||n.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,r.x),e(this.y,r.x)):new numeric.T(e(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),numeric.negtranspose(n)):new numeric.T(r(e))},numeric.Tunop=function(r,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if(void 0===r.y)return new numeric.T(numeric.inv(r.x));var e,n,t,i,o,u,a,c,f,s,m,h,l,p,g,d,v,y,x=r.x.length,M=numeric.identity(x),b=numeric.rep([x,x],0),w=numeric.clone(r.x),N=numeric.clone(r.y);for(f=0;f<x;f++){for(h=(p=w[f][f])*p+(g=N[f][f])*g,m=f,s=f+1;s<x;s++)(l=(p=w[s][f])*p+(g=N[s][f])*g)>h&&(m=s,h=l);for(m!==f&&(y=w[f],w[f]=w[m],w[m]=y,y=N[f],N[f]=N[m],N[m]=y,y=M[f],M[f]=M[m],M[m]=y,y=b[f],b[f]=b[m],b[m]=y),e=w[f],n=N[f],o=M[f],u=b[f],p=e[f],g=n[f],s=f+1;s<x;s++)d=e[s],v=n[s],e[s]=(d*p+v*g)/h,n[s]=(v*p-d*g)/h;for(s=0;s<x;s++)d=o[s],v=u[s],o[s]=(d*p+v*g)/h,u[s]=(v*p-d*g)/h;for(s=f+1;s<x;s++){for(t=w[s],i=N[s],a=M[s],c=b[s],p=t[f],g=i[f],m=f+1;m<x;m++)d=e[m],v=n[m],t[m]-=d*p-v*g,i[m]-=v*p+d*g;for(m=0;m<x;m++)d=o[m],v=u[m],a[m]-=d*p-v*g,c[m]-=v*p+d*g}}for(f=x-1;f>0;f--)for(o=M[f],u=b[f],s=f-1;s>=0;s--)for(a=M[s],c=b[s],p=w[s][f],g=N[s][f],m=x-1;m>=0;m--)d=o[m],v=u[m],a[m]-=p*d-g*v,c[m]-=p*v+g*d;return new numeric.T(M,b)},numeric.T.prototype.get=function(r){var e,n=this.x,t=this.y,i=0,o=r.length;if(t){for(;i<o;)n=n[e=r[i]],t=t[e],i++;return new numeric.T(n,t)}for(;i<o;)n=n[e=r[i]],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,e){var n,t=this.x,i=this.y,o=0,u=r.length,a=e.x,c=e.y;if(0===u)return c?this.y=c:i&&(this.y=void 0),this.x=t,this;if(c){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);o<u-1;)t=t[n=r[o]],i=i[n],o++;return t[n=r[o]]=a,i[n]=c,this}if(i){for(;o<u-1;)t=t[n=r[o]],i=i[n],o++;return t[n=r[o]]=a,a instanceof Array?i[n]=numeric.rep(numeric.dim(a),0):i[n]=0,this}for(;o<u-1;)t=t[n=r[o]],o++;return t[n=r[o]]=a,this},numeric.T.prototype.getRows=function(r,e){var n,t,i=e-r+1,o=Array(i),u=this.x,a=this.y;for(n=r;n<=e;n++)o[n-r]=u[n];if(a){for(t=Array(i),n=r;n<=e;n++)t[n-r]=a[n];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,e,n){var t,i=this.x,o=this.y,u=n.x,a=n.y;for(t=r;t<=e;t++)i[t]=u[t-r];if(a)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),t=r;t<=e;t++)o[t]=a[t-r];else if(o)for(t=r;t<=e;t++)o[t]=numeric.rep([u[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var e=this.x,n=this.y;return n?new numeric.T(e[r],n[r]):new numeric.T(e[r])},numeric.T.prototype.setRow=function(r,e){var n=this.x,t=this.y,i=e.x,o=e.y;return n[r]=i,o?(t||(t=numeric.rep(numeric.dim(n),0),this.y=t),t[r]=o):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,e){var n=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(n,r,e),i(t,r,e)):new numeric.T(i(n,r,e))},numeric.T.prototype.setBlock=function(r,e,n){n instanceof numeric.T||(n=new numeric.T(n));var t=this.x,i=this.y,o=numeric.setBlock,u=n.x,a=n.y;if(a)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(t,r,e,u),o(i,r,e,a),this;o(t,r,e,u),i&&o(i,r,e,numeric.rep(numeric.dim(u),0))},numeric.T.rep=function(r,e){var n=numeric.T;e instanceof n||(e=new n(e));var t=e.x,i=e.y,o=numeric.rep;return i?new n(o(r,t),o(r,i)):new n(o(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var e=r.x,n=r.y,t=numeric.diag;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,e=this.x,n=this.y;return n?new r.T(r.getDiag(e),r.getDiag(n)):new r.T(r.getDiag(e))},numeric.house=function(r){var e=numeric.clone(r),n=(r[0]>=0?1:-1)*numeric.norm2(r);e[0]+=n;var t=numeric.norm2(e);if(0===t)throw new Error("eig: internal error");return numeric.div(e,t)},numeric.toUpperHessenberg=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,t,i,o,u,a,c,f,s,m,h=e[0],l=numeric.clone(r),p=numeric.identity(h);for(t=0;t<h-2;t++){for(o=Array(h-t-1),n=t+1;n<h;n++)o[n-t-1]=l[n][t];if(numeric.norm2(o)>0){for(u=numeric.house(o),a=numeric.getBlock(l,[t+1,t],[h-1,h-1]),c=numeric.tensor(u,numeric.dot(u,a)),n=t+1;n<h;n++)for(f=l[n],s=c[n-t-1],i=t;i<h;i++)f[i]-=2*s[i-t];for(a=numeric.getBlock(l,[0,t+1],[h-1,h-1]),c=numeric.tensor(numeric.dot(a,u),u),n=0;n<h;n++)for(f=l[n],s=c[n],i=t+1;i<h;i++)f[i]-=2*s[i-t-1];for(a=Array(h-t-1),n=t+1;n<h;n++)a[n-t-1]=p[n];for(c=numeric.tensor(u,numeric.dot(u,a)),n=t+1;n<h;n++)for(m=p[n],s=c[n-t-1],i=0;i<h;i++)m[i]-=2*s[i]}}return{H:l,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,e){void 0===e&&(e=1e4),r=numeric.clone(r);numeric.clone(r);var n,t,i,o,u,a,c,f,s,m,h,l,p,g,d,v,y,x,M=numeric.dim(r)[0],b=numeric.identity(M);if(M<3)return{Q:b,B:[[0,M-1]]};var w=numeric.epsilon;for(x=0;x<e;x++){for(v=0;v<M-1;v++)if(Math.abs(r[v+1][v])<w*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var N=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),e),k=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[M-1,M-1]),e);for(l=Array(v+1),d=0;d<=v;d++)l[d]=b[d];for(p=numeric.dot(N.Q,l),d=0;d<=v;d++)b[d]=p[d];for(l=Array(M-v-1),d=v+1;d<M;d++)l[d-v-1]=b[d];for(p=numeric.dot(k.Q,l),d=v+1;d<M;d++)b[d]=p[d-v-1];return{Q:b,B:N.B.concat(numeric.add(k.B,v+1))}}var T,A,j;if(i=r[M-2][M-2],o=r[M-2][M-1],u=r[M-1][M-2],f=i+(a=r[M-1][M-1]),c=i*a-o*u,s=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*c)T=.5*(f+Math.sqrt(f*f-4*c)),A=.5*(f-Math.sqrt(f*f-4*c)),s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,T+A)),numeric.diag(numeric.rep([3],T*A)));else s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,f)),numeric.diag(numeric.rep([3],c)));for(n=[s[0][0],s[1][0],s[2][0]],t=numeric.house(n),l=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(h=r[d],g=p[d],y=0;y<M;y++)h[y]-=2*g[y];for(l=numeric.getBlock(r,[0,0],[M-1,2]),p=numeric.tensor(numeric.dot(l,t),t),d=0;d<M;d++)for(h=r[d],g=p[d],y=0;y<3;y++)h[y]-=2*g[y];for(l=[b[0],b[1],b[2]],p=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(m=b[d],g=p[d],y=0;y<M;y++)m[y]-=2*g[y];for(v=0;v<M-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(r[y+1][y])<w*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){N=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),e),k=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[M-1,M-1]),e);for(l=Array(y+1),d=0;d<=y;d++)l[d]=b[d];for(p=numeric.dot(N.Q,l),d=0;d<=y;d++)b[d]=p[d];for(l=Array(M-y-1),d=y+1;d<M;d++)l[d-y-1]=b[d];for(p=numeric.dot(k.Q,l),d=y+1;d<M;d++)b[d]=p[d-y-1];return{Q:b,B:N.B.concat(numeric.add(k.B,y+1))}}for(j=Math.min(M-1,v+3),n=Array(j-v),d=v+1;d<=j;d++)n[d-v-1]=r[d][v];for(t=numeric.house(n),l=numeric.getBlock(r,[v+1,v],[j,M-1]),p=numeric.tensor(t,numeric.dot(t,l)),d=v+1;d<=j;d++)for(h=r[d],g=p[d-v-1],y=v;y<M;y++)h[y]-=2*g[y-v];for(l=numeric.getBlock(r,[0,v+1],[M-1,j]),p=numeric.tensor(numeric.dot(l,t),t),d=0;d<M;d++)for(h=r[d],g=p[d],y=v+1;y<=j;y++)h[y]-=2*g[y-v-1];for(l=Array(j-v),d=v+1;d<=j;d++)l[d-v-1]=b[d];for(p=numeric.tensor(t,numeric.dot(t,l)),d=v+1;d<=j;d++)for(m=b[d],g=p[d-v-1],y=0;y<M;y++)m[y]-=2*g[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,e){var n,t,i,o,u,a,c,f,s,m,h,l,p,g,d,v,y=numeric.toUpperHessenberg(r),x=numeric.QRFrancis(y.H,e),M=numeric.T,b=r.length,w=x.B,N=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),k=new M(numeric.dot(x.Q,y.Q)),T=w.length,A=Math.sqrt;for(t=0;t<T;t++)if((n=w[t][0])===w[t][1]);else{if(o=n+1,u=N[n][n],a=N[n][o],c=N[o][n],f=N[o][o],0===a&&0===c)continue;(m=(s=-u-f)*s-4*(u*f-a*c))>=0?((d=(u-(h=s<0?-.5*(s-A(m)):-.5*(s+A(m))))*(u-h)+a*a)>(v=c*c+(f-h)*(f-h))?(p=(u-h)/(d=A(d)),g=a/d):(p=c/(v=A(v)),g=(f-h)/v),i=new M([[g,-p],[p,g]]),k.setRows(n,o,i.dot(k.getRows(n,o)))):(h=-.5*s,l=.5*A(-m),(d=(u-h)*(u-h)+a*a)>(v=c*c+(f-h)*(f-h))?(p=(u-h)/(d=A(d+l*l)),g=a/d,h=0,l/=d):(p=c/(v=A(v+l*l)),g=(f-h)/v,h=l/v,l=0),i=new M([[g,-p],[p,g]],[[h,l],[l,-h]]),k.setRows(n,o,i.dot(k.getRows(n,o))))}var j=k.dot(r).dot(k.transjugate()),S=(b=r.length,numeric.T.identity(b));for(o=0;o<b;o++)if(o>0)for(t=o-1;t>=0;t--){var _=j.get([t,t]),I=j.get([o,o]);numeric.neq(_.x,I.x)||numeric.neq(_.y,I.y)?(h=j.getRow(t).getBlock([t],[o-1]),l=S.getRow(o).getBlock([t],[o-1]),S.set([o,t],j.get([t,o]).neg().sub(h.dot(l)).div(_.sub(I)))):S.setRow(o,S.getRow(t))}for(o=0;o<b;o++)h=S.getRow(o),S.setRow(o,h.div(h.norm2()));return S=S.transpose(),S=k.transjugate().dot(S),{lambda:j.getDiag(),E:S}},numeric.ccsSparse=function(r){var e,n,t,i=r.length,o=[];for(n=i-1;-1!==n;--n)for(t in e=r[n]){for(t=parseInt(t);t>=o.length;)o[o.length]=0;0!==e[t]&&o[t]++}var u=o.length,a=Array(u+1);for(a[0]=0,n=0;n<u;++n)a[n+1]=a[n]+o[n];var c=Array(a[u]),f=Array(a[u]);for(n=i-1;-1!==n;--n)for(t in e=r[n])0!==e[t]&&(o[t]--,c[a[t]+o[t]]=n,f[a[t]+o[t]]=e[t]);return[a,c,f]},numeric.ccsFull=function(r){var e,n,t,i,o=r[0],u=r[1],a=r[2],c=numeric.ccsDim(r),f=c[0],s=c[1],m=numeric.rep([f,s],0);for(e=0;e<s;e++)for(t=o[e],i=o[e+1],n=t;n<i;++n)m[u[n]][e]=a[n];return m},numeric.ccsTSolve=function(r,e,n,t,i){var o,u,a,c,f,s,m,h=r[0],l=r[1],p=r[2],g=h.length-1,d=Math.max,v=0;function y(r){var e;if(0===n[r]){for(n[r]=1,e=h[r];e<h[r+1];++e)y(l[e]);i[v]=r,++v}}for(void 0===t&&(n=numeric.rep([g],0)),void 0===t&&(t=numeric.linspace(0,n.length-1)),void 0===i&&(i=[]),o=t.length-1;-1!==o;--o)y(t[o]);for(i.length=v,o=i.length-1;-1!==o;--o)n[i[o]]=0;for(o=t.length-1;-1!==o;--o)u=t[o],n[u]=e[u];for(o=i.length-1;-1!==o;--o){for(u=i[o],a=h[u],c=d(h[u+1],a),f=a;f!==c;++f)if(l[f]===u){n[u]/=p[f];break}for(m=n[u],f=a;f!==c;++f)(s=l[f])!==u&&(n[s]-=m*p[f])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,e,n,t,i,o){var u,a,c,f=0,s=i.length,m=this.k,h=this.k1,l=this.j;if(0===t[r])for(t[r]=1,l[0]=r,m[0]=a=e[r],h[0]=c=e[r+1];;)if(a>=c){if(i[s]=l[f],0===f)return;++s,a=m[--f],c=h[f]}else 0===t[u=o[n[a]]]?(t[u]=1,m[f]=a,l[++f]=u,a=e[u],h[f]=c=e[u+1]):++a},numeric.ccsLPSolve=function(r,e,n,t,i,o,u){var a,c,f,s,m,h,l,p,g,d=r[0],v=r[1],y=r[2],x=(d.length,e[0]),M=e[1],b=e[2];for(c=x[i],f=x[i+1],t.length=0,a=c;a<f;++a)u.dfs(o[M[a]],d,v,n,t,o);for(a=t.length-1;-1!==a;--a)n[t[a]]=0;for(a=c;a!==f;++a)n[s=o[M[a]]]=b[a];for(a=t.length-1;-1!==a;--a){for(m=d[s=t[a]],h=d[s+1],l=m;l<h;++l)if(o[v[l]]===s){n[s]/=y[l];break}for(g=n[s],l=m;l<h;++l)(p=o[v[l]])!==s&&(n[p]-=g*y[l])}return n},numeric.ccsLUP1=function(r,e){var n,t,i,o,u,a,c,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],g=m[0],d=m[1],v=m[2],y=numeric.rep([f],0),x=numeric.rep([f],0),M=numeric.ccsLPSolve,b=(Math.max,Math.abs),w=numeric.linspace(0,f-1),N=numeric.linspace(0,f-1),k=new numeric.ccsDFS(f);for(void 0===e&&(e=1),n=0;n<f;++n){for(M(s,r,y,x,n,N,k),o=-1,u=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=n||(a=b(y[i]))>o&&(u=i,o=a);for(b(y[n])<e*o&&(t=w[n],o=w[u],w[n]=o,N[o]=n,w[u]=t,N[t]=u,o=y[n],y[n]=y[u],y[u]=o),o=h[n],u=g[n],c=y[n],l[o]=w[n],p[o]=1,++o,t=x.length-1;-1!==t;--t)a=y[i=x[t]],x[t]=0,y[i]=0,i<=n?(d[u]=i,v[u]=a,++u):(l[o]=w[i],p[o]=a/c,++o);h[n+1]=o,g[n+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=N[l[t]];return{L:s,U:m,P:w,Pinv:N}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,e,n,t,i,o,u){var a,c,f,s=0,m=i.length,h=this.k,l=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,h[0]=c=e[o[r]],l[0]=f=e[o[r]+1];;){if(isNaN(c))throw new Error("Ow!");if(c>=f){if(i[m]=o[p[s]],0===s)return;++m,c=h[--s],f=l[s]}else 0===t[a=n[c]]?(t[a]=1,h[s]=c,p[++s]=a,c=e[a=o[a]],l[s]=f=e[a+1]):++c}},numeric.ccsLPSolve0=function(r,e,n,t,i,o,u,a){var c,f,s,m,h,l,p,g,d,v=r[0],y=r[1],x=r[2],M=(v.length,e[0]),b=e[1],w=e[2];for(f=M[i],s=M[i+1],t.length=0,c=f;c<s;++c)a.dfs(b[c],v,y,n,t,o,u);for(c=t.length-1;-1!==c;--c)n[u[m=t[c]]]=0;for(c=f;c!==s;++c)n[m=b[c]]=w[c];for(c=t.length-1;-1!==c;--c){for(g=u[m=t[c]],h=v[m],l=v[m+1],p=h;p<l;++p)if(y[p]===g){n[g]/=x[p];break}for(d=n[g],p=h;p<l;++p)n[y[p]]-=d*x[p];n[g]=d}},numeric.ccsLUP0=function(r,e){var n,t,i,o,u,a,c,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],g=m[0],d=m[1],v=m[2],y=numeric.rep([f],0),x=numeric.rep([f],0),M=numeric.ccsLPSolve0,b=(Math.max,Math.abs),w=numeric.linspace(0,f-1),N=numeric.linspace(0,f-1),k=new numeric.ccsDFS0(f);for(void 0===e&&(e=1),n=0;n<f;++n){for(M(s,r,y,x,n,N,w,k),o=-1,u=-1,t=x.length-1;-1!==t;--t)(i=x[t])<=n||(a=b(y[w[i]]))>o&&(u=i,o=a);for(b(y[w[n]])<e*o&&(t=w[n],o=w[u],w[n]=o,N[o]=n,w[u]=t,N[t]=u),o=h[n],u=g[n],c=y[w[n]],l[o]=w[n],p[o]=1,++o,t=x.length-1;-1!==t;--t)a=y[w[i=x[t]]],x[t]=0,y[w[i]]=0,i<=n?(d[u]=i,v[u]=a,++u):(l[o]=w[i],p[o]=a/c,++o);h[n+1]=o,g[n+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=N[l[t]];return{L:s,U:m,P:w,Pinv:N}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,e,n){var t=numeric.ccsDim(r),i=t[0],o=t[1];void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),void 0===n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var u,a,c,f,s=e.length,m=n.length,h=numeric.rep([o],0),l=[],p=[],g=[h,l,p],d=r[0],v=r[1],y=r[2],x=numeric.rep([i],0),M=0,b=numeric.rep([i],0);for(a=0;a<m;++a){var w=d[f=n[a]],N=d[f+1];for(u=w;u<N;++u)b[c=v[u]]=1,x[c]=y[u];for(u=0;u<s;++u)b[e[u]]&&(l[M]=u,p[M]=x[e[u]],++M);for(u=w;u<N;++u)b[c=v[u]]=0;h[a+1]=M}return g},numeric.ccsDot=function(r,e){var n,t,i,o,u,a,c,f,s,m,h,l=r[0],p=r[1],g=r[2],d=e[0],v=e[1],y=e[2],x=numeric.ccsDim(r),M=numeric.ccsDim(e),b=x[0],w=(x[1],M[1]),N=numeric.rep([b],0),k=numeric.rep([b],0),T=Array(b),A=numeric.rep([w],0),j=[],S=[],_=[A,j,S];for(i=0;i!==w;++i){for(o=d[i],u=d[i+1],s=0,t=o;t<u;++t)for(m=v[t],h=y[t],a=l[m],c=l[m+1],n=a;n<c;++n)0===k[f=p[n]]&&(T[s]=f,k[f]=1,s+=1),N[f]=N[f]+g[n]*h;for(u=(o=A[i])+s,A[i+1]=u,t=s-1;-1!==t;--t)h=o+t,n=T[t],j[h]=n,S[h]=N[n],k[n]=0,N[n]=0;A[i+1]=A[i]+s}return _},numeric.ccsLUPSolve=function(r,e){var n=r.L,t=r.U,i=(r.P,e[0]),o=!1;"object"!=typeof i&&(i=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],o=!0);var u,a,c,f,s,m,h=e[1],l=e[2],p=n[0].length-1,g=i.length-1,d=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),x=Array(p),M=numeric.rep([g+1],0),b=[],w=[],N=numeric.ccsTSolve,k=0;for(u=0;u<g;++u){for(s=0,c=i[u],f=i[u+1],a=c;a<f;++a)m=r.Pinv[h[a]],x[s]=m,y[m]=l[a],++s;for(x.length=s,N(n,y,d,x,v),a=x.length-1;-1!==a;--a)y[x[a]]=0;if(N(t,d,y,v,x),o)return y;for(a=v.length-1;-1!==a;--a)d[v[a]]=0;for(a=x.length-1;-1!==a;--a)m=x[a],b[k]=m,w[k]=y[m],y[m]=0,++k;M[u+1]=k}return[M,b,w]},numeric.ccsbinop=function(r,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var e,n=r[0],t=r[1],i=r[2],o=numeric.sup(t)+1,u=n.length,a=numeric.rep([o],0),c=Array(u),f=Array(u),s=numeric.rep([o],0);for(e=0;e<u;++e)s[t[e]]++;for(e=0;e<o;++e)a[e+1]=a[e]+s[e];var m,h,l=a.slice(0);for(e=0;e<u;++e)c[m=l[h=t[e]]]=n[e],f[m]=i[e],l[h]=l[h]+1;return[a,c,f]},numeric.ccsGather=function(r){var e,n,t,i,o,u=r[0],a=r[1],c=r[2],f=u.length-1,s=a.length,m=Array(s),h=Array(s),l=Array(s);for(o=0,e=0;e<f;++e)for(t=u[e],i=u[e+1],n=t;n!==i;++n)h[o]=e,m[o]=a[n],l[o]=c[n],++o;return[m,h,l]},numeric.sdim=function r(e,n,t){if(void 0===n&&(n=[]),"object"!=typeof e)return n;var i;for(i in void 0===t&&(t=0),t in n||(n[t]=0),e.length>n[t]&&(n[t]=e.length),e)e.hasOwnProperty(i)&&r(e[i],n,t+1);return n},numeric.sclone=function r(e,n,t){void 0===n&&(n=0),void 0===t&&(t=numeric.sdim(e).length);var i,o=Array(e.length);if(n===t-1){for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);return o}for(i in e)e.hasOwnProperty(i)&&(o[i]=r(e[i],n+1,t));return o},numeric.sdiag=function(r){var e,n,t=r.length,i=Array(t);for(e=t-1;e>=1;e-=2)n=e-1,i[e]=[],i[e][e]=r[e],i[n]=[],i[n][n]=r[n];return 0===e&&(i[0]=[],i[0][0]=r[e]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var e,n,t,i=[];r.length;for(e in r)if(r.hasOwnProperty(e))for(n in t=r[e])t.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][e]=t[n]);return i},numeric.sLUP=function(r,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,e){var n,t,i,o,u,a,c,f=r.length,s=(e.length,numeric.stranspose(e)),m=s.length,h=Array(f);for(i=f-1;i>=0;i--){for(c=[],n=r[i],u=m-1;u>=0;u--){for(o in a=0,t=s[u],n)n.hasOwnProperty(o)&&o in t&&(a+=n[o]*t[o]);a&&(c[u]=a)}h[i]=c}return h},numeric.sdotMV=function(r,e){var n,t,i,o,u=r.length,a=Array(u);for(t=u-1;t>=0;t--){for(i in o=0,n=r[t])n.hasOwnProperty(i)&&e[i]&&(o+=n[i]*e[i]);o&&(a[t]=o)}return a},numeric.sdotVM=function(r,e){var n,t,i,o,u=[];for(n in r)if(r.hasOwnProperty(n))for(t in i=e[n],o=r[n],i)i.hasOwnProperty(t)&&(u[t]||(u[t]=0),u[t]+=o*i[t]);return u},numeric.sdotVV=function(r,e){var n,t=0;for(n in r)r[n]&&e[n]&&(t+=r[n]*e[n]);return t},numeric.sdot=function(r,e){var n=numeric.sdim(r).length,t=numeric.sdim(e).length;switch(1e3*n+t){case 0:return r*e;case 1001:return numeric.sdotVV(r,e);case 2001:return numeric.sdotMV(r,e);case 1002:return numeric.sdotVM(r,e);case 2002:return numeric.sdotMM(r,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+t)}},numeric.sscatter=function(r){var e,n,t,i,o=r[0].length,u=r.length,a=[];for(n=o-1;n>=0;--n)if(r[u-1][n]){for(i=a,t=0;t<u-2;t++)i[e=r[t][n]]||(i[e]=[]),i=i[e];i[r[t][n]]=r[t+1][n]}return a},numeric.sgather=function r(e,n,t){var i,o,u;for(o in void 0===n&&(n=[]),void 0===t&&(t=[]),i=t.length,e)if(e.hasOwnProperty(o))if(t[i]=parseInt(o),"number"==typeof(u=e[o])){if(u){if(0===n.length)for(o=i+1;o>=0;--o)n[o]=[];for(o=i;o>=0;--o)n[o].push(t[o]);n[i+1].push(u)}}else r(u,n,t);return t.length>i&&t.pop(),n},numeric.cLU=function(r){var e,n,t,i,o,u,a=r[0],c=r[1],f=r[2],s=a.length,m=0;for(e=0;e<s;e++)a[e]>m&&(m=a[e]);m++;var h,l=Array(m),p=Array(m),g=numeric.rep([m],1/0),d=numeric.rep([m],-1/0);for(t=0;t<s;t++)e=a[t],(n=c[t])<g[e]&&(g[e]=n),n>d[e]&&(d[e]=n);for(e=0;e<m-1;e++)d[e]>d[e+1]&&(d[e+1]=d[e]);for(e=m-1;e>=1;e--)g[e]<g[e-1]&&(g[e-1]=g[e]);for(e=0;e<m;e++)p[e]=numeric.rep([d[e]-g[e]+1],0),l[e]=numeric.rep([e-g[e]],0),e-g[e]+1,d[e]-e+1;for(t=0;t<s;t++)p[e=a[t]][c[t]-g[e]]=f[t];for(e=0;e<m-1;e++)for(i=e-g[e],x=p[e],n=e+1;g[n]<=e&&n<m;n++)if(o=e-g[n],u=d[e]-e,h=(M=p[n])[o]/x[i]){for(t=1;t<=u;t++)M[t+o]-=h*x[t+i];l[n][e-g[n]]=h}var v,y,x=[],M=[],b=[],w=[],N=[],k=[];for(s=0,v=0,e=0;e<m;e++){for(i=g[e],o=d[e],y=p[e],n=e;n<=o;n++)y[n-i]&&(x[s]=e,M[s]=n,b[s]=y[n-i],s++);for(y=l[e],n=i;n<e;n++)y[n-i]&&(w[v]=e,N[v]=n,k[v]=y[n-i],v++);w[v]=e,N[v]=e,k[v]=1,v++}return{U:[x,M,b],L:[w,N,k]}},numeric.cLUsolve=function(r,e){var n,t,i=r.L,o=r.U,u=numeric.clone(e),a=i[0],c=i[1],f=i[2],s=o[0],m=o[1],h=o[2],l=s.length,p=(a.length,u.length);for(t=0,n=0;n<p;n++){for(;c[t]<n;)u[n]-=f[t]*u[c[t]],t++;t++}for(t=l-1,n=p-1;n>=0;n--){for(;m[t]>n;)u[n]-=h[t]*u[m[t]],t--;u[n]/=h[t],t--}return u},numeric.cgrid=function(r,e){"number"==typeof r&&(r=[r,r]);var n,t,i,o=numeric.rep(r,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,n){return e>=r[0]/2||n<r[1]/2};break;default:e=function(r,e){return!0}}for(i=0,n=1;n<r[0]-1;n++)for(t=1;t<r[1]-1;t++)e(n,t)&&(o[n][t]=i,i++);return o},numeric.cdelsq=function(r){var e,n,t,i,o,u=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(r),c=a[0],f=a[1],s=[],m=[],h=[];for(e=1;e<c-1;e++)for(n=1;n<f-1;n++)if(!(r[e][n]<0)){for(t=0;t<4;t++)i=e+u[t][0],o=n+u[t][1],r[i][o]<0||(s.push(r[e][n]),m.push(r[i][o]),h.push(-1));s.push(r[e][n]),m.push(r[e][n]),h.push(4)}return[s,m,h]},numeric.cdotMV=function(r,e){var n,t,i,o=r[0],u=r[1],a=r[2],c=o.length;for(i=0,t=0;t<c;t++)o[t]>i&&(i=o[t]);for(i++,n=numeric.rep([i],0),t=0;t<c;t++)n[o[t]]+=a[t]*e[u[t]];return n},numeric.Spline=function(r,e,n,t,i){this.x=r,this.yl=e,this.yr=n,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,e){var n,t,i,o=this.x,u=this.yl,a=this.yr,c=this.kl,f=this.kr,s=numeric.add,m=numeric.sub,h=numeric.mul;n=m(h(c[e],o[e+1]-o[e]),m(a[e+1],u[e])),t=s(h(f[e+1],o[e]-o[e+1]),m(a[e+1],u[e]));var l=(i=(r-o[e])/(o[e+1]-o[e]))*(1-i);return s(s(s(h(1-i,u[e]),h(i,a[e+1])),h(n,l*(1-i))),h(t,l*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var e,n,t,i=this.x,o=i.length,u=Math.floor;for(e=0,n=o-1;n-e>1;)i[t=u((e+n)/2)]<=r?e=t:n=t;return this._at(r,e)}o=r.length;var a,c=Array(o);for(a=o-1;-1!==a;--a)c[a]=this.at(r[a]);return c},numeric.Spline.prototype.diff=function(){var r,e,n,t=this.x,i=this.yl,o=this.yr,u=this.kl,a=this.kr,c=i.length,f=u,s=a,m=Array(c),h=Array(c),l=numeric.add,p=numeric.mul,g=numeric.div,d=numeric.sub;for(r=c-1;-1!==r;--r)e=t[r+1]-t[r],n=d(o[r+1],i[r]),m[r]=g(l(p(n,6),p(u[r],-4*e),p(a[r+1],-2*e)),e*e),h[r+1]=g(l(p(n,-6),p(u[r],2*e),p(a[r+1],4*e)),e*e);return new numeric.Spline(t,f,s,m,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var e=[],n=this.x,t=this.yl,i=this.yr,o=this.kl,u=this.kr;"number"==typeof t[0]&&(t=[t],i=[i],o=[o],u=[u]);var a,c,f,s,m,h,l,p,g,d,v,y,x,M,b,w,N,k,T,A,j,S,_,I=t.length,q=n.length-1,F=(e=Array(I),Math.sqrt);for(a=0;a!==I;++a){for(s=t[a],m=i[a],h=o[a],l=u[a],p=[],c=0;c!==q;c++){for(c>0&&m[c]*s[c]<0&&p.push(n[c]),w=n[c+1]-n[c],n[c],v=s[c],y=m[c+1],g=h[c]/w,x=(d=l[c+1]/w)+3*v+2*g-3*y,M=3*(d+g+2*(v-y)),(b=r(g-d+3*(v-y))+12*d*v)<=0?N=(k=x/M)>n[c]&&k<n[c+1]?[n[c],k,n[c+1]]:[n[c],n[c+1]]:(k=(x-F(b))/M,T=(x+F(b))/M,N=[n[c]],k>n[c]&&k<n[c+1]&&N.push(k),T>n[c]&&T<n[c+1]&&N.push(T),N.push(n[c+1])),j=N[0],k=this._at(j,c),f=0;f<N.length-1;f++)if(S=N[f+1],T=this._at(S,c),0!==k)if(0===T||k*T>0)j=S,k=T;else{for(var V=0;!((_=(k*S-T*j)/(k-T))<=j||_>=S);)if((A=this._at(_,c))*T>0)S=_,T=A,-1===V&&(k*=.5),V=-1;else{if(!(A*k>0))break;j=_,k=A,1===V&&(T*=.5),V=1}p.push(_),j=N[f+1],k=this._at(j,c)}else p.push(j),j=S,k=T;0===T&&p.push(S)}e[a]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(r,e,n,t){var i,o=r.length,u=[],a=[],c=[],f=numeric.sub,s=numeric.mul,m=numeric.add;for(i=o-2;i>=0;i--)a[i]=r[i+1]-r[i],c[i]=f(e[i+1],e[i]);"string"!=typeof n&&"string"!=typeof t||(n=t="periodic");var h=[[],[],[]];switch(typeof n){case"undefined":u[0]=s(3/(a[0]*a[0]),c[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/a[0],1/a[0]);break;case"string":u[0]=m(s(3/(a[o-2]*a[o-2]),c[o-2]),s(3/(a[0]*a[0]),c[0])),h[0].push(0,0,0),h[1].push(o-2,0,1),h[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:u[0]=n,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<o-1;i++)u[i]=m(s(3/(a[i-1]*a[i-1]),c[i-1]),s(3/(a[i]*a[i]),c[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof t){case"undefined":u[o-1]=s(3/(a[o-2]*a[o-2]),c[o-2]),h[0].push(o-1,o-1),h[1].push(o-2,o-1),h[2].push(1/a[o-2],2/a[o-2]);break;case"string":h[1][h[1].length-1]=0;break;default:u[o-1]=t,h[0].push(o-1),h[1].push(o-1),h[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var l=Array(u.length);if("string"==typeof n)for(i=l.length-1;-1!==i;--i)l[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),u[i]),l[i][o-1]=l[i][0];else for(i=l.length-1;-1!==i;--i)l[i]=numeric.cLUsolve(numeric.cLU(h),u[i]);return l="number"==typeof e[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,e,e,l,l)},numeric.fftpow2=function r(e,n){var t=e.length;if(1!==t){var i,o,u=Math.cos,a=Math.sin,c=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=e[i],m[o]=n[i],--i,c[o]=e[i],f[o]=n[i];r(c,f),r(s,m),o=t/2;var h,l,p,g=-6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),l=u(h=g*i),p=a(h),e[i]=c[o]+l*s[o]-p*m[o],n[i]=f[o]+l*m[o]+p*s[o]}},numeric._ifftpow2=function r(e,n){var t=e.length;if(1!==t){var i,o,u=Math.cos,a=Math.sin,c=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=e[i],m[o]=n[i],--i,c[o]=e[i],f[o]=n[i];r(c,f),r(s,m),o=t/2;var h,l,p,g=6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),l=u(h=g*i),p=a(h),e[i]=c[o]+l*s[o]-p*m[o],n[i]=f[o]+l*m[o]+p*s[o]}},numeric.ifftpow2=function(r,e){numeric._ifftpow2(r,e),numeric.diveq(r,r.length),numeric.diveq(e,e.length)},numeric.convpow2=function(r,e,n,t){var i,o,u,a,c;for(numeric.fftpow2(r,e),numeric.fftpow2(n,t),i=r.length-1;-1!==i;--i)o=r[i],a=e[i],u=n[i],c=t[i],r[i]=o*u-a*c,e[i]=o*c+a*u;numeric.ifftpow2(r,e)},numeric.T.prototype.fft=function(){var r,e,n=this.x,t=this.y,i=n.length,o=Math.log,u=o(2),a=Math.ceil(o(2*i-1)/u),c=Math.pow(2,a),f=numeric.rep([c],0),s=numeric.rep([c],0),m=Math.cos,h=Math.sin,l=-3.141592653589793/i,p=numeric.rep([c],0),g=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=n[r];if(void 0!==t)for(r=0;r<i;r++)g[r]=t[r];for(f[0]=1,r=1;r<=c/2;r++)e=l*r*r,f[r]=m(e),s[r]=h(e),f[c-r]=m(e),s[c-r]=h(e);var d=new numeric.T(p,g),v=new numeric.T(f,s);return d=d.mul(v),numeric.convpow2(d.x,d.y,numeric.clone(v.x),numeric.neg(v.y)),(d=d.mul(v)).x.length=i,d.y.length=i,d},numeric.T.prototype.ifft=function(){var r,e,n=this.x,t=this.y,i=n.length,o=Math.log,u=o(2),a=Math.ceil(o(2*i-1)/u),c=Math.pow(2,a),f=numeric.rep([c],0),s=numeric.rep([c],0),m=Math.cos,h=Math.sin,l=3.141592653589793/i,p=numeric.rep([c],0),g=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=n[r];if(void 0!==t)for(r=0;r<i;r++)g[r]=t[r];for(f[0]=1,r=1;r<=c/2;r++)e=l*r*r,f[r]=m(e),s[r]=h(e),f[c-r]=m(e),s[c-r]=h(e);var d=new numeric.T(p,g),v=new numeric.T(f,s);return d=d.mul(v),numeric.convpow2(d.x,d.y,numeric.clone(v.x),numeric.neg(v.y)),(d=d.mul(v)).x.length=i,d.y.length=i,d.div(i)},numeric.gradient=function(r,e){var n=e.length,t=r(e);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,o,u,a,c,f,s,m,h,l=Math.max,p=numeric.clone(e),g=Array(n),d=(numeric.div,numeric.sub,l=Math.max,Math.abs),v=Math.min,y=0;for(i=0;i<n;i++)for(var x=l(1e-6*t,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(p[i]=e[i]+x,o=r(p),p[i]=e[i]-x,u=r(p),p[i]=e[i],isNaN(o)||isNaN(u))x/=16;else{if(g[i]=(o-u)/(2*x),a=e[i]-x,c=e[i],f=e[i]+x,s=(o-t)/x,m=(t-u)/x,h=l(d(g[i]),d(t),d(o),d(u),d(a),d(c),d(f),1e-8),!(v(l(d(s-g[i]),d(m-g[i]),d(s-m))/h,x/h)>.001))break;x/=16}}return g},numeric.uncmin=function(r,e,n,t,i,o,u){var a=numeric.gradient;void 0===u&&(u={}),void 0===n&&(n=1e-8),void 0===t&&(t=function(e){return a(r,e)}),void 0===i&&(i=1e3);var c,f,s=(e=numeric.clone(e)).length,m=r(e);if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,l=numeric.norm2;n=h(n,numeric.epsilon);var p,g,d,v,y,x,M,b,w,N,k=u.Hinv||numeric.identity(s),T=numeric.dot,A=(numeric.inv,numeric.sub),j=numeric.add,S=numeric.tensor,_=numeric.div,I=numeric.mul,q=numeric.all,F=numeric.isFinite,V=numeric.neg,P=0,O="";for(g=t(e);P<i;){if("function"==typeof o&&o(P,e,m,g,k)){O="Callback returned true";break}if(!q(F(g))){O="Gradient has Infinity or NaN";break}if(!q(F(p=V(T(k,g))))){O="Search direction has Infinity or NaN";break}if((N=l(p))<n){O="Newton step smaller than tol";break}for(w=1,f=T(g,p),y=e;P<i&&!(w*N<n)&&(y=j(e,v=I(p,w)),(c=r(y))-m>=.1*w*f||isNaN(c));)w*=.5,++P;if(w*N<n){O="Line search step size smaller than tol";break}if(P===i){O="maxit reached during line search";break}k=A(j(k,I(((b=T(x=A(d=t(y),g),v))+T(x,M=T(k,x)))/(b*b),S(v,v))),_(j(S(M,v),S(v,M)),b)),e=y,m=c,g=d,++P}return{solution:e,f:m,gradient:g,invHessian:k,iterations:P,message:O}},numeric.Dopri=function(r,e,n,t,i,o,u){this.x=r,this.y=e,this.f=n,this.ymid=t,this.iterations=i,this.events=u,this.message=o},numeric.Dopri.prototype._at=function(r,e){function n(r){return r*r}var t,i,o,u,a,c,f,s,m,h=this.x,l=this.y,p=this.f,g=this.ymid,d=(h.length,Math.floor,numeric.add),v=numeric.mul,y=numeric.sub;return t=h[e],i=h[e+1],u=l[e],a=l[e+1],o=t+.5*(i-t),c=g[e],f=y(p[e],v(u,1/(t-o)+2/(t-i))),s=y(p[e+1],v(a,1/(i-o)+2/(i-t))),d(d(d(d(v(u,(m=[n(r-i)*(r-o)/n(t-i)/(t-o),n(r-t)*n(r-i)/n(t-o)/n(i-o),n(r-t)*(r-o)/n(i-t)/(i-o),(r-t)*n(r-i)*(r-o)/n(t-i)/(t-o),(r-i)*n(r-t)*(r-o)/n(t-i)/(i-o)])[0]),v(c,m[1])),v(a,m[2])),v(f,m[3])),v(s,m[4]))},numeric.Dopri.prototype.at=function(r){var e,n,t,i=Math.floor;if("number"!=typeof r){var o=r.length,u=Array(o);for(e=o-1;-1!==e;--e)u[e]=this.at(r[e]);return u}var a=this.x;for(e=0,n=a.length-1;n-e>1;)a[t=i(.5*(e+n))]<=r?e=t:n=t;return this._at(r,e)},numeric.dopri=function(r,e,n,t,i,o,u){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var a,c,f,s,m,h,l,p,g,d,v,y,x,M=[r],b=[n],w=[t(r,n)],N=[],k=[.075,.225],T=[44/45,-56/15,32/9],A=[19372/6561,-25360/2187,64448/6561,-212/729],j=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],_=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],I=[.2,.3,.8,8/9,1,1],q=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],F=0,V=(e-r)/10,P=0,O=numeric.add,L=numeric.mul,E=(Math.max,Math.min),U=Math.abs,Y=numeric.norminf,B=Math.pow,D=numeric.any,R=numeric.lt,X=numeric.and,Q=(numeric.sub,new numeric.Dopri(M,b,w,N,-1,""));for("function"==typeof u&&(v=u(r,n));r<e&&P<o;)if(++P,r+V>e&&(V=e-r),a=t(r+I[0]*V,O(n,L(.2*V,w[F]))),c=t(r+I[1]*V,O(O(n,L(k[0]*V,w[F])),L(k[1]*V,a))),f=t(r+I[2]*V,O(O(O(n,L(T[0]*V,w[F])),L(T[1]*V,a)),L(T[2]*V,c))),s=t(r+I[3]*V,O(O(O(O(n,L(A[0]*V,w[F])),L(A[1]*V,a)),L(A[2]*V,c)),L(A[3]*V,f))),m=t(r+I[4]*V,O(O(O(O(O(n,L(j[0]*V,w[F])),L(j[1]*V,a)),L(j[2]*V,c)),L(j[3]*V,f)),L(j[4]*V,s))),h=t(r+V,g=O(O(O(O(O(n,L(w[F],V*S[0])),L(c,V*S[2])),L(f,V*S[3])),L(s,V*S[4])),L(m,V*S[5]))),(d="number"==typeof(l=O(O(O(O(O(L(w[F],V*q[0]),L(c,V*q[2])),L(f,V*q[3])),L(s,V*q[4])),L(m,V*q[5])),L(h,V*q[6])))?U(l):Y(l))>i){if(r+(V=.2*V*B(i/d,.25))===r){Q.msg="Step size became too small";break}}else{if(N[F]=O(O(O(O(O(O(n,L(w[F],V*_[0])),L(c,V*_[2])),L(f,V*_[3])),L(s,V*_[4])),L(m,V*_[5])),L(h,V*_[6])),M[++F]=r+V,b[F]=g,w[F]=h,"function"==typeof u){var z,C,G=r,Z=r+.5*V;if(y=u(Z,N[F-1]),D(x=X(R(v,0),R(0,y)))||(G=Z,v=y,y=u(Z=r+V,g),x=X(R(v,0),R(0,y))),D(x)){for(var H,$,W=0,J=1,K=1;;){if("number"==typeof v)C=(K*y*G-J*v*Z)/(K*y-J*v);else for(C=Z,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(C=E(C,(K*y[p]*G-J*v[p]*Z)/(K*y[p]-J*v[p])));if(C<=G||C>=Z)break;$=u(C,z=Q._at(C,F-1)),D(H=X(R(v,0),R(0,$)))?(Z=C,y=$,x=H,K=1,-1===W?J*=.5:J=1,W=-1):(G=C,v=$,J=1,1===W?K*=.5:K=1,W=1)}return g=Q._at(.5*(r+C),F-1),Q.f[F]=t(C,z),Q.x[F]=C,Q.y[F]=z,Q.ymid[F-1]=g,Q.events=x,Q.iterations=P,Q}}r+=V,n=g,v=y,V=E(.8*V*B(i/d,.25),4*V)}return Q.iterations=P,Q},numeric.LU=function(r,e){e=e||!1;var n,t,i,o,u,a,c,f,s,m=Math.abs,h=r.length,l=h-1,p=new Array(h);for(e||(r=numeric.clone(r)),i=0;i<h;++i){for(c=i,s=m((a=r[i])[i]),t=i+1;t<h;++t)s<(o=m(r[t][i]))&&(s=o,c=t);for(p[i]=c,c!=i&&(r[i]=r[c],r[c]=a,a=r[i]),u=a[i],n=i+1;n<h;++n)r[n][i]/=u;for(n=i+1;n<h;++n){for(f=r[n],t=i+1;t<l;++t)f[t]-=f[i]*a[t],f[++t]-=f[i]*a[t];t===l&&(f[t]-=f[i]*a[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,e){var n,t,i,o,u,a=r.LU,c=a.length,f=numeric.clone(e),s=r.P;for(n=c-1;-1!==n;--n)f[n]=e[n];for(n=0;n<c;++n)for(i=s[n],s[n]!==n&&(u=f[n],f[n]=f[i],f[i]=u),o=a[n],t=0;t<n;++t)f[n]-=f[t]*o[t];for(n=c-1;n>=0;--n){for(o=a[n],t=n+1;t<c;++t)f[n]-=f[t]*o[t];f[n]/=o[n]}return f},numeric.solve=function(r,e,n){return numeric.LUsolve(numeric.LU(r,n),e)},numeric.echelonize=function(r){var e,n,t,i,o,u,a,c,f=numeric.dim(r),s=f[0],m=f[1],h=numeric.identity(s),l=Array(s),p=Math.abs,g=numeric.diveq;for(r=numeric.clone(r),e=0;e<s;++e){for(t=0,o=r[e],u=h[e],n=1;n<m;++n)p(o[t])<p(o[n])&&(t=n);for(l[e]=t,g(u,o[t]),g(o,o[t]),n=0;n<s;++n)if(n!==e){for(c=(a=r[n])[t],i=m-1;-1!==i;--i)a[i]-=o[i]*c;for(a=h[n],i=s-1;-1!==i;--i)a[i]-=u[i]*c}}return{I:h,A:r,P:l}},numeric.__solveLP=function(r,e,n,t,i,o,u){var a,c,f,s,m=numeric.sum,h=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,g=numeric.div,d=numeric.add,v=r.length,y=n.length,x=!1,M=1,b=(numeric.transpose(e),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),N=Math.abs,k=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,A=numeric.gt,j=Array(v),S=Array(y),_=(numeric.rep([y],1),numeric.solve),I=l(n,p(e,o)),q=p(r,r);for(f=0;f<i;++f){var F,V;for(F=y-1;-1!==F;--F)S[F]=g(e[F],I[F]);var P=b(S);for(F=v-1;-1!==F;--F)j[F]=m(P[F]);M=.25*N(q/p(r,j));var O=100*w(q/p(j,j));for((!isFinite(M)||M>O)&&(M=O),s=d(r,h(M,j)),c=p(P,S),F=v-1;-1!==F;--F)c[F][F]+=1;var L=g(I,p(e,V=_(c,g(s,M),!0))),E=1;for(F=y-1;-1!==F;--F)L[F]<0&&(E=k(E,-.999*L[F]));if(!T(A(I=l(n,p(e,a=l(o,h(V,E)))),0)))return{solution:o,message:"",iterations:f};if(o=a,M<t)return{solution:a,message:"",iterations:f};if(u){var U=p(r,s),Y=p(e,s);for(x=!0,F=y-1;-1!==F;--F)if(U*Y[F]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:a,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,e,n,t,i){var o=r.length,u=n.length,a=(numeric.sum,numeric.log,numeric.mul,numeric.sub),c=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),s=numeric.rep([u,1],-1),m=numeric.blockMatrix([[e,s]]),h=n,l=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(f,m,h,t,i,l,!1),g=numeric.clone(p.solution);if(g.length=o,numeric.inf(a(n,c(e,g)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var d=numeric.__solveLP(r,e,n,t,i-p.iterations,g,!0);return d.iterations+=p.iterations,d},numeric.solveLP=function(r,e,n,t,i,o,u){if(void 0===u&&(u=1e3),void 0===o&&(o=numeric.epsilon),void 0===t)return numeric._solveLP(r,e,n,o,u);var a,c=t.length,f=t[0].length,s=e.length,m=numeric.echelonize(t),h=numeric.rep([f],0),l=m.P,p=[];for(a=l.length-1;-1!==a;--a)h[l[a]]=1;for(a=f-1;-1!==a;--a)0===h[a]&&p.push(a);var g=numeric.getRange,d=numeric.linspace(0,c-1),v=numeric.linspace(0,s-1),y=g(t,d,p),x=g(e,v,l),M=g(e,v,p),b=numeric.dot,w=numeric.sub,N=b(x,m.I),k=w(M,b(N,y)),T=w(n,b(N,i)),A=Array(l.length),j=Array(p.length);for(a=l.length-1;-1!==a;--a)A[a]=r[l[a]];for(a=p.length-1;-1!==a;--a)j[a]=r[p[a]];var S=w(j,b(A,b(m.I,y))),_=numeric._solveLP(S,k,T,o,u),I=_.solution;if(I!=I)return _;var q=b(m.I,w(i,b(y,I))),F=Array(r.length);for(a=l.length-1;-1!==a;--a)F[l[a]]=q[a];for(a=p.length-1;-1!==a;--a)F[p[a]]=I[a];return{solution:F,message:_.message,iterations:_.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\n");var e,n,t,i,o=0,u=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],a=r.length,c=0,f={},s=[],m=0,h={},l=0,p=[],g=[],d=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+r[e]+"\nCurrent state: "+u[o]+"\n")}for(e=0;e<a;++e){var y=(t=r[e]).match(/\S*/g),x=[];for(n=0;n<y.length;++n)""!==y[n]&&x.push(y[n]);if(0!==x.length){for(n=0;n<u.length&&t.substr(0,u[n].length)!==u[n];++n);if(n<u.length){if(o=n,1===n&&(i=x[1]),6===n)return{name:i,c:p,A:numeric.transpose(g),b:d,rows:f,vars:h}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(x[0]){case"N":0===c?c=x[1]:v("Two or more N rows");break;case"L":f[x[1]]=m,s[m]=1,d[m]=0,++m;break;case"G":f[x[1]]=m,s[m]=-1,d[m]=0,++m;break;case"E":f[x[1]]=m,s[m]=0,d[m]=0,++m;break;default:v("Parse error "+numeric.prettyPrint(x))}break;case 3:h.hasOwnProperty(x[0])||(h[x[0]]=l,p[l]=0,g[l]=numeric.rep([m],0),++l);var M=h[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==c){var b=f[x[n]];g[M][b]=(s[b]<0?-1:1)*parseFloat(x[n+1])}else p[M]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)d[f[x[n]]]=(s[f[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,e,n,t,i,o,u){function a(r,e,n,t){for(r+="",n=0,t=0;t<r.length;t++)e[c(t)]=c((n^=19*e[c(t)])+r.charCodeAt(t));for(t in r="",e)r+=String.fromCharCode(e[t]);return r}function c(r){return r&n-1}e.seedrandom=function(t,f){var s,m=[];return t=a(function r(e,n,t,i,o){t=[];o=typeof e;if(n&&"object"==o)for(i in e)if(i.indexOf("S")<5)try{t.push(r(e[i],n-1))}catch(r){}return t.length?t:e+("string"!=o?"\0":"")}(f?[t,r]:arguments.length?t:[(new Date).getTime(),r,window],3),m),a((s=new function(r){var e,t,i=this,o=r.length,u=0,a=i.i=i.j=i.m=0;i.S=[],i.c=[],o||(r=[o++]);for(;u<n;)i.S[u]=u++;for(u=0;u<n;u++)e=i.S[u],a=c(a+e+r[u%o]),t=i.S[a],i.S[u]=t,i.S[a]=e;i.g=function(r){var e=i.S,t=c(i.i+1),o=e[t],u=c(i.j+o),a=e[u];e[t]=a,e[u]=o;for(var f=e[c(o+a)];--r;)t=c(t+1),o=e[t],u=c(u+o),a=e[u],e[t]=a,e[u]=o,f=f*n+e[c(o+a)];return i.i=t,i.j=u,f},i.g(n)}(m)).S,r),e.random=function(){for(var r=s.g(6),e=u,t=0;r<i;)r=(r+t)*n,e*=n,t=s.g(1);for(;r>=o;)r/=2,e/=2,t>>>=1;return(r+t)/e},t},u=e.pow(n,6),i=e.pow(2,i),o=2*i,a(e.random(),r)}([],numeric.seedrandom,256,0,52),function(r){function e(r){if("object"!=typeof r)return r;var n,t=[],i=r.length;for(n=0;n<i;n++)t[n+1]=e(r[n]);return t}function n(r){if("object"!=typeof r)return r;var e,t=[],i=r.length;for(e=1;e<i;e++)t[e-1]=n(r[e]);return t}function t(r,e,n,t,i,o,u,a,c,f,s,m,h,l,p,g){var d,v,y,x,M,b,w,N,k,T,A,j,S,_,I,q,F,V,P,O,L,E,U,Y,B,D,R;S=Math.min(t,f),y=2*t+S*(S+5)/2+2*f+1,Y=1e-60;do{B=1+.1*(Y+=Y),D=1+.2*Y}while(B<=1||D<=1);for(d=1;d<=t;d+=1)p[d]=e[d];for(d=t+1;d<=y;d+=1)p[d]=0;for(d=1;d<=f;d+=1)m[d]=0;if(M=[],0===g[1]){if(function(r,e,n,t){var i,o,u,a,c,f;for(o=1;o<=n;o+=1){if(t[1]=o,f=0,(u=o-1)<1){if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}else{for(a=1;a<=u;a+=1){for(c=r[a][o],i=1;i<a;i+=1)c-=r[i][o]*r[i][a];c/=r[a][a],r[a][o]=c,f+=c*c}if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}t[1]=0}}(r,0,t,M),0!==M[1])return void(g[1]=2);!function(r,e,n,t){var i,o,u,a;for(o=1;o<=n;o+=1){for(a=0,i=1;i<o;i+=1)a+=r[i][o]*t[i];t[o]=(t[o]-a)/r[o][o]}for(u=1;u<=n;u+=1)for(t[o=n+1-u]=t[o]/r[o][o],a=-t[o],i=1;i<o;i+=1)t[i]=t[i]+a*r[i][o]}(r,0,t,e),function(r,e,n){var t,i,o,u,a;for(o=1;o<=n;o+=1){for(r[o][o]=1/r[o][o],a=-r[o][o],t=1;t<o;t+=1)r[t][o]=a*r[t][o];if(n<(u=o+1))break;for(i=u;i<=n;i+=1)for(a=r[o][i],r[o][i]=0,t=1;t<=o;t+=1)r[t][i]=r[t][i]+a*r[t][o]}}(r,0,t)}else{for(v=1;v<=t;v+=1)for(i[v]=0,d=1;d<=v;d+=1)i[v]=i[v]+r[d][v]*e[d];for(v=1;v<=t;v+=1)for(e[v]=0,d=v;d<=t;d+=1)e[v]=e[v]+r[v][d]*i[d]}for(o[1]=0,v=1;v<=t;v+=1)for(i[v]=e[v],o[1]=o[1]+p[v]*i[v],p[v]=0,d=v+1;d<=t;d+=1)r[d][v]=0;for(o[1]=-o[1]/2,g[1]=0,_=(T=(k=(A=(N=(w=t)+t)+S)+S+1)+S*(S+1)/2)+f,d=1;d<=f;d+=1){for(q=0,v=1;v<=t;v+=1)q+=u[v][d]*u[v][d];p[_+d]=Math.sqrt(q)}function X(){for(l[1]=l[1]+1,y=T,d=1;d<=f;d+=1){for(y+=1,q=-a[d],v=1;v<=t;v+=1)q+=u[v][d]*i[v];if(Math.abs(q)<Y&&(q=0),d>s)p[y]=q;else if(p[y]=-Math.abs(q),q>0){for(v=1;v<=t;v+=1)u[v][d]=-u[v][d];a[d]=-a[d]}}for(d=1;d<=h;d+=1)p[T+m[d]]=0;for(j=0,I=0,d=1;d<=f;d+=1)p[T+d]<I*p[_+d]&&(j=d,I=p[T+d]/p[_+d]);return 0===j?999:0}function Q(){for(d=1;d<=t;d+=1){for(q=0,v=1;v<=t;v+=1)q+=r[v][d]*u[v][j];p[d]=q}for(x=w,d=1;d<=t;d+=1)p[x+d]=0;for(v=h+1;v<=t;v+=1)for(d=1;d<=t;d+=1)p[x+d]=p[x+d]+r[d][v]*p[v];for(E=!0,d=h;d>=1;d-=1){for(q=p[d],x=(y=k+d*(d+3)/2)-d,v=d+1;v<=h;v+=1)q-=p[y]*p[N+v],y+=v;if(q/=p[x],p[N+d]=q,m[d]<s)break;if(q<0)break;E=!1,b=d}if(!E)for(F=p[A+b]/p[N+b],d=1;d<=h&&!(m[d]<s)&&!(p[N+d]<0);d+=1)(I=p[A+d]/p[N+d])<F&&(F=I,b=d);for(q=0,d=w+1;d<=w+t;d+=1)q+=p[d]*p[d];if(Math.abs(q)<=Y){if(E)return g[1]=1,999;for(d=1;d<=h;d+=1)p[A+d]=p[A+d]-F*p[N+d];return p[A+h+1]=p[A+h+1]+F,700}for(q=0,d=1;d<=t;d+=1)q+=p[w+d]*u[d][j];for(V=-p[T+j]/q,U=!0,E||F<V&&(V=F,U=!1),d=1;d<=t;d+=1)i[d]=i[d]+V*p[w+d],Math.abs(i[d])<Y&&(i[d]=0);for(o[1]=o[1]+V*q*(V/2+p[A+h+1]),d=1;d<=h;d+=1)p[A+d]=p[A+d]-V*p[N+d];if(p[A+h+1]=p[A+h+1]+V,!U){for(q=-a[j],v=1;v<=t;v+=1)q+=i[v]*u[v][j];if(j>s)p[T+j]=q;else if(p[T+j]=-Math.abs(q),q>0){for(v=1;v<=t;v+=1)u[v][j]=-u[v][j];a[j]=-a[j]}return 700}for(m[h+=1]=j,y=k+(h-1)*h/2+1,d=1;d<=h-1;d+=1)p[y]=p[d],y+=1;if(h===t)p[y]=p[t];else{for(d=t;d>=h+1&&0!==p[d]&&(P=Math.max(Math.abs(p[d-1]),Math.abs(p[d])),O=Math.min(Math.abs(p[d-1]),Math.abs(p[d])),I=p[d-1]>=0?Math.abs(P*Math.sqrt(1+O*O/(P*P))):-Math.abs(P*Math.sqrt(1+O*O/(P*P))),P=p[d-1]/I,O=p[d]/I,1!==P);d-=1)if(0===P)for(p[d-1]=O*I,v=1;v<=t;v+=1)I=r[v][d-1],r[v][d-1]=r[v][d],r[v][d]=I;else for(p[d-1]=I,L=O/(1+P),v=1;v<=t;v+=1)I=P*r[v][d-1]+O*r[v][d],r[v][d]=L*(r[v][d-1]+I)-r[v][d],r[v][d-1]=I;p[y]=p[h]}return 0}function z(){if(0===p[x=(y=k+b*(b+1)/2+1)+b])return 798;if(P=Math.max(Math.abs(p[x-1]),Math.abs(p[x])),O=Math.min(Math.abs(p[x-1]),Math.abs(p[x])),I=p[x-1]>=0?Math.abs(P*Math.sqrt(1+O*O/(P*P))):-Math.abs(P*Math.sqrt(1+O*O/(P*P))),P=p[x-1]/I,O=p[x]/I,1===P)return 798;if(0===P){for(d=b+1;d<=h;d+=1)I=p[x-1],p[x-1]=p[x],p[x]=I,x+=d;for(d=1;d<=t;d+=1)I=r[d][b],r[d][b]=r[d][b+1],r[d][b+1]=I}else{for(L=O/(1+P),d=b+1;d<=h;d+=1)I=P*p[x-1]+O*p[x],p[x]=L*(p[x-1]+I)-p[x],p[x-1]=I,x+=d;for(d=1;d<=t;d+=1)I=P*r[d][b]+O*r[d][b+1],r[d][b+1]=L*(r[d][b]+I)-r[d][b+1],r[d][b]=I}return 0}function C(){for(x=y-b,d=1;d<=b;d+=1)p[x]=p[y],y+=1,x+=1;return p[A+b]=p[A+b+1],m[b]=m[b+1],(b+=1)<h?797:0}function G(){return p[A+h]=p[A+h+1],p[A+h+1]=0,m[h]=0,h-=1,l[2]=l[2]+1,0}for(h=0,l[1]=0,l[2]=0,R=0;;){if(999===(R=X()))return;for(;0!==(R=Q());){if(999===R)return;if(700===R)if(b===h)G();else{for(;z(),797===(R=C()););G()}}}}numeric.solveQP=function(r,i,o,u,a,c){r=e(r),i=e(i),o=e(o);var f,s,m,h,l,p=[],g=[],d=[],v=[],y=[];if(a=a||0,c=c?e(c):[void 0,0],u=u?e(u):[],s=r.length-1,m=o[1].length-1,!u)for(f=1;f<=m;f+=1)u[f]=0;for(f=1;f<=m;f+=1)g[f]=0;for(h=Math.min(s,m),f=1;f<=s;f+=1)d[f]=0;for(p[1]=0,f=1;f<=2*s+h*(h+5)/2+2*m+1;f+=1)v[f]=0;for(f=1;f<=2;f+=1)y[f]=0;return t(r,i,0,s,d,p,o,u,0,m,a,g,0,y,v,c),l="",1===c[1]&&(l="constraints are inconsistent, no solution!"),2===c[1]&&(l="matrix D in quadratic function is not positive definite!"),{solution:n(d),value:n(p),unconstrained_solution:n(i),iterations:n(y),iact:n(g),message:l}}}(),numeric.svd=function(r){var e,n=numeric.epsilon,t=1e-64/n,i=0,o=0,u=0,a=0,c=0,f=numeric.clone(r),s=f.length,m=f[0].length;if(s<m)throw"Need more rows than columns";var h=new Array(m),l=new Array(m);for(o=0;o<m;o++)h[o]=l[o]=0;var p=numeric.rep([m,m],0);function g(r,e){return(r=Math.abs(r))>(e=Math.abs(e))?r*Math.sqrt(1+e*e/r/r):0==e?r:e*Math.sqrt(1+r*r/e/e)}var d=0,v=0,y=0,x=0,M=0,b=0,w=0;for(o=0;o<m;o++){for(h[o]=v,w=0,c=o+1,u=o;u<s;u++)w+=f[u][o]*f[u][o];if(w<=t)v=0;else for(d=f[o][o],v=Math.sqrt(w),d>=0&&(v=-v),y=d*v-w,f[o][o]=d-v,u=c;u<m;u++){for(w=0,a=o;a<s;a++)w+=f[a][o]*f[a][u];for(d=w/y,a=o;a<s;a++)f[a][u]+=d*f[a][o]}for(l[o]=v,w=0,u=c;u<m;u++)w+=f[o][u]*f[o][u];if(w<=t)v=0;else{for(d=f[o][o+1],v=Math.sqrt(w),d>=0&&(v=-v),y=d*v-w,f[o][o+1]=d-v,u=c;u<m;u++)h[u]=f[o][u]/y;for(u=c;u<s;u++){for(w=0,a=c;a<m;a++)w+=f[u][a]*f[o][a];for(a=c;a<m;a++)f[u][a]+=w*h[a]}}(M=Math.abs(l[o])+Math.abs(h[o]))>x&&(x=M)}for(o=m-1;-1!=o;o+=-1){if(0!=v){for(y=v*f[o][o+1],u=c;u<m;u++)p[u][o]=f[o][u]/y;for(u=c;u<m;u++){for(w=0,a=c;a<m;a++)w+=f[o][a]*p[a][u];for(a=c;a<m;a++)p[a][u]+=w*p[a][o]}}for(u=c;u<m;u++)p[o][u]=0,p[u][o]=0;p[o][o]=1,v=h[o],c=o}for(o=m-1;-1!=o;o+=-1){for(c=o+1,v=l[o],u=c;u<m;u++)f[o][u]=0;if(0!=v){for(y=f[o][o]*v,u=c;u<m;u++){for(w=0,a=c;a<s;a++)w+=f[a][o]*f[a][u];for(d=w/y,a=o;a<s;a++)f[a][u]+=d*f[a][o]}for(u=o;u<s;u++)f[u][o]=f[u][o]/v}else for(u=o;u<s;u++)f[u][o]=0;f[o][o]+=1}for(n*=x,a=m-1;-1!=a;a+=-1)for(var N=0;N<50;N++){var k=!1;for(c=a;-1!=c;c+=-1){if(Math.abs(h[c])<=n){k=!0;break}if(Math.abs(l[c-1])<=n)break}if(!k){i=0,w=1;var T=c-1;for(o=c;o<a+1&&(d=w*h[o],h[o]=i*h[o],!(Math.abs(d)<=n));o++)for(y=g(d,v=l[o]),l[o]=y,i=v/y,w=-d/y,u=0;u<s;u++)M=f[u][T],b=f[u][o],f[u][T]=M*i+b*w,f[u][o]=-M*w+b*i}if(b=l[a],c==a){if(b<0)for(l[a]=-b,u=0;u<m;u++)p[u][a]=-p[u][a];break}if(N>=49)throw"Error: no convergence.";for(x=l[c],v=g(d=(((M=l[a-1])-b)*(M+b)+((v=h[a-1])-(y=h[a]))*(v+y))/(2*y*M),1),d=d<0?((x-b)*(x+b)+y*(M/(d-v)-y))/x:((x-b)*(x+b)+y*(M/(d+v)-y))/x,i=1,w=1,o=c+1;o<a+1;o++){for(v=h[o],M=l[o],y=w*v,v*=i,b=g(d,y),h[o-1]=b,d=x*(i=d/b)+v*(w=y/b),v=-x*w+v*i,y=M*w,M*=i,u=0;u<m;u++)x=p[u][o-1],b=p[u][o],p[u][o-1]=x*i+b*w,p[u][o]=-x*w+b*i;for(b=g(d,y),l[o-1]=b,d=(i=d/b)*v+(w=y/b)*M,x=-w*v+i*M,u=0;u<s;u++)M=f[u][o-1],b=f[u][o],f[u][o-1]=M*i+b*w,f[u][o]=-M*w+b*i}h[c]=0,h[a]=d,l[a]=x}for(o=0;o<l.length;o++)l[o]<n&&(l[o]=0);for(o=0;o<m;o++)for(u=o-1;u>=0;u--)if(l[u]<l[o]){for(i=l[u],l[u]=l[o],l[o]=i,a=0;a<f.length;a++)e=f[a][o],f[a][o]=f[a][u],f[a][u]=e;for(a=0;a<p.length;a++)e=p[a][o],p[a][o]=p[a][u],p[a][u]=e;o=u}return{U:f,S:l,V:p}}}).call(exports,__webpack_require__(4))},function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ScoreStatTable",function(){return f}),n.d(e,"GenotypeCovarianceMatrix",function(){return s}),n.d(e,"VariantMask",function(){return c}),n.d(e,"testBurden",function(){return m}),n.d(e,"testSkat",function(){return l}),n.d(e,"calcSkatWeights",function(){return h});var t=n(5),i=n(0),o=n.n(i),u=n(6);function a(r,e){for(let n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}class c{constructor(){this.groups=new Map,this.label=null,this.id=null}addVariantForGroup(r,e){if(this.groups.has(r))this.groups.get(r).push(e);else{let n=[e];this.groups.set(r,n)}}createGroup(r,e){this.groups.set(r,e)}size(){return this.groups.size}[Symbol.iterator](){return this.groups.entries()}getGroup(r){return this.groups.get(r)}}class f{constructor(){this.variants=[],this.positions=[],this.variantMap=new Map,this.positionMap=new Map,this.u=[],this.v=[],this.sampleSize=0,this.altFreq=[],this.effectAllele=[],this.effectAlleleFreq=[]}appendScore(r,e,n,t,i,o,u){this.variants.push(r),this.positions.push(e),this.variantMap.set(r,this.variants.length-1),this.positionMap.set(e,this.positions.length-1),this.u.push(n),this.v.push(t),this.altFreq.push(i),this.effectAllele.push(o),this.effectAlleleFreq.push(u)}getAltFreqForVariant(r){let e=this.altFreq[this.variantMap.get(r)];if(null==e)throw new Error("Variant did not exist when looking up alt allele freq: "+r);return e}getAltFreqForPosition(r){let e=this.altFreq[this.positionMap.get(r)];if(null==e)throw new Error("Position did not exist when looking up alt allele freq: "+r);return e}getVariantAtPosition(r){let e=this.variants(this.positionMap.get(r));if(null==e)throw new Error("Variant did not exist at position: "+r);return e}add(r){let e=this.dim();if(!a(e,r.dim()))throw"Scores cannot be added, dimensions are unequal";for(let n=0;n<e[0];n++){this.u[n]=this.u[n]+r.u[n],this.v[n]=this.v[n]+r.v[n];let e=this.sampleSize[n],t=r.sampleSize[n],i=e+t;this.sampleSize[n]=i,this.altFreq[n]=(this.altFreq[n]*e+r.altFreq[n]*t)/i}}dim(){return this.u.length}subsetToVariants(r){if(void 0===r)throw new Error("Must specify list of variants when subsetting");let e=(r=r.filter(r=>this.variantMap.has(r))).map(r=>this.variantMap.get(r)),n=e.map(r=>this.variants[r]),t=e.map(r=>this.positions[r]),i=e.map(r=>this.u[r]),o=e.map(r=>this.v[r]),u=e.map(r=>this.altFreq[r]),a=new Map(n.map((r,e)=>[r,e])),c=new Map(n.map((r,e)=>[r,e])),s=new f;return s.variants=n,s.positions=t,s.variantMap=a,s.positionMap=c,s.u=i,s.v=o,s.altFreq=u,s}}class s{constructor(r,e,n){this.matrix=r,this.variants=e,this.positions=n}isComplete(r,e,n,t){let i;void 0!==n&&(r=this.positions.get(n)),void 0!==t&&(e=this.positions.get(t));for(let n=0;n<r;n++)for(let r=0;r<e;r++)if(null==(i=this.matrix[n][r])||isNaN(i))return!1;return!0}dim(){return[this.matrix.length,this.matrix[0].length]}add(r){let e=this.dim();if(!a(e,r.dim()))throw"Covariance matrices cannot be added, dimensions are unequal";for(let n=0;n<e[0];n++)for(let t=0;t<e[1];t++)this.matrix[n][t]=this.matrix[n][t]+r.matrix[n][t]}}function m(r,e,n){for(let n of[r,e])if(!Array.isArray(n)||!n.length)throw"Please provide all required arrays";if(r.length!==e.length)throw"u and v must be same length";if(null!=n){if(n.length!==r.length)throw"w vector must be same length as score vector u"}else n=new Array(r.length).fill(1/r.length);let t=o.a.dot(n,r)/Math.sqrt(o.a.dot(o.a.dot(n,e),n));return[t,2*Object(u.c)(-Math.abs(t),0,1)]}function h(r,e=1,n=25){let t=Array(r.length).fill(NaN);for(let i=0;i<r.length;i++){let o=Object(u.a)(r[i],e,n);o*=o,t[i]=o}return t}function l(r,e,n,i="davies"){let u,a=o.a.dot(o.a.dot(r,o.a.diag(n)),r);try{let r=o.a.svd(e),t=o.a.sqrt(r.S),i=o.a.transpose(r.U),a=o.a.dot(o.a.dot(r.U,o.a.diag(t)),i),c=o.a.dot(a,o.a.diag(n)),f=o.a.dot(c,a),s=o.a.svd(f);u=o.a.abs(s.S)}catch(r){return console.log(r),[NaN,NaN]}if(o.a.sum(u)<1e-10)return console.error("Sum of lambda values for SKAT test is essentially zero"),[NaN,NaN];if("satterthwaite"===i)throw"Not implemented";if("davies"===i)return 1==u.length?p(u,a):function(r,e){let n=r.length,i=Array(n).fill(0),o=Array(n).fill(1),u=t.a(r,i,o,n,0,e,1e4,1e-4),a=u[0],c=1-a;if(c<=0||2===c){let f=0;for(;f<1e4&&(c<=0||2===c);)e*=.9999,u=t.a(r,i,o,n,0,e,1e4,1e-4),a=u[0],c=1-a,f+=1}return[e,c]}(u,a);if("liu"===i)return p(u,a);throw"Not implemented"}function p(r,e){let n=r.length,[t,i,o,a]=Array(4).fill(0);for(let e=0;e<n;e++){let n=r[e];t+=n,i+=n*n,o+=n*n*n,a+=n*n*n*n}let c,f,s,m=o/Math.sqrt(i*i*i),h=a/(i*i),l=(e-t)/Math.sqrt(2*i);m*m>h?f=(s=1/(m-Math.sqrt(m*m-h)))*s-2*(c=m*s*s*s-s*s):(s=1/m,c=0,f=i*i*i/(o*o));let p,g=f+c,d=l*(Math.sqrt(2)*s)+g;return[e,p=0===c?Object(u.b)(d,f,0,0):Object(u.b)(d,f,c,0,0)]}},function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=n(3),i=n(1);n.d(e,"helpers",function(){return t}),n.d(e,"stats",function(){return i})},function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"parsePortalJson",function(){return u}),n.d(e,"runAggregationTests",function(){return a}),n.d(e,"_example",function(){return c});var t=n(0),i=n.n(t),o=n(1);function u(r){let e={masks:{},scorecov:{}};const n=r.data;let t={};for(let r of n.masks){let e=new o.VariantMask;e.id=r.id,e.label=r.label;for(let[n,t]of Object.entries(r.groups))e.createGroup(n,t.variants);t[e.id]=e}e.masks=t;for(let r of n.scorecov){let n=t[r.mask].getGroup(r.group),u=n.map(r=>parseInt(r.match(/(chr)?(\w+):(\d+)_([A-Z]+)\/([A-Z]+)/)[3])),a=new o.ScoreStatTable;a.sampleSize=r.nsamples;for(let e=0;e<r.scores.length;e++){let t=e+1,i=r.covariance[t*(t+1)/2-1],o=r.altFreq[e],c=r.scores[e];o>.5&&(c=-c),a.appendScore(n[e],u[e],c,i,o)}const c=n.length;let f=new Array(c);for(let r=0;r<c;r++)f[r]=new Array(c).fill(null);const s=new Map;for(let r=0;r<c;r++){let e=n[r];s.set(e.pos,r)}let m=0;for(let e=0;e<c;e++)for(let n=e;n<c;n++){let t=r.covariance[m],i=a.altFreq[e],o=a.altFreq[n];e!==n&&i>.5^o>.5&&(t=-t),f[e][n]=t,f[n][e]=t,m+=1}f=i.a.mul(a.sampleSize,f);let h=new o.GenotypeCovarianceMatrix(f,n,s);e.scorecov[[r.mask,r.group]]={mask:r.mask,group:r.group,nsamples:r.nsamples,scores:a,covariance:h}}return e}function a(r,e,n){let t={data:{masks:[],results:[]}};Object.assign(t,n),t.data.masks=Object.values(e.masks);for(let n of Object.values(e.scorecov))for(let[e,i]of Object.entries(r)){let r,o;"function"==typeof i?r=i:"object"==typeof i&&(o=i.weights,r=i.test);let u,a={group:n.group,mask:n.mask,test:e,pvalue:NaN,stat:NaN};if(0===n.scores.u.length||0===n.covariance.matrix.length)continue;o&&(u=o(n.scores.altFreq.map(r=>Math.min(r,1-r))));let[c,f]=r(n.scores.u,n.covariance.matrix,u);a.pvalue=f,a.stat=c,t.data.results.push(a)}return t}async function c(r){r=r||"example.json";const e=await fetch(r,{credentials:"include"}),n=u(await e.json());return a({zegginiBurden:o.testBurden,skatLiu:{test:(r,e,n)=>Object(o.testSkat)(r,e,n,"liu"),weights:o.calcSkatWeights},skatDavies:{test:(r,e,n)=>Object(o.testSkat)(r,e,n,"davies"),weights:o.calcSkatWeights}},n,{id:100,description:"This is an example of running multiple tests and masks at once"})}},function(r,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(r){"object"==typeof window&&(n=window)}r.exports=n},function(r,e,n){"use strict";n.d(e,"a",function(){return q});const t=Math.PI,i=.0866;let o,u,a,c,f,s,m,h,l,p,g,d,v,y,x,M=0;function b(r){return r<-50?0:Math.exp(r)}function w(){if((M+=1)>l)throw new RangeError("Exceeded limit of "+l+" calls")}function N(r){return r*r}function k(r,e){if(Math.abs(r)>.1)return e?Math.log(1+r):Math.log(1+r)-r;{let n,t,i,o,u;for(i=2*function(r){return r*r*r}(o=r/(2+r)),u=3,n=(e?2:-r)*o,o=N(o),t=n+i/u;t!==n;t=n+i/u)u+=2,i*=o,n=t;return n}}function T(r){let e,n,t,i,u,a,c,f;for(w(),e=r*(a=r*o),r*=2,c=h-1;c>=0;c--)f=d[c],a+=(n=y[c])*((t=x[c])/(u=1-(i=r*n))+f)/u,e=e+t*N(i/u)+f*(N(i)/u+k(-i,!1));return[b(-.5*e),a]}function A(r,e){let n,t,i,o,f,s,m;function h(r){return[m,s]=T(r),m}for(n=0,f=c,t=e/(1+e*(i=2*(e>0?u:a)));h(t)>r;t=e/(1+e*i))n=e,f=s,e*=2;for(t=(f-c)/(s-c);t<.9;t=(f-c)/(s-c))t=(n+e)/2,[m,o]=T(t/(1+t*i)),m>r?(n=t,f=o):(e=t,s=o);return[s,e]}function j(r,e){let n,i,u,a,c,f,s,m,l,p,g,v,M,T;for(w(),n=0,a=0,c=0,T=0,u=2*(i=(o+e)*N(r)),r*=2,v=0;v<h;v++)f=y[v],s=x[v],M=d[v],n+=s*(m=N(r*f))/(1+m),m>1?(a+=M*Math.log(m),c+=M*k(m,!0),T+=M):u+=M*k(m,!0);return c=u+c,m=b(-(n*=.5)-.25*(a=u+a))/t,l=b(-n-.25*c)/t,p=0==T?1:2*m/T,(g=c>1?2.5*l:1)<p&&(p=g),p<(g=(m=.5*i)<=l?1:l/m)?p:g}function S(r,e){let n,t,i=[2,1.4,1.2,1.1];if(j(n=r/4,0)>e)for(n=r;j(n,0)>e;n=r)r*=4;else for(r=n,n/=4;j(n,0)<=e;n/=4)r=n;for(t=0;t<4;t++)j(n=r/i[t],0)<=e&&(r=n);return r}function _(r,e,n,i){let u,a,c,l,p,g,v,M,w,T,A;for(u=e/t,w=r;w>=0;w--){for(c=-2*(a=(w+.5)*e)*f,l=Math.abs(c),p=-.5*o*N(a),T=h-1;T>=0;T--)p-=.25*(A=d[T])*k(v=N(g=2*y[T]*a),!0),v=x[T]*g/(1+v),c+=M=A*Math.atan(g)+v,l+=Math.abs(M),p-=.5*g*v;g=u*b(p)/a,i||(g*=1-b(-.5*n*N(a))),c=Math.sin(.5*c)*g,s+=c,m+=l=.5*l*g}}function I(r){let e,n,o,u,a,c,f,s,m;for(w(),p&&function(){let r;r:for(let e=0;e<h;e++){let n=Math.abs(y[e]);for(let r=e-1;r>=0;r--){if(!(n>Math.abs(y[v[r]]))){v[r+1]=e;continue r}v[r+1]=v[r]}v[1+(r=-1)]=e}p=!1}(),e=Math.abs(r),u=r>0?1:-1,a=0,f=h-1;f>=0;f--)if(m=v[f],y[m]*u>0){if(!((n=e-(c=Math.abs(y[m]))*(d[m]+x[m]))>(o=c/i))){for(n>o&&(e=o),a=(e-n)/c,s=f-1;s>=0;s--)a+=d[v[s]]+x[v[s]];break}e=n}return a>100?(g=!0,1):Math.pow(2,a/4)/(t*N(e))}function q(r,e,n,i,b,w,k,T){let q,F,V,P,O,L,E,U,Y,B,D,R,X,Q,z,C,G,Z,H,$,W,J,K,rr=new Array(7).fill(0),er=[1,2,4,8];function nr(){return rr[6]=M,[J,K,rr]}for(M=0,h=i,f=w,d=n,y=r,x=e,K=0,s=0,m=0,J=-1,O=T,p=!0,g=!1,E=l=k,v=new Array(h).fill(NaN),R=o=N(b),u=0,a=0,c=0,q=0;q<h;q++){if(F=d[q],$=y[q],W=x[q],F<0||W<0)return K=3,nr();R+=N($)*(2*F+4*W),c+=$*(F+W),u<$?u=$:a>$&&(a=$)}if(0==R)return J=f>0?1:0,nr();if(0==a&&0==u&&0==b)return K=3,nr();R=Math.sqrt(R),L=u<-a?-a:u,B=16/R,G=-(C=4.5/R);try{let r;function tr(){if(rr[3]=X,U>E)return K=1,nr();for(_(V=Math.floor(U+.5),X,0,!0),rr[2]=rr[2]+1,rr[1]=rr[1]+V+1,J=.5-s,rr[0]=m,z=(C=m)+T/10,q=0;q<4;q++)er[q]*z==er[q]*C&&(K=2);return nr()}return B=S(B,.5*O),0!=f&&L>.07*R&&(D=.25*O/I(f),g?g=!1:j(B,D)<.2*O&&(o+=D,B=S(B,.25*O),rr[5]=Math.sqrt(D))),rr[4]=B,O*=.5,function e(){return[r,C]=A(O,C),(Z=r-f)<0?(J=1,nr()):([r,G]=A(O,G),(H=f-r)<0?(J=0,nr()):(U=B/(X=2*t/(Z>H?Z:H)),Y=3/Math.sqrt(O),U>1.5*Y?Y>E?(K=1,nr()):(P=Math.floor(Y+.5),(z=2*t/(Q=B/P))<=Math.abs(f)?tr():(D=.33*O/(1.1*(I(f-z)+I(f+z))),g?tr():(O*=.67,_(P,Q,D,!1),E-=Y,o+=D,rr[2]=rr[2]+1,rr[1]=rr[1]+P+1,B=S(B,.25*O),O*=.75,e()))):tr()))}()}catch(r){if("RangeError"===r.name)return K=4,nr();throw r}}},function(r,e,n){"use strict";e.b=vr,n.d(e,"c",function(){return Mr}),n.d(e,"a",function(){return Nr});const t=2.220446049250313e-16,i=Number.MIN_VALUE,o=Number.MAX_VALUE,u=1.157920892373162e77,a=.5772156649015329,c=1e-14,f=2.2737368458246524e-13,s=1.4901161193847656e-8,m=Math.LN2,h=Math.LN10,l=Math.PI,p=2*l,g=Math.log(2*Math.PI),d=Math.log(Math.sqrt(p)),v=5.656854249492381,y=.3989422804014327,x=308*m/t,M=-323*m,b=1,w=2,N=4,k=8,T=16;function A(r,e){if(r>b){let n="";switch(r){case b:n=`argument out of domain in ${e}`;break;case w:n=`value out of range in ${e}`;break;case N:n=`convergence failed in ${e}`;break;case k:n=`full precision may not have been achieved in ${e}`;break;case T:n=`underflow occurred in ${e}`}console.error(n)}}function j(){return A(b,""),NaN}const S=.08333333333333333,_=.002777777777777778,I=.0007936507936507937,q=.0005952380952380953,F=.0008417508417508417,V=[0,.15342640972002736,.08106146679532726,.05481412105191765,.0413406959554093,.03316287351993629,.02767792568499834,.023746163656297496,.020790672103765093,.018488450532673187,.016644691189821193,.015134973221917378,.013876128823070748,.012810465242920227,.01189670994589177,.011104559758206917,.010411265261972096,.009799416126158804,.009255462182712733,.008768700134139386,.00833056343336287,.00793411456431402,.007573675487951841,.007244554301320383,.00694284010720953,.006665247032707682,.006408994188004207,.006171712263039458,.0059513701127588475,.0057462165130101155,.005554733551962801],P=[.3224670334241132,.0673523010531981,.020580808427784546,.007385551028673986,.0028905103307415234,.001192753911703261,.0005096695247430425,.00022315475845357939,9945751278180853e-20,4492623673813314e-20,2050721277567069e-20,9439488275268397e-21,4374866789907488e-21,2039215753801366e-21,9.55141213040742e-7,4.492469198764566e-7,2.1207184805554665e-7,1.0043224823968099e-7,4.7698101693639804e-8,2.2711094608943164e-8,1.0838659214896955e-8,5.183475041970047e-9,2.4836745438024785e-9,1.1921401405860912e-9,5.731367241678862e-10,2.7595228851242334e-10,1.330476437424449e-10,6.4229645638381e-11,3.1044247747322276e-11,1.5021384080754142e-11,7.275974480239079e-12,3.527742476575915e-12,1.711991790559618e-12,8.315385841420285e-13,4.04220052528944e-13,1.9664756310966165e-13,9.573630387838556e-14,4.6640760264283744e-14,2.2737369600659724e-14,1.1091399470834522e-14],O=[-1e99,2/3,-4/135,8/2835,16/8505,-8992/12629925,-334144/492567075,698752/1477701225],L=[-1e99,1/12,1/288,-139/51840,-571/2488320,163879/209018880,5246819/75246796800,-.0005921664373536939],E=[.00857119559098933,.004415381324841007,.05685043681599363,-.00421983539641856,.0013268081812124603,-.00018930245297988805,3606925327441245e-20,-6056761904460864e-21,10558295463022833e-22,-1.811967365542384e-7,3.117724964715322e-8,-5.354219639019687e-9,9.193275519859589e-10,-1.5779412802883398e-10,2.7079806229349544e-11,-4.64681865382573e-12,7.97335019200742e-13,-1.368078209830916e-13,2.3473194865638007e-14,-4.027432614949067e-15,6.910051747372101e-16,-1.185584500221993e-16,2.034148542496374e-17,-3.490054341717406e-18,5.987993856485306e-19,-1.027378057872228e-19,1.7627028160605298e-20,-3.024320653735306e-21,5.188914660218398e-22,-8.902770842456576e-23,1.5274740684933426e-23,-2.620731256187363e-24,4.496464047830539e-25,-7.714712731336878e-26,1.323635453126044e-26,-2.2709994129429287e-27,3.8964189980039913e-28,-6.685198115125953e-29,1.1469986631400244e-29,-1.9679385863451348e-30,3.376448816585338e-31,-5.793070335782136e-32],U=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1.809129475572494e-11,6.221098041892606e-14,-3.399615005417722e-16,2.683181998482699e-18,-2.868042435334643e-20,3.9628370610464347e-22,-6.831888753985767e-24,1.4292273559424982e-25,-3.5475981581010704e-27,1.025680058010471e-28,-3.401102254316749e-30,1.276642195630063e-31],Y=[2.2352520354606837,161.02823106855587,1067.6894854603709,18154.98125334356,.06568233791820745],B=[47.202581904688245,976.0985517377767,10260.932208618979,45507.78933502673],D=[.39894151208813466,8.883149794388377,93.50665613217785,597.2702763948002,2494.5375852903726,6848.190450536283,11602.65143764735,9842.714838383978,1.0765576773720192e-8],R=[22.266688044328117,235.387901782625,1519.3775994075547,6485.558298266761,18615.571640885097,34900.95272114598,38912.00328609327,19685.429676859992],X=[.215898534057957,.12740116116024736,.022235277870649807,.0014216191932278934,29112874951168793e-21,.023073441764940174],Q=[1.284260096144911,.4682382124808651,.06598813786892856,.0037823963320275824,7297515550839662e-20],z=r=>r?-1/0:0,C=r=>r?0:1,G=(r,e)=>r?z(e):C(e),Z=(r,e)=>r?C(e):z(e),H=(r,e)=>e?Math.log(r):r,$=(r,e,n)=>e?H(r,n):((r,e)=>e?Math.log1p(-r):.5-r+.5)(r,n);function W(r){return r>-m?Math.log(-Math.expm1(r)):Math.log1p(-Math.exp(r))}function J(r,e){return e?r:Math.exp(r)}function K(r){return isNaN(r)?r:Number.isFinite(r)?((r%=2)<=-1?r+=2:r>1&&(r-=2),0==r||1==r?0:.5==r?1:-.5==r?-1:Math.sin(l*r)):NaN}function rr(r,e,n){var t,i,o,u,a;if(n<1||n>1e3)return NaN;if(r<-1.1||r>1.1)return NaN;for(u=2*r,o=i=0,t=0,a=1;a<=n;a++)o=i,t=u*(i=t)-o+e[n-a];return.5*(t-o)}function er(r){var e;if(r<10)return NaN;if(r>3.745194030963158e306)throw"lgammacor underflow";return r<94906265.62425156?rr((e=10/r)*e*2-1,U,5)/r:1/(12*r)}function nr(r){var e,n,t,i,o;if(isNaN(r))return r;if(0==r||r<0&&r==Math.round(r))return NaN;if((t=Math.abs(r))<=10){if(n=parseInt(r,10),r<0&&n--,t=r-n,n--,o=rr(2*t-1,E,22)+.9375,0==n)return o;if(n<0){if(r<-.5&&Math.abs(r-parseInt(r-.5,10)/r)<s)throw"gammafn precision error";if(r<2.2474362225598545e-308)return r>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;for(n=-n,e=0;e<n;e++)o/=r+e;return o}for(e=1;e<=n;e++)o*=t+e;return o}if(r>171.61447887182297)return Number.POSITIVE_INFINITY;if(r<-170.5674972726612)return 0;if(t<=50&&t==parseInt(t,10))for(o=1,e=2;e<t;e++)o*=e;else o=Math.exp((t-.5)*Math.log(t)-t-d+(2*t==parseInt(2*t,10)?ir(t):er(t)));if(r>0)return o;if(Math.abs(r-parseInt(r-.5,10)/r)<s)throw"gammafn precision error";return 0==(i=K(t))?Number.POSITIVE_INFINITY:-l/(t*i*o)}function tr(r){return function(r){var e;if(isNaN(r))return r;if(r<0&&Math.floor(-r),r<=0&&r==Math.trunc(r))return Number.POSITIVE_INFINITY;if((e=Math.abs(r))<1e-306)return-Math.log(e);if(e<=10)return Math.log(Math.abs(nr(r)));if(e>2.5327372760800758e305)return Number.POSITIVE_INFINITY;if(r>0)return r>1e17?r*(Math.log(r)-1):r>4934720?d+(r-.5)*Math.log(r)-r:d+(r-.5)*Math.log(r)-r+er(r);if(0==Math.abs(K(e)))return NaN;if(Math.abs(void 0*(r-Math.trunc(r-.5))/r)<s)throw"lgamma precision error"}(r)}function ir(r){var e;return r<=15?(e=r+r)==Math.floor(e)?V[Math.floor(e)]:tr(r+1)-(r+.5)*Math.log(r)+r-d:(e=r*r,r>500?(S-_/e)/r:r>80?(S-(_-I/e)/e)/r:r>35?(S-(_-(I-q/e)/e)/e)/r:(S-(_-(I-(q-F/e)/e)/e)/e)/r)}function or(r,e){var n,t,o,u,a;if(!Number.isFinite(r)||!Number.isFinite(e)||0==e)return NaN;if(Math.abs(r-e)<.1*(r+e)){if(t=(r-e)*(u=(r-e)/(r+e)),Math.abs(t)<i)return t;for(n=2*r*u,u*=u,a=1;a<1e3;a++){if((o=t+(n*=u)/(2*a+1))==t)return o;t=o}}return r*Math.log(r/e)+e-r}function ur(r,e,n){return 0==e?hr(1==r?1:0,n):Number.isFinite(e)?r<0?hr(0,n):r<=e*i?J(-e,n):e<r*i?J(-e+r*Math.log(e)-tr(r+1),n):function(r,e,n){return n?-.5*Math.log(r)+e:Math.exp(e)/Math.sqrt(r)}(p*r,-ir(r)-or(r,e),n):hr(0,n)}function ar(r,e,n,t){var i,o=2*n,a=e+n,c=a+n,f=a,s=e*(a-e*r),m=n*n*r,h=c*a-m;for(m=c*s-e*m;Math.abs(h*s-f*m)>Math.abs(t*s*m);)i=a*a*r,a+=n,f=(c+=n)*h-i*f,s=c*m-i*s,i=o*o*r,o+=n,h=(c+=n)*f-i*h,m=c*s-i*m,Math.abs(m)>u?(f/=u,h/=u,s/=u,m/=u):Math.abs(m)<1/u&&(f*=u,h*=u,s*=u,m*=u);return h/m}function cr(r){if(r>1||r<-.79149064)return Math.log1p(r)-r;var e=r/(2+r),n=e*e;return Math.abs(r)<.01?e*((((2/9*n+2/7)*n+.4)*n+2/3)*n-r):e*(2*n*ar(n,3,2,c)-r)}function fr(r){if(Math.abs(r)>=.5)return tr(r+1);var e,n;for(e=f*ar(-r/2,P.length+2,1,c),n=P.length-1;n>=0;n--)e=P[n]-r*e;return(r*e-a)*r-cr(r)}function sr(r,e){return(r>e?r:e)+Math.log1p(Math.exp(-Math.abs(r-e)))}function mr(r,e,n){if(!isFinite(e))return hr(0,n);if(r>1)return ur(r-1,e,n);if(e>Math.abs(r-1)*x)return J(-e-tr(r),n);var t=ur(r,e,n);return n?t+Math.log(r/e):t*(r/e)}function hr(r,e){return 0===r?e?Number.NEGATIVE_INFINITY:0:e?0:1}function lr(r,e,n){return hr(0===r?e?0:1:e?1:0,n)}function pr(r,e){var n,i,o,a,c,f,s,m,h,l,p=0;if(0==r)return 0;if(i=r/e,Math.abs(r-1)<Math.abs(e)*t)return i;for(i>1&&(i=1),a=r,f=e,s=0,m=1,h=r,l=e;l>u;)s/=u,m/=u,h/=u,l/=u;for(o=0,n=-1;o<2e5;)if(s=(f+=2)*h+(c=++o*--a)*s,m=f*l+c*m,h=(f+=2)*s+(c=++o*--a)*h,(l=f*m+c*l)>u&&(s/=u,m/=u,h/=u,l/=u),0!=l){if(p=h/l,Math.abs(p-n)<=t*(Math.abs(p)>i?Math.abs(p):i))return p;n=p}return p}function gr(r,e,n,i){var o,u,a,c,f,s,m,h,l,p,g,d,v,y=O,x=L;for(l=-cr((h=e-r)/r),p=Math.sqrt(2*r*l),h<0&&(p=-p),a=0,f=c=Math.sqrt(r),m=s=p,v=1;v<8;v++)a+=f*y[v],a+=m*x[v],f=f/r+(c*=l/v),m=m/r+(s*=2*l/(2*v+1));for(o=r,u=1,v=1;v<8;v++)o+=u*x[v],u/=r;if(n||(o=-o),g=a/o,d=xr(p,0,1,!n,i),i){var M=function(r,e,n){if(r<0&&(r=-r,e=!e),r>10&&!e){var i=1/r,o=i,u=r*r,a=1;do{o+=i*=-a/u,a+=2}while(Math.abs(i)>t*o);return 1/o}return br(r,0,1,!1)/Math.exp(n)}(p,!n,d);return d+Math.log1p(g*M)}return d+g*br(p,0,1,i)}function dr(r,e,n,o){var u,a,c;if(r<1)u=function(r,e,n,i){var o,u=0,a=e,c=0;do{u+=o=(a*=-r/++c)/(e+c)}while(Math.abs(o)>t*Math.abs(u));if(n){var f,s=i?Math.log1p(u):1+u;return e>1?(f=ur(e,r,i),f=i?f+r:f*Math.exp(r)):f=i?e*Math.log(r)-fr(e):Math.pow(r,e)/Math.exp(fr(e)),i?s+f:s*f}var m=e*Math.log(r)-fr(e);if(i)return W(Math.log1p(u)+m);var h=u,l=Math.expm1(m);return-(h+l+h*l)}(r,e,n,o);else if(r<=e-1&&r<.8*(e+50))c=function(r,e,n){var i=r/e,o=i;do{o+=i*=r/++e}while(i>o*t);return n?Math.log(o):o}(r,e,o),a=mr(e,r,o),u=n?o?c+a:c*a:o?W(a+c):1-a*c;else if(e-1<r&&e<.8*(r+50)){if(a=mr(e,r,o),e<1)if(r*t>1-e)c=hr(0,o);else{var f=pr(e,r-(e-1))*r/e;c=o?Math.log(f):f}else c=function(r,e){for(var n=1,i=0;e>=1&&n>i*t;)i+=n*=e/r,e--;return e!==Math.floor(e)&&(i+=n*pr(e,r+1-e)),i}(r,e-1),c=o?Math.log1p(c):1+c;u=n?o?W(a+c):1-a*c:o?c+a:c*a}else u=gr(e-1,r,!n,o);return!o&&u<i/t?Math.exp(dr(r,e,n,!0)):u}function vr(r,e,n=0,i=!0,o=!1){return r=kr(r),e=kr(e),n=kr(n),i=Tr(i),o=Tr(o),0===n?function(r,e,n,t,i){return isNaN(r)||e<0||n<0?NaN:(r/=n,0==e?lr(r<=0?0:1,t,i):dr(r,e,t,i))}(r,e/2,2,i,o):function(r,e,n=0,i=!0,o=!1){if(e<0||n<0)return NaN;let u=yr(r,e,n,1e-12,8*t,1e6,i,o);n>=80&&(i?(a=u,c=C(o),u=isNaN(a)||isNaN(c)?a+c:a<c?a:c):(u<(o?-10*h:1e-10)&&A(k,"pnchisq"),o||(u=function(r,e){return isNaN(r)||isNaN(e)?r+e:r<e?e:r}(u,0))));var a,c;return!o||u<-1e-8?u:(u=yr(r,e,n,1e-12,8*t,1e6,!i,!1),Math.log1p(-u))}(r,e,n,i,o)}function yr(r,e,n,i,o,u,a,c){let f,s,h,l,p,g,v,y,x,b,w,N,k,T,A,j,S,_,I=-1,q=-1,F=-1;if(r<=0){if(0===r&&0===e){const r=-.5*n;return a?J(r,c):c?W(r):-function(r){let e,n=Math.abs(r);return n<t?r:n>.697?Math.exp(r)-1:(e=n>1e-8?Math.exp(r)-1:(r/2+1)*r,e-=(1+e)*(Math.log1p(e)-r))}(r)}return G(a,c)}if(!isFinite(r))return Z(a,c);if(n<80){let t;if(a&&e>0&&Math.log(r)<m+2/e*(tr(e/2+1)+M)){let i,o,u=.5*n,f=-u;i=o=-1/0;for(let n=0;n<110&&(o=sr(o,f),i=sr(i,f+vr(r,e+2*n,0,a,!0)),!(o>=-1e-15));f===Math.log(u)-Math.log(++n));return t=i-o,c?t:Math.exp(t)}{let i=.5*n,o=0,u=0,f=Math.exp(-i);for(let n=0;n<110&&(u+=f,o+=f*vr(r,e+2*n,0,a,!1),!(u>=1-1e-15));f*=i/++n);return t=o/u,c?Math.log(t):t}}if((x=-(f=.5*n)<M)?(A=0,F=-f,I=Math.log(f)):A=Math.exp(-f),j=A,s=.5*r,g=e-r,b=(_=(h=.5*e)*t>.125&&Math.abs(S=s-h)<Math.sqrt(t)*h?(1-S)*(2-S/(h+1))-d-.5*Math.log(h+1):h*Math.log(s)-s-tr(h+1))<M){if(r>e+n+5*Math.sqrt(2*(e+2*n)))return Z(a,c);q=Math.log(r),T=l=0,S=0}else T=l=j*(S=Math.exp(_));for(y=1,v=e+2,g+=2;!(g>0&&(k=y>u,(N=(p=S*r/g)<=i)&&(w=l<=o*T)||k));y++,v+=2,g+=2)x?(F+=I-Math.log(y))>=M&&(j=A=Math.exp(F),x=!1):j+=A*=f/y,b?(_+=q-Math.log(v))>=M&&(S=Math.exp(_),b=!1):S*=r/v,x||b||(T+=l=j*S);return k&&console.error(`pnchisq(x=${r},...) not converged in ${u}`),$(T,a,c)}function xr(r,e,n,i,o){var u;if(isNaN(r)||isNaN(e)||isNaN(n))return NaN;if(!Number.isFinite(r)&&e===r)return NaN;if(n<=0)return n<0?NaN:r<e?G(i,o):Z(i,o);if(u=(r-e)/n,!Number.isFinite(u))return r<e?G(i,o):Z(i,o);var a=function(r,e,n){var i,o,u,a,c,f,s,m,h,l,p,g,d=Y,x=B,M=D,b=R,w=X,N=Q;if(isNaN(r))return{cum:NaN,ccum:NaN};if(s=.5*t,p=1!=e,g=0!=e,(h=Math.abs(r))<=.67448975){if(h>s)for(m=r*r,a=d[4]*m,u=m,l=0;l<3;++l)a=(a+d[l])*m,u=(u+x[l])*m;else a=u=0;c=r*(a+d[3])/(u+x[3]),p&&(i=.5+c),g&&(o=.5-c),n&&(p&&(i=Math.log(i)),g&&(o=Math.log(o)))}else if(h<=v){for(a=M[8]*h,u=h,l=0;l<7;++l)a=(a+M[l])*h,u=(u+b[l])*h;c=(a+M[7])/(u+b[7]),f=(h-(m=Math.trunc(16*h)/16))*(h+m),n?(i=-m*m*.5+.5*-f+Math.log(c),(p&&r>0||g&&r<=0)&&(o=Math.log1p(-Math.exp(-m*m*.5)*Math.exp(.5*-f)*c))):o=1-(i=Math.exp(-m*m*.5)*Math.exp(.5*-f)*c),r>0&&(c=i,p&&(i=o),o=c)}else if(n&&h<1e170||p&&-37.5193<r&&r<8.2924||g&&r<37.5193){for(m=1/(r*r),a=w[5]*m,u=m,l=0;l<4;++l)a=(a+w[l])*m,u=(u+N[l])*m;c=m*(a+w[4])/(u+N[4]),c=(y-c)/h,f=(r-(m=Math.trunc(16*r)/16))*(r+m),n?(i=-m*m*.5+.5*-f+Math.log(c),(p&&r>0||g&&r<=0)&&(o=Math.log1p(-Math.exp(-m*m*.5)*Math.exp(.5*-f)*c))):o=1-(i=Math.exp(-m*m*.5)*Math.exp(.5*-f)*c),r>0&&(c=i,p&&(i=o),o=c)}else r>0?(i=hr(1,n),o=hr(0,n)):(i=hr(0,n),o=hr(1,n));return{cum:i,ccum:o}}(r=u,i?0:1,o);return i?a.cum:a.ccum}function Mr(r,e,n,t,i){return xr(r=kr(r),e=kr(e,0),n=kr(n,1),t=Tr(t,!0),i=Tr(i,!1))}function br(r,e,n,t){return isNaN(r)||isNaN(e)||isNaN(n)?r+e+n:Number.isFinite(n)?Number.isFinite(r)||e!=r?n<=0?n<0?NaN:r==e?Number.POSITIVE_INFINITY:hr(0,t):(r=(r-e)/n,Number.isFinite(r)?(r=Math.abs(r))>=2*Math.sqrt(o)?hr(0,t):t?-(d+.5*r*r+Math.log(n)):y*Math.exp(-.5*r*r)/n:hr(0,t)):NaN:hr(0,t)}function wr(r,e,n,t){if((e<0||n<0)&&j(),r<0||r>1)return z(t);if(0===e||0===n||!isFinite(e)||!isFinite(n))return 0===e&&0===n?0===r||1===r?Number.POSITIVE_INFINITY:z(t):0===e||e/n==0?0===r?Number.POSITIVE_INFINITY:z(t):0===n||n/e==0?1===r?Number.POSITIVE_INFINITY:z(t):.5===r?Number.POSITIVE_INFINITY:z(t);if(0===r)return e>1?z(t):e<1?Number.POSITIVE_INFINITY:H(n,t);if(1===r)return n>1?z(t):n<1?Number.POSITIVE_INFINITY:H(e,t);let i;return J(i=e<=2||n<=2?(e-1)*Math.log(r)+(n-1)*Math.log1p(-r)-function(r,e){let n,t,i;return e<(t=i=r)&&(t=e),e>i&&(i=e),t<0?j():0===t?Number.POSITIVE_INFINITY:isFinite(i)?t>=10?(n=er(t)+er(i)-er(t+i),-.5*Math.log(i)+d+n+(t-.5)*Math.log(t/(t+i))+i*Math.log1p(-t/(t+i))):i>=10?(n=er(i)-er(t+i),tr(t)+n+t-t*Math.log(t+i)+(i-.5)*Math.log1p(-t/(t+i))):t<1e-306?tr(t)+(tr(i)-tr(t+i)):Math.log(nr(t)*(nr(i)/nr(t+i))):Number.NEGATIVE_INFINITY}(e,n):Math.log(e+n-1)+function(r,e,n,t,i){let o,u;return 0===n?0===r?C(i):z(i):0===t?r===e?C(i):z(i):0===r?0===e?C(i):J(u=n<.1?-or(e,e*t)-e*n:e*Math.log(t),i):r===e?J(u=t<.1?-or(e,e*n)-e*t:e*Math.log(n),i):r<0||r>e?z(i):J((u=ir(e)-ir(r)-ir(e-r)-or(r,e*n)-or(e-r,e*t))-.5*(o=g+Math.log(r)+Math.log1p(-r/e)),i)}(e-1,e+n-2,r,1-r,!0),t)}function Nr(r,e,n,t){return wr(r=kr(r),e=kr(e),n=kr(n),t=Tr(t,!1))}function kr(r,e){return void 0===r?e:+r}function Tr(r,e){return void 0===r?e:!("false"==(r||"false"))}}])});
//# sourceMappingURL=raremetal.min.js.map
